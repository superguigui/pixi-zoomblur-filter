(function t(e,r,i){function n(s,a){if(!r[s]){if(!e[s]){var l=typeof require=="function"&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=r[s]={exports:{}};e[s][0].call(u.exports,function(t){var r=e[s][1][t];return n(r?r:t)},u,u.exports,t,e,r,i)}return r[s].exports}var o=typeof require=="function"&&require;for(var s=0;s<i.length;s++)n(i[s]);return n})({1:[function(t,e,r){"use strict";var i=function(t){return t&&t.__esModule?t:{"default":t}};var n=function(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}};var o=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(t,i.key,i)}}return function(e,r,i){if(r)t(e.prototype,r);if(i)t(e,i);return e}}();Object.defineProperty(r,"__esModule",{value:true});var s=t("lodash/function/bindAll");var a=i(s);var l=t("raf");var h=i(l);var u=t("brindille-resize");var c=i(u);var f=t("dat-gui");var d=i(f);var p=t("pixi.js");var v=i(p);var g=t("../index.js");var m=i(g);var y=function(){function t(e){n(this,t);e=e||{};this.$container=e.container||document.body;a["default"](this,"render");this.renderer=new v["default"].WebGLRenderer(c["default"].width,c["default"].height,{antialias:true,transparent:false,resolution:1});this.$container.appendChild(this.renderer.view);this.scene=new v["default"].Container;this.backgroundPlane=new v["default"].Graphics;this.backgroundPlane.beginFill(723723);this.backgroundPlane.drawRect(0,0,c["default"].width,c["default"].height);this.backgroundPlane.endFill();this.scene.addChild(this.backgroundPlane);this.container=new v["default"].Container;this.scene.addChild(this.container);this.triangleShape=new v["default"].Graphics;this.triangleShape.lineStyle(2,16736816);this.triangleShape.moveTo(0,0);this.triangleShape.lineTo(200,200);this.triangleShape.lineTo(0,200);this.triangleShape.lineTo(0,0);this.container.addChild(this.triangleShape);this.triangleShape.x=c["default"].width*.5;this.triangleShape.y=c["default"].height*.5;this.triangleShape.pivot.x=100;this.triangleShape.pivot.y=100;this.circleShape=new v["default"].Graphics;this.circleShape.lineStyle(2,6487856);this.circleShape.drawCircle(0,0,30);this.container.addChild(this.circleShape);this.circleShape.x=c["default"].width*.5-100-15;this.circleShape.y=c["default"].height*.5-15;this.rectangleShape=new v["default"].Graphics;this.rectangleShape.beginFill(6435071);this.rectangleShape.drawRect(0,0,100,100);this.container.addChild(this.rectangleShape);this.rectangleShape.x=c["default"].width*.5+100;this.rectangleShape.y=c["default"].height*.5;var r=new m["default"];r.uniforms.strength.value=.06;this.gui=new d["default"].GUI;this.gui.add(r.uniforms.strength,"value",0,1).name("strength").step(.001);this.gui.add(r.uniforms.center.value,"x",0,1).name("strength").step(.001);this.gui.add(r.uniforms.center.value,"y",0,1).name("strength").step(.001);this.scene.filters=[r];h["default"](this.render)}o(t,[{key:"render",value:function e(){h["default"](this.render);this.triangleShape.rotation+=.01;this.renderer.render(this.scene)}}]);return t}();r["default"]=y;e.exports=r["default"]},{"../index.js":3,"brindille-resize":4,"dat-gui":10,"lodash/function/bindAll":16,"pixi.js":167,raf:184}],2:[function(t,e,r){"use strict";var i=function(t){return t&&t.__esModule?t:{"default":t}};var n=t("domready");var o=i(n);var s=t("./App");var a=i(s);o["default"](function(){var t=new a["default"]})},{"./App":1,domready:13}],3:[function(t,e,r){"use strict";var i=t("pixi.js/src/core").AbstractFilter;function n(){i.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 center;\nuniform vec2 resolution;\nuniform float strength;\n\n\nvoid main() {\n\n  vec4 sum = vec4( 0.0 );\n\n  vec2 toCenter = center - vTextureCoord * resolution;\n  vec2 inc = toCenter * strength / resolution;\n\n  inc = strength * (center / resolution - vTextureCoord);\n  \n  sum += texture2D( uSampler, ( vTextureCoord - inc * 4.0 ) ) * 0.051;\n  sum += texture2D( uSampler, ( vTextureCoord - inc * 3.0 ) ) * 0.0918;\n  sum += texture2D( uSampler, ( vTextureCoord - inc * 2.0 ) ) * 0.12245;\n  sum += texture2D( uSampler, ( vTextureCoord - inc * 1.0 ) ) * 0.1531;\n  sum += texture2D( uSampler, ( vTextureCoord + inc * 0.0 ) ) * 0.1633;\n  sum += texture2D( uSampler, ( vTextureCoord + inc * 1.0 ) ) * 0.1531;\n  sum += texture2D( uSampler, ( vTextureCoord + inc * 2.0 ) ) * 0.12245;\n  sum += texture2D( uSampler, ( vTextureCoord + inc * 3.0 ) ) * 0.0918;\n  sum += texture2D( uSampler, ( vTextureCoord + inc * 4.0 ) ) * 0.051;\n\n  gl_FragColor = sum;\n\n}",{center:{type:"v2",value:{x:.5,y:.5}},resolution:{type:"v2",value:{x:1,y:1}},strength:{type:"f",value:0}})}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n},{"pixi.js/src/core":77}],4:[function(t,e,r){"use strict";var i=t("component-emitter");var n=t("debounce");var o=e.exports={onGlobalResize:function(){this.width=window.innerWidth;this.height=window.innerHeight;this.halfWidth=.5*this.width;this.halfHeight=.5*this.height;this.applyResize();this.debouncedResize()},applyResizeDebounce:function(){this.emit("resizeDebounce")},applyResize:function(){this.emit("resize")},addListener:function(t,e){this.on(e?"resize":"resizeDebounce",t)},removeListener:function(t){if(t){this.off("resize",t);this.off("resizeDebounce",t)}},removeAllListeners:function(){this.off()}};i(o);o.debouncedResize=n(o.applyResizeDebounce.bind(o),50);o.onGlobalResize();window.addEventListener("resize",o.onGlobalResize.bind(o))},{"component-emitter":5,debounce:6}],5:[function(t,e,r){e.exports=i;function i(t){if(t)return n(t)}function n(t){for(var e in i.prototype){t[e]=i.prototype[e]}return t}i.prototype.on=i.prototype.addEventListener=function(t,e){this._callbacks=this._callbacks||{};(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e);return this};i.prototype.once=function(t,e){function r(){this.off(t,r);e.apply(this,arguments)}r.fn=e;this.on(t,r);return this};i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(t,e){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length){delete this._callbacks["$"+t];return this}var i;for(var n=0;n<r.length;n++){i=r[n];if(i===e||i.fn===e){r.splice(n,1);break}}return this};i.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),r=this._callbacks["$"+t];if(r){r=r.slice(0);for(var i=0,n=r.length;i<n;++i){r[i].apply(this,e)}}return this};i.prototype.listeners=function(t){this._callbacks=this._callbacks||{};return this._callbacks["$"+t]||[]};i.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],6:[function(t,e,r){var i=t("date-now");e.exports=function n(t,e,r){var n,o,s,a,l;if(null==e)e=100;function h(){var u=i()-a;if(u<e&&u>0){n=setTimeout(h,e-u)}else{n=null;if(!r){l=t.apply(s,o);if(!n)s=o=null}}}return function u(){s=this;o=arguments;a=i();var u=r&&!n;if(!n)n=setTimeout(h,e);if(u){l=t.apply(s,o);s=o=null}return l}}},{"date-now":7}],7:[function(t,e,r){e.exports=Date.now||i;function i(){return(new Date).getTime()}},{}],8:[function(t,e,r){(function(t){function e(t,e){var r=0;for(var i=t.length-1;i>=0;i--){var n=t[i];if(n==="."){t.splice(i,1)}else if(n===".."){t.splice(i,1);r++}else if(r){t.splice(i,1);r--}}if(e){for(;r--;r){t.unshift("..")}}return t}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var n=function(t){return i.exec(t).slice(1)};r.resolve=function(){var r="",i=false;for(var n=arguments.length-1;n>=-1&&!i;n--){var s=n>=0?arguments[n]:t.cwd();if(typeof s!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!s){continue}r=s+"/"+r;i=s.charAt(0)==="/"}r=e(o(r.split("/"),function(t){return!!t}),!i).join("/");return(i?"/":"")+r||"."};r.normalize=function(t){var i=r.isAbsolute(t),n=s(t,-1)==="/";t=e(o(t.split("/"),function(t){return!!t}),!i).join("/");if(!t&&!i){t="."}if(t&&n){t+="/"}return(i?"/":"")+t};r.isAbsolute=function(t){return t.charAt(0)==="/"};r.join=function(){var t=Array.prototype.slice.call(arguments,0);return r.normalize(o(t,function(t,e){if(typeof t!=="string"){throw new TypeError("Arguments to path.join must be strings")}return t}).join("/"))};r.relative=function(t,e){t=r.resolve(t).substr(1);e=r.resolve(e).substr(1);function i(t){var e=0;for(;e<t.length;e++){if(t[e]!=="")break}var r=t.length-1;for(;r>=0;r--){if(t[r]!=="")break}if(e>r)return[];return t.slice(e,r-e+1)}var n=i(t.split("/"));var o=i(e.split("/"));var s=Math.min(n.length,o.length);var a=s;for(var l=0;l<s;l++){if(n[l]!==o[l]){a=l;break}}var h=[];for(var l=a;l<n.length;l++){h.push("..")}h=h.concat(o.slice(a));return h.join("/")};r.sep="/";r.delimiter=":";r.dirname=function(t){var e=n(t),r=e[0],i=e[1];if(!r&&!i){return"."}if(i){i=i.substr(0,i.length-1)}return r+i};r.basename=function(t,e){var r=n(t)[2];if(e&&r.substr(-1*e.length)===e){r=r.substr(0,r.length-e.length)}return r};r.extname=function(t){return n(t)[3]};function o(t,e){if(t.filter)return t.filter(e);var r=[];for(var i=0;i<t.length;i++){if(e(t[i],i,t))r.push(t[i])}return r}var s="ab".substr(-1)==="b"?function(t,e,r){return t.substr(e,r)}:function(t,e,r){if(e<0)e=t.length+e;return t.substr(e,r)}}).call(this,t("_process"))},{_process:9}],9:[function(t,e,r){var i=e.exports={};var n=[];var o=false;function s(){if(o){return}o=true;var t;var e=n.length;while(e){t=n;n=[];var r=-1;while(++r<e){t[r]()}e=n.length}o=false}i.nextTick=function(t){n.push(t);if(!o){setTimeout(s,0)}};i.title="browser";i.browser=true;i.env={};i.argv=[];i.version="";i.versions={};function a(){}i.on=a;i.addListener=a;i.once=a;i.off=a;i.removeListener=a;i.removeAllListeners=a;i.emit=a;i.binding=function(t){throw new Error("process.binding is not supported")};i.cwd=function(){return"/"};i.chdir=function(t){throw new Error("process.chdir is not supported")};i.umask=function(){return 0}},{}],10:[function(t,e,r){e.exports=t("./vendor/dat.gui");e.exports.color=t("./vendor/dat.color")},{"./vendor/dat.color":11,"./vendor/dat.gui":12}],11:[function(t,e,r){var i=e.exports=i||{};i.color=i.color||{};i.utils=i.utils||{};i.utils.common=function(){var t=Array.prototype.forEach;var e=Array.prototype.slice;return{BREAK:{},extend:function(t){this.each(e.call(arguments,1),function(e){for(var r in e)if(!this.isUndefined(e[r]))t[r]=e[r]},this);return t},defaults:function(t){this.each(e.call(arguments,1),function(e){for(var r in e)if(this.isUndefined(t[r]))t[r]=e[r]},this);return t},compose:function(){var t=e.call(arguments);return function(){var r=e.call(arguments);for(var i=t.length-1;i>=0;i--){r=[t[i].apply(this,r)]}return r[0]}},each:function(e,r,i){if(t&&e.forEach===t){e.forEach(r,i)}else if(e.length===e.length+0){for(var n=0,o=e.length;n<o;n++)if(n in e&&r.call(i,e[n],n)===this.BREAK)return}else{for(var n in e)if(r.call(i,e[n],n)===this.BREAK)return}},defer:function(t){setTimeout(t,0)},toArray:function(t){if(t.toArray)return t.toArray();return e.call(t)},isUndefined:function(t){return t===undefined},isNull:function(t){return t===null},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===false||t===true},isFunction:function(t){return Object.prototype.toString.call(t)==="[object Function]"}}}();i.color.toString=function(t){return function(e){if(e.a==1||t.isUndefined(e.a)){var r=e.hex.toString(16);while(r.length<6){r="0"+r}return"#"+r}else{return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}}(i.utils.common);i.Color=i.color.Color=function(t,e,r,i){var n=function(){this.__state=t.apply(this,arguments);if(this.__state===false){throw"Failed to interpret color arguments"}this.__state.a=this.__state.a||1};n.COMPONENTS=["r","g","b","h","s","v","hex","a"];i.extend(n.prototype,{toString:function(){return r(this)},toOriginal:function(){return this.__state.conversion.write(this)}});o(n.prototype,"r",2);o(n.prototype,"g",1);o(n.prototype,"b",0);s(n.prototype,"h");s(n.prototype,"s");s(n.prototype,"v");Object.defineProperty(n.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}});Object.defineProperty(n.prototype,"hex",{get:function(){if(!this.__state.space!=="HEX"){this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)}return this.__state.hex},set:function(t){this.__state.space="HEX";this.__state.hex=t}});function o(t,e,r){Object.defineProperty(t,e,{get:function(){if(this.__state.space==="RGB"){return this.__state[e]}a(this,e,r);return this.__state[e]},set:function(t){if(this.__state.space!=="RGB"){a(this,e,r);this.__state.space="RGB"}this.__state[e]=t}})}function s(t,e){Object.defineProperty(t,e,{get:function(){if(this.__state.space==="HSV")return this.__state[e];l(this);return this.__state[e]},set:function(t){if(this.__state.space!=="HSV"){l(this);this.__state.space="HSV"}this.__state[e]=t}})}function a(t,r,n){if(t.__state.space==="HEX"){t.__state[r]=e.component_from_hex(t.__state.hex,n)}else if(t.__state.space==="HSV"){i.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}else{throw"Corrupted color state"}}function l(t){var r=e.rgb_to_hsv(t.r,t.g,t.b);i.extend(t.__state,{s:r.s,v:r.v});if(!i.isNaN(r.h)){t.__state.h=r.h}else if(i.isUndefined(t.__state.h)){t.__state.h=0}}return n}(i.color.interpret=function(t,e){var r,i;var n=function(){i=false;var t=arguments.length>1?e.toArray(arguments):arguments[0];e.each(o,function(n){if(n.litmus(t)){e.each(n.conversions,function(n,o){r=n.read(t);if(i===false&&r!==false){i=r;r.conversionName=o;r.conversion=n;return e.BREAK}});return e.BREAK}});return i};var o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);if(e===null)return false;return{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);if(e===null)return false;return{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);if(e===null)return false;return{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);if(e===null)return false;return{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){if(t.length!=3)return false;return{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){if(t.length!=4)return false;return{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){if(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)){return{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}}return false},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){if(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)){return{space:"RGB",r:t.r,g:t.g,b:t.b}}return false},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){if(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)){return{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}}return false},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){if(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)){return{space:"HSV",h:t.h,s:t.s,v:t.v}}return false},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return n}(i.color.toString,i.utils.common),i.color.math=function(){var t;return{hsv_to_rgb:function(t,e,r){var i=Math.floor(t/60)%6;var n=t/60-Math.floor(t/60);var o=r*(1-e);var s=r*(1-n*e);var a=r*(1-(1-n)*e);var l=[[r,a,o],[s,r,o],[o,r,a],[o,s,r],[a,o,r],[r,o,s]][i];return{r:l[0]*255,g:l[1]*255,b:l[2]*255}},rgb_to_hsv:function(t,e,r){var i=Math.min(t,e,r),n=Math.max(t,e,r),o=n-i,s,a;if(n!=0){a=o/n}else{return{h:NaN,s:0,v:0}}if(t==n){s=(e-r)/o}else if(e==n){s=2+(r-t)/o}else{s=4+(t-e)/o}s/=6;if(s<0){s+=1}return{h:s*360,s:a,v:n/255}},rgb_to_hex:function(t,e,r){var i=this.hex_with_component(0,2,t);i=this.hex_with_component(i,1,e);i=this.hex_with_component(i,0,r);return i},component_from_hex:function(t,e){return t>>e*8&255},hex_with_component:function(e,r,i){return i<<(t=r*8)|e&~(255<<t)}}}(),i.color.toString,i.utils.common)},{}],12:[function(t,e,r){var i=e.exports=i||{};i.gui=i.gui||{};i.utils=i.utils||{};i.controllers=i.controllers||{};i.dom=i.dom||{};i.color=i.color||{};i.utils.css=function(){return{load:function(t,e){e=e||document;var r=e.createElement("link");r.type="text/css";r.rel="stylesheet";r.href=t;e.getElementsByTagName("head")[0].appendChild(r)},inject:function(t,e){e=e||document;var r=document.createElement("style");r.type="text/css";r.innerHTML=t;e.getElementsByTagName("head")[0].appendChild(r)}}}();i.utils.common=function(){var t=Array.prototype.forEach;var e=Array.prototype.slice;return{BREAK:{},extend:function(t){this.each(e.call(arguments,1),function(e){for(var r in e)if(!this.isUndefined(e[r]))t[r]=e[r]},this);return t},defaults:function(t){this.each(e.call(arguments,1),function(e){for(var r in e)if(this.isUndefined(t[r]))t[r]=e[r]},this);return t},compose:function(){var t=e.call(arguments);return function(){var r=e.call(arguments);for(var i=t.length-1;i>=0;i--){r=[t[i].apply(this,r)]}return r[0]}},each:function(e,r,i){if(t&&e.forEach===t){e.forEach(r,i)}else if(e.length===e.length+0){for(var n=0,o=e.length;n<o;n++)if(n in e&&r.call(i,e[n],n)===this.BREAK)return}else{for(var n in e)if(r.call(i,e[n],n)===this.BREAK)return}},defer:function(t){setTimeout(t,0)},toArray:function(t){if(t.toArray)return t.toArray();return e.call(t)},isUndefined:function(t){return t===undefined},isNull:function(t){return t===null},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===false||t===true},isFunction:function(t){return Object.prototype.toString.call(t)==="[object Function]"}}}();i.controllers.Controller=function(t){var e=function(t,e){this.initialValue=t[e];this.domElement=document.createElement("div");this.object=t;this.property=e;this.__onChange=undefined;this.__onFinishChange=undefined};t.extend(e.prototype,{onChange:function(t){this.__onChange=t;return this},onFinishChange:function(t){this.__onFinishChange=t;return this},setValue:function(t){this.object[this.property]=t;if(this.__onChange){this.__onChange.call(this,t)}this.updateDisplay();return this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}});return e}(i.utils.common);i.dom.dom=function(t){var e={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]};var r={};t.each(e,function(e,i){t.each(e,function(t){r[t]=i})});var i=/(\d+(\.\d+)?)px/;function n(e){if(e==="0"||t.isUndefined(e))return 0;var r=e.match(i);if(!t.isNull(r)){return parseFloat(r[1])}return 0}var o={makeSelectable:function(t,e){if(t===undefined||t.style===undefined)return;t.onselectstart=e?function(){return false}:function(){};t.style.MozUserSelect=e?"auto":"none";t.style.KhtmlUserSelect=e?"auto":"none";t.unselectable=e?"on":"off"},makeFullscreen:function(e,r,i){if(t.isUndefined(r))r=true;if(t.isUndefined(i))i=true;e.style.position="absolute";if(r){e.style.left=0;e.style.right=0}if(i){e.style.top=0;e.style.bottom=0}},fakeEvent:function(e,i,n,o){n=n||{};var s=r[i];if(!s){throw new Error("Event type "+i+" not supported.")}var a=document.createEvent(s);switch(s){case"MouseEvents":var l=n.x||n.clientX||0;var h=n.y||n.clientY||0;a.initMouseEvent(i,n.bubbles||false,n.cancelable||true,window,n.clickCount||1,0,0,l,h,false,false,false,false,0,null);break;case"KeyboardEvents":var u=a.initKeyboardEvent||a.initKeyEvent;t.defaults(n,{cancelable:true,ctrlKey:false,altKey:false,shiftKey:false,metaKey:false,keyCode:undefined,charCode:undefined});u(i,n.bubbles||false,n.cancelable,window,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.keyCode,n.charCode);break;default:a.initEvent(i,n.bubbles||false,n.cancelable||true);break}t.defaults(a,o);e.dispatchEvent(a)},bind:function(t,e,r,i){i=i||false;if(t.addEventListener)t.addEventListener(e,r,i);else if(t.attachEvent)t.attachEvent("on"+e,r);return o},unbind:function(t,e,r,i){i=i||false;if(t.removeEventListener)t.removeEventListener(e,r,i);else if(t.detachEvent)t.detachEvent("on"+e,r);return o},addClass:function(t,e){if(t.className===undefined){t.className=e}else if(t.className!==e){var r=t.className.split(/ +/);if(r.indexOf(e)==-1){r.push(e);t.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,"")}}return o},removeClass:function(t,e){if(e){if(t.className===undefined){}else if(t.className===e){t.removeAttribute("class")}else{var r=t.className.split(/ +/);var i=r.indexOf(e);if(i!=-1){r.splice(i,1);t.className=r.join(" ")}}}else{t.className=undefined}return o},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||false},getWidth:function(t){var e=getComputedStyle(t);return n(e["border-left-width"])+n(e["border-right-width"])+n(e["padding-left"])+n(e["padding-right"])+n(e["width"])},getHeight:function(t){var e=getComputedStyle(t);return n(e["border-top-width"])+n(e["border-bottom-width"])+n(e["padding-top"])+n(e["padding-bottom"])+n(e["height"])},getOffset:function(t){var e={left:0,top:0};if(t.offsetParent){do{e.left+=t.offsetLeft;e.top+=t.offsetTop}while(t=t.offsetParent)}return e},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};return o}(i.utils.common);i.controllers.OptionController=function(t,e,r){var i=function(t,n,o){i.superclass.call(this,t,n);var s=this;this.__select=document.createElement("select");if(r.isArray(o)){var a={};r.each(o,function(t){a[t]=t});o=a}r.each(o,function(t,e){var r=document.createElement("option");r.innerHTML=e;r.setAttribute("value",t);s.__select.appendChild(r)});this.updateDisplay();e.bind(this.__select,"change",function(){var t=this.options[this.selectedIndex].value;s.setValue(t)});this.domElement.appendChild(this.__select)};i.superclass=t;r.extend(i.prototype,t.prototype,{setValue:function(t){var e=i.superclass.prototype.setValue.call(this,t);if(this.__onFinishChange){this.__onFinishChange.call(this,this.getValue())}return e},updateDisplay:function(){this.__select.value=this.getValue();return i.superclass.prototype.updateDisplay.call(this)}});return i}(i.controllers.Controller,i.dom.dom,i.utils.common);i.controllers.NumberController=function(t,e){var r=function(t,n,o){r.superclass.call(this,t,n);o=o||{};this.__min=o.min;this.__max=o.max;this.__step=o.step;if(e.isUndefined(this.__step)){if(this.initialValue==0){this.__impliedStep=1}else{this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10}}else{this.__impliedStep=this.__step}this.__precision=i(this.__impliedStep)};r.superclass=t;e.extend(r.prototype,t.prototype,{setValue:function(t){if(this.__min!==undefined&&t<this.__min){t=this.__min}else if(this.__max!==undefined&&t>this.__max){t=this.__max}if(this.__step!==undefined&&t%this.__step!=0){t=Math.round(t/this.__step)*this.__step}return r.superclass.prototype.setValue.call(this,t)},min:function(t){this.__min=t;return this},max:function(t){this.__max=t;return this},step:function(t){this.__step=t;return this}});function i(t){t=t.toString();if(t.indexOf(".")>-1){return t.length-t.indexOf(".")-1}else{return 0}}return r}(i.controllers.Controller,i.utils.common);i.controllers.NumberControllerBox=function(t,e,r){var i=function(t,n,o){this.__truncationSuspended=false;i.superclass.call(this,t,n,o);var s=this;var a;this.__input=document.createElement("input");this.__input.setAttribute("type","text");e.bind(this.__input,"change",l);e.bind(this.__input,"blur",h);e.bind(this.__input,"mousedown",u);e.bind(this.__input,"keydown",function(t){if(t.keyCode===13){s.__truncationSuspended=true;this.blur();s.__truncationSuspended=false}});function l(){var t=parseFloat(s.__input.value);if(!r.isNaN(t))s.setValue(t)}function h(){l();if(s.__onFinishChange){s.__onFinishChange.call(s,s.getValue())}}function u(t){e.bind(window,"mousemove",c);e.bind(window,"mouseup",f);a=t.clientY}function c(t){var e=a-t.clientY;s.setValue(s.getValue()+e*s.__impliedStep);a=t.clientY}function f(){e.unbind(window,"mousemove",c);e.unbind(window,"mouseup",f)}this.updateDisplay();this.domElement.appendChild(this.__input)};i.superclass=t;r.extend(i.prototype,t.prototype,{updateDisplay:function(){this.__input.value=this.__truncationSuspended?this.getValue():n(this.getValue(),this.__precision);return i.superclass.prototype.updateDisplay.call(this)}});function n(t,e){var r=Math.pow(10,e);return Math.round(t*r)/r}return i}(i.controllers.NumberController,i.dom.dom,i.utils.common);i.controllers.NumberControllerSlider=function(t,e,r,i,n){var o=function(t,r,i,n,a){o.superclass.call(this,t,r,{min:i,max:n,step:a});var l=this;this.__background=document.createElement("div");this.__foreground=document.createElement("div");e.bind(this.__background,"mousedown",h);e.addClass(this.__background,"slider");e.addClass(this.__foreground,"slider-fg");function h(t){e.bind(window,"mousemove",u);e.bind(window,"mouseup",c);u(t)}function u(t){t.preventDefault();var r=e.getOffset(l.__background);var i=e.getWidth(l.__background);l.setValue(s(t.clientX,r.left,r.left+i,l.__min,l.__max));return false}function c(){e.unbind(window,"mousemove",u);e.unbind(window,"mouseup",c);if(l.__onFinishChange){l.__onFinishChange.call(l,l.getValue())}}this.updateDisplay();this.__background.appendChild(this.__foreground);this.domElement.appendChild(this.__background)};o.superclass=t;o.useDefaultStyles=function(){r.inject(n)};i.extend(o.prototype,t.prototype,{updateDisplay:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);this.__foreground.style.width=t*100+"%";return o.superclass.prototype.updateDisplay.call(this)}});function s(t,e,r,i,n){return i+(n-i)*((t-e)/(r-e))}return o}(i.controllers.NumberController,i.dom.dom,i.utils.css,i.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}");i.controllers.FunctionController=function(t,e,r){var i=function(t,r,n){i.superclass.call(this,t,r);var o=this;this.__button=document.createElement("div");this.__button.innerHTML=n===undefined?"Fire":n;e.bind(this.__button,"click",function(t){t.preventDefault();o.fire();return false});e.addClass(this.__button,"button");this.domElement.appendChild(this.__button)};i.superclass=t;r.extend(i.prototype,t.prototype,{fire:function(){if(this.__onChange){this.__onChange.call(this)}if(this.__onFinishChange){this.__onFinishChange.call(this,this.getValue())}this.getValue().call(this.object)}});return i}(i.controllers.Controller,i.dom.dom,i.utils.common);i.controllers.BooleanController=function(t,e,r){var i=function(t,r){i.superclass.call(this,t,r);var n=this;this.__prev=this.getValue();this.__checkbox=document.createElement("input");this.__checkbox.setAttribute("type","checkbox");e.bind(this.__checkbox,"change",o,false);this.domElement.appendChild(this.__checkbox);this.updateDisplay();function o(){n.setValue(!n.__prev)}};i.superclass=t;r.extend(i.prototype,t.prototype,{setValue:function(t){var e=i.superclass.prototype.setValue.call(this,t);if(this.__onFinishChange){this.__onFinishChange.call(this,this.getValue())}this.__prev=this.getValue();return e},updateDisplay:function(){if(this.getValue()===true){this.__checkbox.setAttribute("checked","checked");this.__checkbox.checked=true}else{this.__checkbox.checked=false}return i.superclass.prototype.updateDisplay.call(this)}});return i}(i.controllers.Controller,i.dom.dom,i.utils.common);i.color.toString=function(t){return function(e){if(e.a==1||t.isUndefined(e.a)){var r=e.hex.toString(16);while(r.length<6){r="0"+r}return"#"+r}else{return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}}(i.utils.common);i.color.interpret=function(t,e){var r,i;var n=function(){i=false;var t=arguments.length>1?e.toArray(arguments):arguments[0];e.each(o,function(n){if(n.litmus(t)){e.each(n.conversions,function(n,o){r=n.read(t);if(i===false&&r!==false){i=r;r.conversionName=o;r.conversion=n;return e.BREAK}});return e.BREAK}});return i};var o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);if(e===null)return false;return{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);if(e===null)return false;return{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);if(e===null)return false;return{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);if(e===null)return false;return{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){if(t.length!=3)return false;return{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){if(t.length!=4)return false;return{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){if(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a)){return{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}}return false},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){if(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)){return{space:"RGB",r:t.r,g:t.g,b:t.b}}return false},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){if(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a)){return{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}}return false},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){if(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)){return{space:"HSV",h:t.h,s:t.s,v:t.v}}return false},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return n}(i.color.toString,i.utils.common);i.GUI=i.gui.GUI=function(t,e,r,i,n,o,s,a,l,h,u,c,f,d,p){t.inject(r);var v="dg";var g=72;var m=20;var y="Default";var x=function(){try{return"localStorage"in window&&window["localStorage"]!==null}catch(t){return false}}();var _;var b=true;var T;var w=false;var E=[];var S=function(t){var e=this;this.domElement=document.createElement("div");

this.__ul=document.createElement("ul");this.domElement.appendChild(this.__ul);d.addClass(this.domElement,v);this.__folders={};this.__controllers=[];this.__rememberedObjects=[];this.__rememberedObjectIndecesToControllers=[];this.__listening=[];t=t||{};t=p.defaults(t,{autoPlace:true,width:S.DEFAULT_WIDTH});t=p.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace});if(!p.isUndefined(t.load)){if(t.preset)t.load.preset=t.preset}else{t.load={preset:y}}if(p.isUndefined(t.parent)&&t.hideable){E.push(this)}t.resizable=p.isUndefined(t.parent)&&t.resizable;if(t.autoPlace&&p.isUndefined(t.scrollable)){t.scrollable=true}var r=x&&localStorage.getItem(O(this,"isLocal"))==="true";Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){if(e.parent){return e.getRoot().preset}else{return t.load.preset}},set:function(r){if(e.parent){e.getRoot().preset=r}else{t.load.preset=r}k(this);e.revert()}},width:{get:function(){return t.width},set:function(r){t.width=r;P(e,r)}},name:{get:function(){return t.name},set:function(e){t.name=e;if(n){n.innerHTML=t.name}}},closed:{get:function(){return t.closed},set:function(r){t.closed=r;if(t.closed){d.addClass(e.__ul,S.CLASS_CLOSED)}else{d.removeClass(e.__ul,S.CLASS_CLOSED)}this.onResize();if(e.__closeButton){e.__closeButton.innerHTML=r?S.TEXT_OPEN:S.TEXT_CLOSED}}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return r},set:function(t){if(x){r=t;if(t){d.bind(window,"unload",a)}else{d.unbind(window,"unload",a)}localStorage.setItem(O(e,"isLocal"),t)}}}});if(p.isUndefined(t.parent)){t.closed=false;d.addClass(this.domElement,S.CLASS_MAIN);d.makeSelectable(this.domElement,false);if(x){if(r){e.useLocalStorage=true;var i=localStorage.getItem(O(this,"gui"));if(i){t.load=JSON.parse(i)}}}this.__closeButton=document.createElement("div");this.__closeButton.innerHTML=S.TEXT_CLOSED;d.addClass(this.__closeButton,S.CLASS_CLOSE_BUTTON);this.domElement.appendChild(this.__closeButton);d.bind(this.__closeButton,"click",function(){e.closed=!e.closed})}else{if(t.closed===undefined){t.closed=true}var n=document.createTextNode(t.name);d.addClass(n,"controller-name");var o=A(e,n);var s=function(t){t.preventDefault();e.closed=!e.closed;return false};d.addClass(this.__ul,S.CLASS_CLOSED);d.addClass(o,"title");d.bind(o,"click",s);if(!t.closed){this.closed=false}}if(t.autoPlace){if(p.isUndefined(t.parent)){if(b){T=document.createElement("div");d.addClass(T,v);d.addClass(T,S.CLASS_AUTO_PLACE_CONTAINER);document.body.appendChild(T);b=false}T.appendChild(this.domElement);d.addClass(this.domElement,S.CLASS_AUTO_PLACE)}if(!this.parent)P(e,t.width)}d.bind(window,"resize",function(){e.onResize()});d.bind(this.__ul,"webkitTransitionEnd",function(){e.onResize()});d.bind(this.__ul,"transitionend",function(){e.onResize()});d.bind(this.__ul,"oTransitionEnd",function(){e.onResize()});this.onResize();if(t.resizable){F(this)}function a(){localStorage.setItem(O(e,"gui"),JSON.stringify(e.getSaveObject()))}var l=e.getRoot();function h(){var t=e.getRoot();t.width+=1;p.defer(function(){t.width-=1})}if(!t.parent){h()}};S.toggleHide=function(){w=!w;p.each(E,function(t){t.domElement.style.zIndex=w?-999:999;t.domElement.style.opacity=w?0:1})};S.CLASS_AUTO_PLACE="a";S.CLASS_AUTO_PLACE_CONTAINER="ac";S.CLASS_MAIN="main";S.CLASS_CONTROLLER_ROW="cr";S.CLASS_TOO_TALL="taller-than-window";S.CLASS_CLOSED="closed";S.CLASS_CLOSE_BUTTON="close-button";S.CLASS_DRAG="drag";S.DEFAULT_WIDTH=245;S.TEXT_CLOSED="Close Controls";S.TEXT_OPEN="Open Controls";d.bind(window,"keydown",function(t){if(document.activeElement.type!=="text"&&(t.which===g||t.keyCode==g)){S.toggleHide()}},false);p.extend(S.prototype,{add:function(t,e){return C(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return C(this,t,e,{color:true})},remove:function(t){this.__ul.removeChild(t.__li);this.__controllers.slice(this.__controllers.indexOf(t),1);var e=this;p.defer(function(){e.onResize()})},destroy:function(){if(this.autoPlace){T.removeChild(this.domElement)}},addFolder:function(t){if(this.__folders[t]!==undefined){throw new Error("You already have a folder in this GUI by the"+' name "'+t+'"')}var e={name:t,parent:this};e.autoPlace=this.autoPlace;if(this.load&&this.load.folders&&this.load.folders[t]){e.closed=this.load.folders[t].closed;e.load=this.load.folders[t]}var r=new S(e);this.__folders[t]=r;var i=A(this,r.domElement);d.addClass(i,"folder");return r},open:function(){this.closed=false},close:function(){this.closed=true},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=d.getOffset(t.__ul).top;var r=0;p.each(t.__ul.childNodes,function(e){if(!(t.autoPlace&&e===t.__save_row))r+=d.getHeight(e)});if(window.innerHeight-e-m<r){d.addClass(t.domElement,S.CLASS_TOO_TALL);t.__ul.style.height=window.innerHeight-e-m+"px"}else{d.removeClass(t.domElement,S.CLASS_TOO_TALL);t.__ul.style.height="auto"}}if(t.__resize_handle){p.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"})}if(t.__closeButton){t.__closeButton.style.width=t.width+"px"}},remember:function(){if(p.isUndefined(_)){_=new f;_.domElement.innerHTML=e}if(this.parent){throw new Error("You can only call remember on a top level GUI.")}var t=this;p.each(Array.prototype.slice.call(arguments),function(e){if(t.__rememberedObjects.length==0){D(t)}if(t.__rememberedObjects.indexOf(e)==-1){t.__rememberedObjects.push(e)}});if(this.autoPlace){P(this,this.width)}},getRoot:function(){var t=this;while(t.parent){t=t.parent}return t},getSaveObject:function(){var t=this.load;t.closed=this.closed;if(this.__rememberedObjects.length>0){t.preset=this.preset;if(!t.remembered){t.remembered={}}t.remembered[this.preset]=B(this)}t.folders={};p.each(this.__folders,function(e,r){t.folders[r]=e.getSaveObject()});return t},save:function(){if(!this.load.remembered){this.load.remembered={}}this.load.remembered[this.preset]=B(this);I(this,false)},saveAs:function(t){if(!this.load.remembered){this.load.remembered={};this.load.remembered[y]=B(this,true)}this.load.remembered[t]=B(this);this.preset=t;L(this,t,true)},revert:function(t){p.each(this.__controllers,function(e){if(!this.getRoot().load.remembered){e.setValue(e.initialValue)}else{M(t||this.getRoot(),e)}},this);p.each(this.__folders,function(t){t.revert(t)});if(!t){I(this.getRoot(),false)}},listen:function(t){var e=this.__listening.length==0;this.__listening.push(t);if(e)N(this.__listening)}});function C(t,e,r,o){if(e[r]===undefined){throw new Error("Object "+e+' has no property "'+r+'"')}var s;if(o.color){s=new u(e,r)}else{var a=[e,r].concat(o.factoryArgs);s=i.apply(t,a)}if(o.before instanceof n){o.before=o.before.__li}M(t,s);d.addClass(s.domElement,"c");var l=document.createElement("span");d.addClass(l,"property-name");l.innerHTML=s.property;var h=document.createElement("div");h.appendChild(l);h.appendChild(s.domElement);var c=A(t,h,o.before);d.addClass(c,S.CLASS_CONTROLLER_ROW);d.addClass(c,typeof s.getValue());R(t,c,s);t.__controllers.push(s);return s}function A(t,e,r){var i=document.createElement("li");if(e)i.appendChild(e);if(r){t.__ul.insertBefore(i,params.before)}else{t.__ul.appendChild(i)}t.onResize();return i}function R(t,e,r){r.__li=e;r.__gui=t;p.extend(r,{options:function(e){if(arguments.length>1){r.remove();return C(t,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]})}if(p.isArray(e)||p.isObject(e)){r.remove();return C(t,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[e]})}},name:function(t){r.__li.firstElementChild.firstElementChild.innerHTML=t;return r},listen:function(){r.__gui.listen(r);return r},remove:function(){r.__gui.remove(r);return r}});if(r instanceof l){var i=new a(r.object,r.property,{min:r.__min,max:r.__max,step:r.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(t){var e=r[t];var n=i[t];r[t]=i[t]=function(){var t=Array.prototype.slice.call(arguments);e.apply(r,t);return n.apply(i,t)}});d.addClass(e,"has-slider");r.domElement.insertBefore(i.domElement,r.domElement.firstElementChild)}else if(r instanceof a){var n=function(e){if(p.isNumber(r.__min)&&p.isNumber(r.__max)){r.remove();return C(t,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[r.__min,r.__max,r.__step]})}return e};r.min=p.compose(n,r.min);r.max=p.compose(n,r.max)}else if(r instanceof o){d.bind(e,"click",function(){d.fakeEvent(r.__checkbox,"click")});d.bind(r.__checkbox,"click",function(t){t.stopPropagation()})}else if(r instanceof s){d.bind(e,"click",function(){d.fakeEvent(r.__button,"click")});d.bind(e,"mouseover",function(){d.addClass(r.__button,"hover")});d.bind(e,"mouseout",function(){d.removeClass(r.__button,"hover")})}else if(r instanceof u){d.addClass(e,"color");r.updateDisplay=p.compose(function(t){e.style.borderLeftColor=r.__color.toString();return t},r.updateDisplay);r.updateDisplay()}r.setValue=p.compose(function(e){if(t.getRoot().__preset_select&&r.isModified()){I(t.getRoot(),true)}return e},r.setValue)}function M(t,e){var r=t.getRoot();var i=r.__rememberedObjects.indexOf(e.object);if(i!=-1){var n=r.__rememberedObjectIndecesToControllers[i];if(n===undefined){n={};r.__rememberedObjectIndecesToControllers[i]=n}n[e.property]=e;if(r.load&&r.load.remembered){var o=r.load.remembered;var s;if(o[t.preset]){s=o[t.preset]}else if(o[y]){s=o[y]}else{return}if(s[i]&&s[i][e.property]!==undefined){var a=s[i][e.property];e.initialValue=a;e.setValue(a)}}}}function O(t,e){return document.location.href+"."+e}function D(t){var e=t.__save_row=document.createElement("li");d.addClass(t.domElement,"has-save");t.__ul.insertBefore(e,t.__ul.firstChild);d.addClass(e,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;";d.addClass(r,"button gears");var i=document.createElement("span");i.innerHTML="Save";d.addClass(i,"button");d.addClass(i,"save");var n=document.createElement("span");n.innerHTML="New";d.addClass(n,"button");d.addClass(n,"save-as");var o=document.createElement("span");o.innerHTML="Revert";d.addClass(o,"button");d.addClass(o,"revert");var s=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered){p.each(t.load.remembered,function(e,r){L(t,r,r==t.preset)})}else{L(t,y,false)}d.bind(s,"change",function(){for(var e=0;e<t.__preset_select.length;e++){t.__preset_select[e].innerHTML=t.__preset_select[e].value}t.preset=this.value});e.appendChild(s);e.appendChild(r);e.appendChild(i);e.appendChild(n);e.appendChild(o);if(x){var a=document.getElementById("dg-save-locally");var l=document.getElementById("dg-local-explain");a.style.display="block";var h=document.getElementById("dg-local-storage");if(localStorage.getItem(O(t,"isLocal"))==="true"){h.setAttribute("checked","checked")}function u(){l.style.display=t.useLocalStorage?"block":"none"}u();d.bind(h,"change",function(){t.useLocalStorage=!t.useLocalStorage;u()})}var c=document.getElementById("dg-new-constructor");d.bind(c,"keydown",function(t){if(t.metaKey&&(t.which===67||t.keyCode==67)){_.hide()}});d.bind(r,"click",function(){c.innerHTML=JSON.stringify(t.getSaveObject(),undefined,2);_.show();c.focus();c.select()});d.bind(i,"click",function(){t.save()});d.bind(n,"click",function(){var e=prompt("Enter a new preset name.");if(e)t.saveAs(e)});d.bind(o,"click",function(){t.revert()})}function F(t){t.__resize_handle=document.createElement("div");p.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var e;d.bind(t.__resize_handle,"mousedown",r);d.bind(t.__closeButton,"mousedown",r);t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild);function r(r){r.preventDefault();e=r.clientX;d.addClass(t.__closeButton,S.CLASS_DRAG);d.bind(window,"mousemove",i);d.bind(window,"mouseup",n);return false}function i(r){r.preventDefault();t.width+=e-r.clientX;t.onResize();e=r.clientX;return false}function n(){d.removeClass(t.__closeButton,S.CLASS_DRAG);d.unbind(window,"mousemove",i);d.unbind(window,"mouseup",n)}}function P(t,e){t.domElement.style.width=e+"px";if(t.__save_row&&t.autoPlace){t.__save_row.style.width=e+"px"}if(t.__closeButton){t.__closeButton.style.width=e+"px"}}function B(t,e){var r={};p.each(t.__rememberedObjects,function(i,n){var o={};var s=t.__rememberedObjectIndecesToControllers[n];p.each(s,function(t,r){o[r]=e?t.initialValue:t.getValue()});r[n]=o});return r}function L(t,e,r){var i=document.createElement("option");i.innerHTML=e;i.value=e;t.__preset_select.appendChild(i);if(r){t.__preset_select.selectedIndex=t.__preset_select.length-1}}function k(t){for(var e=0;e<t.__preset_select.length;e++){if(t.__preset_select[e].value==t.preset){t.__preset_select.selectedIndex=e}}}function I(t,e){var r=t.__preset_select[t.__preset_select.selectedIndex];if(e){r.innerHTML=r.value+"*"}else{r.innerHTML=r.value}}function N(t){if(t.length!=0){c(function(){N(t)})}p.each(t,function(t){t.updateDisplay()})}return S}(i.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",i.controllers.factory=function(t,e,r,i,n,o,s){return function(a,l){var h=a[l];if(s.isArray(arguments[2])||s.isObject(arguments[2])){return new t(a,l,arguments[2])}if(s.isNumber(h)){if(s.isNumber(arguments[2])&&s.isNumber(arguments[3])){return new r(a,l,arguments[2],arguments[3])}else{return new e(a,l,{min:arguments[2],max:arguments[3]})}}if(s.isString(h)){return new i(a,l)}if(s.isFunction(h)){return new n(a,l,"")}if(s.isBoolean(h)){return new o(a,l)}}}(i.controllers.OptionController,i.controllers.NumberControllerBox,i.controllers.NumberControllerSlider,i.controllers.StringController=function(t,e,r){var i=function(t,r){i.superclass.call(this,t,r);var n=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");e.bind(this.__input,"keyup",o);e.bind(this.__input,"change",o);e.bind(this.__input,"blur",s);e.bind(this.__input,"keydown",function(t){if(t.keyCode===13){this.blur()}});function o(){n.setValue(n.__input.value)}function s(){if(n.__onFinishChange){n.__onFinishChange.call(n,n.getValue())}}this.updateDisplay();this.domElement.appendChild(this.__input)};i.superclass=t;r.extend(i.prototype,t.prototype,{updateDisplay:function(){if(!e.isActive(this.__input)){this.__input.value=this.getValue()}return i.superclass.prototype.updateDisplay.call(this)}});return i}(i.controllers.Controller,i.dom.dom,i.utils.common),i.controllers.FunctionController,i.controllers.BooleanController,i.utils.common),i.controllers.Controller,i.controllers.BooleanController,i.controllers.FunctionController,i.controllers.NumberControllerBox,i.controllers.NumberControllerSlider,i.controllers.OptionController,i.controllers.ColorController=function(t,e,r,i,n){var o=function(t,s){o.superclass.call(this,t,s);this.__color=new r(this.getValue());this.__temp=new r(0);var h=this;this.domElement=document.createElement("div");e.makeSelectable(this.domElement,false);this.__selector=document.createElement("div");this.__selector.className="selector";this.__saturation_field=document.createElement("div");this.__saturation_field.className="saturation-field";this.__field_knob=document.createElement("div");this.__field_knob.className="field-knob";this.__field_knob_border="2px solid ";this.__hue_knob=document.createElement("div");this.__hue_knob.className="hue-knob";this.__hue_field=document.createElement("div");this.__hue_field.className="hue-field";this.__input=document.createElement("input");this.__input.type="text";this.__input_textShadow="0 1px 1px ";e.bind(this.__input,"keydown",function(t){if(t.keyCode===13){d.call(this)}});e.bind(this.__input,"blur",d);e.bind(this.__selector,"mousedown",function(t){e.addClass(this,"drag").bind(window,"mouseup",function(t){e.removeClass(h.__selector,"drag")})});var u=document.createElement("div");n.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"});n.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1});n.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1});n.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"});n.extend(u.style,{width:"100%",height:"100%",background:"none"});a(u,"top","rgba(0,0,0,0)","#000");n.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"});l(this.__hue_field);n.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"});e.bind(this.__saturation_field,"mousedown",c);e.bind(this.__field_knob,"mousedown",c);e.bind(this.__hue_field,"mousedown",function(t){g(t);e.bind(window,"mousemove",g);e.bind(window,"mouseup",p)});function c(t){v(t);e.bind(window,"mousemove",v);e.bind(window,"mouseup",f)}function f(){e.unbind(window,"mousemove",v);e.unbind(window,"mouseup",f)}function d(){var t=i(this.value);if(t!==false){h.__color.__state=t;h.setValue(h.__color.toOriginal())}else{this.value=h.__color.toString()}}function p(){e.unbind(window,"mousemove",g);e.unbind(window,"mouseup",p)}this.__saturation_field.appendChild(u);this.__selector.appendChild(this.__field_knob);this.__selector.appendChild(this.__saturation_field);this.__selector.appendChild(this.__hue_field);this.__hue_field.appendChild(this.__hue_knob);this.domElement.appendChild(this.__input);this.domElement.appendChild(this.__selector);this.updateDisplay();function v(t){t.preventDefault();var r=e.getWidth(h.__saturation_field);var i=e.getOffset(h.__saturation_field);var n=(t.clientX-i.left+document.body.scrollLeft)/r;var o=1-(t.clientY-i.top+document.body.scrollTop)/r;if(o>1)o=1;else if(o<0)o=0;if(n>1)n=1;else if(n<0)n=0;h.__color.v=o;h.__color.s=n;h.setValue(h.__color.toOriginal());return false}function g(t){t.preventDefault();var r=e.getHeight(h.__hue_field);var i=e.getOffset(h.__hue_field);var n=1-(t.clientY-i.top+document.body.scrollTop)/r;if(n>1)n=1;else if(n<0)n=0;h.__color.h=n*360;h.setValue(h.__color.toOriginal());return false}};o.superclass=t;n.extend(o.prototype,t.prototype,{updateDisplay:function(){var t=i(this.getValue());if(t!==false){var e=false;n.each(r.COMPONENTS,function(r){if(!n.isUndefined(t[r])&&!n.isUndefined(this.__color.__state[r])&&t[r]!==this.__color.__state[r]){e=true;return{}}},this);if(e){n.extend(this.__color.__state,t)}}n.extend(this.__temp.__state,this.__color.__state);this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0;var s=255-o;n.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"});this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px";this.__temp.s=1;this.__temp.v=1;a(this.__saturation_field,"left","#fff",this.__temp.toString());n.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+s+","+s+","+s+",.7)"})}});var s=["-moz-","-o-","-webkit-","-ms-",""];function a(t,e,r,i){t.style.background="";n.each(s,function(n){t.style.cssText+="background: "+n+"linear-gradient("+e+", "+r+" 0%, "+i+" 100%); "})}function l(t){t.style.background="";t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);";t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}return o}(i.controllers.Controller,i.dom.dom,i.color.Color=function(t,e,r,i){var n=function(){this.__state=t.apply(this,arguments);if(this.__state===false){throw"Failed to interpret color arguments"}this.__state.a=this.__state.a||1};n.COMPONENTS=["r","g","b","h","s","v","hex","a"];i.extend(n.prototype,{toString:function(){return r(this)},toOriginal:function(){return this.__state.conversion.write(this)}});o(n.prototype,"r",2);o(n.prototype,"g",1);o(n.prototype,"b",0);s(n.prototype,"h");s(n.prototype,"s");s(n.prototype,"v");Object.defineProperty(n.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}});Object.defineProperty(n.prototype,"hex",{get:function(){if(!this.__state.space!=="HEX"){this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)}return this.__state.hex},set:function(t){this.__state.space="HEX";this.__state.hex=t}});function o(t,e,r){Object.defineProperty(t,e,{get:function(){if(this.__state.space==="RGB"){return this.__state[e]}a(this,e,r);return this.__state[e]},set:function(t){if(this.__state.space!=="RGB"){a(this,e,r);this.__state.space="RGB"}this.__state[e]=t}})}function s(t,e){Object.defineProperty(t,e,{get:function(){if(this.__state.space==="HSV")return this.__state[e];l(this);return this.__state[e]},set:function(t){if(this.__state.space!=="HSV"){l(this);this.__state.space="HSV"}this.__state[e]=t}})}function a(t,r,n){if(t.__state.space==="HEX"){t.__state[r]=e.component_from_hex(t.__state.hex,n)}else if(t.__state.space==="HSV"){i.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}else{throw"Corrupted color state"}}function l(t){var r=e.rgb_to_hsv(t.r,t.g,t.b);i.extend(t.__state,{s:r.s,v:r.v});if(!i.isNaN(r.h)){t.__state.h=r.h}else if(i.isUndefined(t.__state.h)){t.__state.h=0}}return n}(i.color.interpret,i.color.math=function(){var t;return{hsv_to_rgb:function(t,e,r){var i=Math.floor(t/60)%6;var n=t/60-Math.floor(t/60);var o=r*(1-e);var s=r*(1-n*e);var a=r*(1-(1-n)*e);var l=[[r,a,o],[s,r,o],[o,r,a],[o,s,r],[a,o,r],[r,o,s]][i];return{r:l[0]*255,g:l[1]*255,b:l[2]*255}},rgb_to_hsv:function(t,e,r){var i=Math.min(t,e,r),n=Math.max(t,e,r),o=n-i,s,a;if(n!=0){a=o/n}else{return{h:NaN,s:0,v:0}}if(t==n){s=(e-r)/o}else if(e==n){s=2+(r-t)/o}else{s=4+(t-e)/o}s/=6;if(s<0){s+=1}return{h:s*360,s:a,v:n/255}},rgb_to_hex:function(t,e,r){var i=this.hex_with_component(0,2,t);i=this.hex_with_component(i,1,e);i=this.hex_with_component(i,0,r);return i},component_from_hex:function(t,e){return t>>e*8&255},hex_with_component:function(e,r,i){return i<<(t=r*8)|e&~(255<<t)}}}(),i.color.toString,i.utils.common),i.color.interpret,i.utils.common),i.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}(),i.dom.CenteredDiv=function(t,e){var r=function(){this.backgroundElement=document.createElement("div");e.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"});t.makeFullscreen(this.backgroundElement);this.backgroundElement.style.position="fixed";this.domElement=document.createElement("div");e.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"});document.body.appendChild(this.backgroundElement);document.body.appendChild(this.domElement);var r=this;t.bind(this.backgroundElement,"click",function(){r.hide()})};r.prototype.show=function(){var t=this;this.backgroundElement.style.display="block";this.domElement.style.display="block";this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)";this.layout();e.defer(function(){t.backgroundElement.style.opacity=1;t.domElement.style.opacity=1;t.domElement.style.webkitTransform="scale(1)"})};r.prototype.hide=function(){var e=this;var r=function(){e.domElement.style.display="none";e.backgroundElement.style.display="none";t.unbind(e.domElement,"webkitTransitionEnd",r);t.unbind(e.domElement,"transitionend",r);t.unbind(e.domElement,"oTransitionEnd",r)};t.bind(this.domElement,"webkitTransitionEnd",r);t.bind(this.domElement,"transitionend",r);t.bind(this.domElement,"oTransitionEnd",r);this.backgroundElement.style.opacity=0;this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)"};r.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-t.getWidth(this.domElement)/2+"px";this.domElement.style.top=window.innerHeight/2-t.getHeight(this.domElement)/2+"px"};function i(t){console.log(t)}return r}(i.dom.dom,i.utils.common),i.dom.dom,i.utils.common)},{}],13:[function(t,e,r){!function(t,r){if(typeof e!="undefined")e.exports=r();else if(typeof define=="function"&&typeof define.amd=="object")define(r);else this[t]=r()}("domready",function(){var t=[],e,r=document,i=r.documentElement.doScroll,n="DOMContentLoaded",o=(i?/^loaded|^c/:/^loaded|^i|^c/).test(r.readyState);if(!o)r.addEventListener(n,e=function(){r.removeEventListener(n,e);o=1;while(e=t.shift())e()});return function(e){o?e():t.push(e)}})},{}],14:[function(t,e,r){var i=t("../internal/LazyWrapper"),n=t("../internal/LodashWrapper"),o=t("../internal/baseLodash"),s=t("../lang/isArray"),a=t("../internal/isObjectLike"),l=t("../internal/wrapperClone");var h=Object.prototype;var u=h.hasOwnProperty;function c(t){if(a(t)&&!s(t)&&!(t instanceof i)){if(t instanceof n){return t}if(u.call(t,"__chain__")&&u.call(t,"__wrapped__")){return l(t)}}return new n(t)}c.prototype=o.prototype;e.exports=c},{"../internal/LazyWrapper":18,"../internal/LodashWrapper":19,"../internal/baseLodash":25,
"../internal/isObjectLike":41,"../internal/wrapperClone":48,"../lang/isArray":50}],15:[function(t,e,r){var i=t("../lang/isNative");var n=i(n=Date.now)&&n;var o=n||function(){return(new Date).getTime()};e.exports=o},{"../lang/isNative":52}],16:[function(t,e,r){var i=t("../internal/baseFlatten"),n=t("../internal/createWrapper"),o=t("../object/functions"),s=t("./restParam");var a=1;var l=s(function(t,e){e=e.length?i(e):o(t);var r=-1,s=e.length;while(++r<s){var l=e[r];t[l]=n(t[l],a,t)}return t});e.exports=l},{"../internal/baseFlatten":22,"../internal/createWrapper":35,"../object/functions":54,"./restParam":17}],17:[function(t,e,r){var i="Expected a function";var n=Math.max;function o(t,e){if(typeof t!="function"){throw new TypeError(i)}e=n(e===undefined?t.length-1:+e||0,0);return function(){var r=arguments,i=-1,o=n(r.length-e,0),s=Array(o);while(++i<o){s[i]=r[e+i]}switch(e){case 0:return t.call(this,s);case 1:return t.call(this,r[0],s);case 2:return t.call(this,r[0],r[1],s)}var a=Array(e+1);i=-1;while(++i<e){a[i]=r[i]}a[e]=s;return t.apply(this,a)}}e.exports=o},{}],18:[function(t,e,r){var i=t("./baseCreate"),n=t("./baseLodash");var o=Number.POSITIVE_INFINITY;function s(t){this.__wrapped__=t;this.__actions__=null;this.__dir__=1;this.__dropCount__=0;this.__filtered__=false;this.__iteratees__=null;this.__takeCount__=o;this.__views__=null}s.prototype=i(n.prototype);s.prototype.constructor=s;e.exports=s},{"./baseCreate":21,"./baseLodash":25}],19:[function(t,e,r){var i=t("./baseCreate"),n=t("./baseLodash");function o(t,e,r){this.__wrapped__=t;this.__actions__=r||[];this.__chain__=!!e}o.prototype=i(n.prototype);o.prototype.constructor=o;e.exports=o},{"./baseCreate":21,"./baseLodash":25}],20:[function(t,e,r){function i(t,e){var r=-1,i=t.length;e||(e=Array(i));while(++r<i){e[r]=t[r]}return e}e.exports=i},{}],21:[function(t,e,r){(function(r){var i=t("../lang/isObject");var n=function(){function t(){}return function(e){if(i(e)){t.prototype=e;var n=new t;t.prototype=null}return n||r.Object()}}();e.exports=n}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../lang/isObject":53}],22:[function(t,e,r){var i=t("../lang/isArguments"),n=t("../lang/isArray"),o=t("./isLength"),s=t("./isObjectLike");function a(t,e,r){var l=-1,h=t.length,u=-1,c=[];while(++l<h){var f=t[l];if(s(f)&&o(f.length)&&(n(f)||i(f))){if(e){f=a(f,e,r)}var d=-1,p=f.length;c.length+=p;while(++d<p){c[++u]=f[d]}}else if(!r){c[++u]=f}}return c}e.exports=a},{"../lang/isArguments":49,"../lang/isArray":50,"./isLength":40,"./isObjectLike":41}],23:[function(t,e,r){var i=t("../lang/isFunction");function n(t,e){var r=-1,n=e.length,o=-1,s=[];while(++r<n){var a=e[r];if(i(t[a])){s[++o]=a}}return s}e.exports=n},{"../lang/isFunction":51}],24:[function(t,e,r){function i(t){return typeof t=="function"||false}e.exports=i},{}],25:[function(t,e,r){function i(){}e.exports=i},{}],26:[function(t,e,r){function i(t){return function(e){return e==null?undefined:e[t]}}e.exports=i},{}],27:[function(t,e,r){var i=t("../utility/identity"),n=t("./metaMap");var o=!n?i:function(t,e){n.set(t,e);return t};e.exports=o},{"../utility/identity":59,"./metaMap":43}],28:[function(t,e,r){function i(t){if(typeof t=="string"){return t}return t==null?"":t+""}e.exports=i},{}],29:[function(t,e,r){var i=Math.max;function n(t,e,r){var n=r.length,o=-1,s=i(t.length-n,0),a=-1,l=e.length,h=Array(s+l);while(++a<l){h[a]=e[a]}while(++o<n){h[r[o]]=t[o]}while(s--){h[a++]=t[o++]}return h}e.exports=n},{}],30:[function(t,e,r){var i=Math.max;function n(t,e,r){var n=-1,o=r.length,s=-1,a=i(t.length-o,0),l=-1,h=e.length,u=Array(a+h);while(++s<a){u[s]=t[s]}var c=s;while(++l<h){u[c+l]=e[l]}while(++n<o){u[c+r[n]]=t[s++]}return u}e.exports=n},{}],31:[function(t,e,r){(function(r){var i=t("./createCtorWrapper");function n(t,e){var n=i(t);function o(){var i=this&&this!==r&&this instanceof o?n:t;return i.apply(e,arguments)}return o}e.exports=n}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./createCtorWrapper":32}],32:[function(t,e,r){var i=t("./baseCreate"),n=t("../lang/isObject");function o(t){return function(){var e=i(t.prototype),r=t.apply(e,arguments);return n(r)?r:e}}e.exports=o},{"../lang/isObject":53,"./baseCreate":21}],33:[function(t,e,r){(function(r){var i=t("./arrayCopy"),n=t("./composeArgs"),o=t("./composeArgsRight"),s=t("./createCtorWrapper"),a=t("./isLaziable"),l=t("./reorder"),h=t("./replaceHolders"),u=t("./setData");var c=1,f=2,d=4,p=8,v=16,g=32,m=64,y=128;var x=Math.max;function _(t,e,b,T,w,E,S,C,A,R){var M=e&y,O=e&c,D=e&f,F=e&p,P=e&d,B=e&v;var L=!D&&s(t),k=t;function I(){var d=arguments.length,p=d,v=Array(d);while(p--){v[p]=arguments[p]}if(T){v=n(v,T,w)}if(E){v=o(v,E,S)}if(F||B){var y=I.placeholder,N=h(v,y);d-=N.length;if(d<R){var U=C?i(C):null,j=x(R-d,0),X=F?N:null,Y=F?null:N,W=F?v:null,z=F?null:v;e|=F?g:m;e&=~(F?m:g);if(!P){e&=~(c|f)}var G=[t,e,b,W,X,z,Y,U,A,j],H=_.apply(undefined,G);if(a(t)){u(H,G)}H.placeholder=y;return H}}var V=O?b:this;if(D){t=V[k]}if(C){v=l(v,C)}if(M&&A<v.length){v.length=A}var q=this&&this!==r&&this instanceof I?L||s(t):t;return q.apply(V,v)}return I}e.exports=_}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./arrayCopy":20,"./composeArgs":29,"./composeArgsRight":30,"./createCtorWrapper":32,"./isLaziable":39,"./reorder":45,"./replaceHolders":46,"./setData":47}],34:[function(t,e,r){(function(r){var i=t("./createCtorWrapper");var n=1;function o(t,e,o,s){var a=e&n,l=i(t);function h(){var e=-1,i=arguments.length,n=-1,u=s.length,c=Array(i+u);while(++n<u){c[n]=s[n]}while(i--){c[n++]=arguments[++e]}var f=this&&this!==r&&this instanceof h?l:t;return f.apply(a?o:this,c)}return h}e.exports=o}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./createCtorWrapper":32}],35:[function(t,e,r){var i=t("./baseSetData"),n=t("./createBindWrapper"),o=t("./createHybridWrapper"),s=t("./createPartialWrapper"),a=t("./getData"),l=t("./mergeData"),h=t("./setData");var u=1,c=2,f=32,d=64;var p="Expected a function";var v=Math.max;function g(t,e,r,g,m,y,x,_){var b=e&c;if(!b&&typeof t!="function"){throw new TypeError(p)}var T=g?g.length:0;if(!T){e&=~(f|d);g=m=null}T-=m?m.length:0;if(e&d){var w=g,E=m;g=m=null}var S=b?null:a(t),C=[t,e,r,g,m,w,E,y,x,_];if(S){l(C,S);e=C[1];_=C[9]}C[9]=_==null?b?0:t.length:v(_-T,0)||0;if(e==u){var A=n(C[0],C[2])}else if((e==f||e==(u|f))&&!C[4].length){A=s.apply(undefined,C)}else{A=o.apply(undefined,C)}var R=S?i:h;return R(A,C)}e.exports=g},{"./baseSetData":27,"./createBindWrapper":31,"./createHybridWrapper":33,"./createPartialWrapper":34,"./getData":36,"./mergeData":42,"./setData":47}],36:[function(t,e,r){var i=t("./metaMap"),n=t("../utility/noop");var o=!i?n:function(t){return i.get(t)};e.exports=o},{"../utility/noop":60,"./metaMap":43}],37:[function(t,e,r){var i=t("./baseProperty"),n=t("../utility/constant"),o=t("./realNames"),s=t("../support");var a=function(){if(!s.funcNames){return n("")}if(n.name=="constant"){return i("name")}return function(t){var e=t.name,r=o[e],i=r?r.length:0;while(i--){var n=r[i],s=n.func;if(s==null||s==t){return n.name}}return e}}();e.exports=a},{"../support":57,"../utility/constant":58,"./baseProperty":26,"./realNames":44}],38:[function(t,e,r){var i=Math.pow(2,53)-1;function n(t,e){t=+t;e=e==null?i:e;return t>-1&&t%1==0&&t<e}e.exports=n},{}],39:[function(t,e,r){var i=t("./LazyWrapper"),n=t("./getFuncName"),o=t("../chain/lodash");function s(t){var e=n(t);return!!e&&t===o[e]&&e in i.prototype}e.exports=s},{"../chain/lodash":14,"./LazyWrapper":18,"./getFuncName":37}],40:[function(t,e,r){var i=Math.pow(2,53)-1;function n(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=i}e.exports=n},{}],41:[function(t,e,r){function i(t){return!!t&&typeof t=="object"}e.exports=i},{}],42:[function(t,e,r){var i=t("./arrayCopy"),n=t("./composeArgs"),o=t("./composeArgsRight"),s=t("./replaceHolders");var a=1,l=4,h=8,u=128,c=256;var f="__lodash_placeholder__";var d=Math.min;function p(t,e){var r=t[1],p=e[1],v=r|p,g=v<u;var m=p==u&&r==h||p==u&&r==c&&t[7].length<=e[8]||p==(u|c)&&r==h;if(!(g||m)){return t}if(p&a){t[2]=e[2];v|=r&a?0:l}var y=e[3];if(y){var x=t[3];t[3]=x?n(x,y,e[4]):i(y);t[4]=x?s(t[3],f):i(e[4])}y=e[5];if(y){x=t[5];t[5]=x?o(x,y,e[6]):i(y);t[6]=x?s(t[5],f):i(e[6])}y=e[7];if(y){t[7]=i(y)}if(p&u){t[8]=t[8]==null?e[8]:d(t[8],e[8])}if(t[9]==null){t[9]=e[9]}t[0]=e[0];t[1]=v;return t}e.exports=p},{"./arrayCopy":20,"./composeArgs":29,"./composeArgsRight":30,"./replaceHolders":46}],43:[function(t,e,r){(function(r){var i=t("../lang/isNative");var n=i(n=r.WeakMap)&&n;var o=n&&new n;e.exports=o}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../lang/isNative":52}],44:[function(t,e,r){var i={};e.exports=i},{}],45:[function(t,e,r){var i=t("./arrayCopy"),n=t("./isIndex");var o=Math.min;function s(t,e){var r=t.length,s=o(e.length,r),a=i(t);while(s--){var l=e[s];t[s]=n(l,r)?a[l]:undefined}return t}e.exports=s},{"./arrayCopy":20,"./isIndex":38}],46:[function(t,e,r){var i="__lodash_placeholder__";function n(t,e){var r=-1,n=t.length,o=-1,s=[];while(++r<n){if(t[r]===e){t[r]=i;s[++o]=r}}return s}e.exports=n},{}],47:[function(t,e,r){var i=t("./baseSetData"),n=t("../date/now");var o=150,s=16;var a=function(){var t=0,e=0;return function(r,a){var l=n(),h=s-(l-e);e=l;if(h>0){if(++t>=o){return r}}else{t=0}return i(r,a)}}();e.exports=a},{"../date/now":15,"./baseSetData":27}],48:[function(t,e,r){var i=t("./LazyWrapper"),n=t("./LodashWrapper"),o=t("./arrayCopy");function s(t){return t instanceof i?t.clone():new n(t.__wrapped__,t.__chain__,o(t.__actions__))}e.exports=s},{"./LazyWrapper":18,"./LodashWrapper":19,"./arrayCopy":20}],49:[function(t,e,r){var i=t("../internal/isLength"),n=t("../internal/isObjectLike");var o="[object Arguments]";var s=Object.prototype;var a=s.toString;function l(t){var e=n(t)?t.length:undefined;return i(e)&&a.call(t)==o}e.exports=l},{"../internal/isLength":40,"../internal/isObjectLike":41}],50:[function(t,e,r){var i=t("../internal/isLength"),n=t("./isNative"),o=t("../internal/isObjectLike");var s="[object Array]";var a=Object.prototype;var l=a.toString;var h=n(h=Array.isArray)&&h;var u=h||function(t){return o(t)&&i(t.length)&&l.call(t)==s};e.exports=u},{"../internal/isLength":40,"../internal/isObjectLike":41,"./isNative":52}],51:[function(t,e,r){(function(r){var i=t("../internal/baseIsFunction"),n=t("./isNative");var o="[object Function]";var s=Object.prototype;var a=s.toString;var l=n(l=r.Uint8Array)&&l;var h=!(i(/x/)||l&&!i(l))?i:function(t){return a.call(t)==o};e.exports=h}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../internal/baseIsFunction":24,"./isNative":52}],52:[function(t,e,r){var i=t("../string/escapeRegExp"),n=t("../internal/isObjectLike");var o="[object Function]";var s=/^\[object .+?Constructor\]$/;var a=Object.prototype;var l=Function.prototype.toString;var h=a.toString;var u=RegExp("^"+i(h).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function c(t){if(t==null){return false}if(h.call(t)==o){return u.test(l.call(t))}return n(t)&&s.test(t)}e.exports=c},{"../internal/isObjectLike":41,"../string/escapeRegExp":56}],53:[function(t,e,r){function i(t){var e=typeof t;return e=="function"||!!t&&e=="object"}e.exports=i},{}],54:[function(t,e,r){var i=t("../internal/baseFunctions"),n=t("./keysIn");function o(t){return i(t,n(t))}e.exports=o},{"../internal/baseFunctions":23,"./keysIn":55}],55:[function(t,e,r){var i=t("../lang/isArguments"),n=t("../lang/isArray"),o=t("../internal/isIndex"),s=t("../internal/isLength"),a=t("../lang/isObject"),l=t("../support");var h=Object.prototype;var u=h.hasOwnProperty;function c(t){if(t==null){return[]}if(!a(t)){t=Object(t)}var e=t.length;e=e&&s(e)&&(n(t)||l.nonEnumArgs&&i(t))&&e||0;var r=t.constructor,h=-1,c=typeof r=="function"&&r.prototype===t,f=Array(e),d=e>0;while(++h<e){f[h]=h+""}for(var p in t){if(!(d&&o(p,e))&&!(p=="constructor"&&(c||!u.call(t,p)))){f.push(p)}}return f}e.exports=c},{"../internal/isIndex":38,"../internal/isLength":40,"../lang/isArguments":49,"../lang/isArray":50,"../lang/isObject":53,"../support":57}],56:[function(t,e,r){var i=t("../internal/baseToString");var n=/[.*+?^${}()|[\]\/\\]/g,o=RegExp(n.source);function s(t){t=i(t);return t&&o.test(t)?t.replace(n,"\\$&"):t}e.exports=s},{"../internal/baseToString":28}],57:[function(t,e,r){(function(t){var r=Object.prototype;var i=(i=t.window)&&i.document;var n=r.propertyIsEnumerable;var o={};(function(t){var e=function(){this.x=t},r={0:t,length:t},s=[];e.prototype={valueOf:t,y:t};for(var a in new e){s.push(a)}o.funcDecomp=/\bthis\b/.test(function(){return this});o.funcNames=typeof Function.name=="string";try{o.dom=i.createDocumentFragment().nodeType===11}catch(l){o.dom=false}try{o.nonEnumArgs=!n.call(arguments,1)}catch(l){o.nonEnumArgs=true}})(1,0);e.exports=o}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],58:[function(t,e,r){function i(t){return function(){return t}}e.exports=i},{}],59:[function(t,e,r){function i(t){return t}e.exports=i},{}],60:[function(t,e,r){function i(){}e.exports=i},{}],61:[function(t,e,r){(function(t){(function(){var r={};var i,n;i=this;if(i!=null){n=i.async}r.noConflict=function(){i.async=n;return r};function o(t){var e=false;return function(){if(e)throw new Error("Callback was already called.");e=true;t.apply(i,arguments)}}var s=Object.prototype.toString;var a=Array.isArray||function(t){return s.call(t)==="[object Array]"};var l=function(t,e){if(t.forEach){return t.forEach(e)}for(var r=0;r<t.length;r+=1){e(t[r],r,t)}};var h=function(t,e){if(t.map){return t.map(e)}var r=[];l(t,function(t,i,n){r.push(e(t,i,n))});return r};var u=function(t,e,r){if(t.reduce){return t.reduce(e,r)}l(t,function(t,i,n){r=e(r,t,i,n)});return r};var c=function(t){if(Object.keys){return Object.keys(t)}var e=[];for(var r in t){if(t.hasOwnProperty(r)){e.push(r)}}return e};if(typeof t==="undefined"||!t.nextTick){if(typeof setImmediate==="function"){r.nextTick=function(t){setImmediate(t)};r.setImmediate=r.nextTick}else{r.nextTick=function(t){setTimeout(t,0)};r.setImmediate=r.nextTick}}else{r.nextTick=t.nextTick;if(typeof setImmediate!=="undefined"){r.setImmediate=function(t){setImmediate(t)}}else{r.setImmediate=r.nextTick}}r.each=function(t,e,r){r=r||function(){};if(!t.length){return r()}var i=0;l(t,function(t){e(t,o(n))});function n(e){if(e){r(e);r=function(){}}else{i+=1;if(i>=t.length){r()}}}};r.forEach=r.each;r.eachSeries=function(t,e,r){r=r||function(){};if(!t.length){return r()}var i=0;var n=function(){e(t[i],function(e){if(e){r(e);r=function(){}}else{i+=1;if(i>=t.length){r()}else{n()}}})};n()};r.forEachSeries=r.eachSeries;r.eachLimit=function(t,e,r,i){var n=f(e);n.apply(null,[t,r,i])};r.forEachLimit=r.eachLimit;var f=function(t){return function(e,r,i){i=i||function(){};if(!e.length||t<=0){return i()}var n=0;var o=0;var s=0;(function a(){if(n>=e.length){return i()}while(s<t&&o<e.length){o+=1;s+=1;r(e[o-1],function(t){if(t){i(t);i=function(){}}else{n+=1;s-=1;if(n>=e.length){i()}else{a()}}})}})()}};var d=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[r.each].concat(e))}};var p=function(t,e){return function(){var r=Array.prototype.slice.call(arguments);return e.apply(null,[f(t)].concat(r))}};var v=function(t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[r.eachSeries].concat(e))}};var g=function(t,e,r,i){e=h(e,function(t,e){return{index:e,value:t}});if(!i){t(e,function(t,e){r(t.value,function(t){e(t)})})}else{var n=[];t(e,function(t,e){r(t.value,function(r,i){n[t.index]=i;e(r)})},function(t){i(t,n)})}};r.map=d(g);r.mapSeries=v(g);r.mapLimit=function(t,e,r,i){return m(e)(t,r,i)};var m=function(t){return p(t,g)};r.reduce=function(t,e,i,n){r.eachSeries(t,function(t,r){i(e,t,function(t,i){e=i;r(t)})},function(t){n(t,e)})};r.inject=r.reduce;r.foldl=r.reduce;r.reduceRight=function(t,e,i,n){var o=h(t,function(t){return t}).reverse();r.reduce(o,e,i,n)};r.foldr=r.reduceRight;var y=function(t,e,r,i){var n=[];e=h(e,function(t,e){return{index:e,value:t}});t(e,function(t,e){r(t.value,function(r){if(r){n.push(t)}e()})},function(t){i(h(n.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};r.filter=d(y);r.filterSeries=v(y);r.select=r.filter;r.selectSeries=r.filterSeries;var x=function(t,e,r,i){var n=[];e=h(e,function(t,e){return{index:e,value:t}});t(e,function(t,e){r(t.value,function(r){if(!r){n.push(t)}e()})},function(t){i(h(n.sort(function(t,e){return t.index-e.index}),function(t){return t.value}))})};r.reject=d(x);r.rejectSeries=v(x);var _=function(t,e,r,i){t(e,function(t,e){r(t,function(r){if(r){i(t);i=function(){}}else{e()}})},function(t){i()})};r.detect=d(_);r.detectSeries=v(_);r.some=function(t,e,i){r.each(t,function(t,r){e(t,function(t){if(t){i(true);i=function(){}}r()})},function(t){i(false)})};r.any=r.some;r.every=function(t,e,i){r.each(t,function(t,r){e(t,function(t){if(!t){i(false);i=function(){}}r()})},function(t){i(true)})};r.all=r.every;r.sortBy=function(t,e,i){r.map(t,function(t,r){e(t,function(e,i){if(e){r(e)}else{r(null,{value:t,criteria:i})}})},function(t,e){if(t){return i(t)}else{var r=function(t,e){var r=t.criteria,i=e.criteria;return r<i?-1:r>i?1:0};i(null,h(e.sort(r),function(t){return t.value}))}})};r.auto=function(t,e){e=e||function(){};var i=c(t);var n=i.length;if(!n){return e()}var o={};var s=[];var h=function(t){s.unshift(t)};var f=function(t){for(var e=0;e<s.length;e+=1){if(s[e]===t){s.splice(e,1);return}}};var d=function(){n--;l(s.slice(0),function(t){t()})};h(function(){if(!n){var t=e;e=function(){};t(null,o)}});l(i,function(i){var n=a(t[i])?t[i]:[t[i]];var s=function(t){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1){n=n[0]}if(t){var s={};l(c(o),function(t){s[t]=o[t]});s[i]=n;e(t,s);e=function(){}}else{o[i]=n;r.setImmediate(d)}};var p=n.slice(0,Math.abs(n.length-1))||[];var v=function(){return u(p,function(t,e){return t&&o.hasOwnProperty(e)},true)&&!o.hasOwnProperty(i)};if(v()){n[n.length-1](s,o)}else{var g=function(){if(v()){f(g);n[n.length-1](s,o)}};h(g)}})};r.retry=function(t,e,i){var n=5;var o=[];if(typeof t==="function"){i=e;e=t;t=n}t=parseInt(t,10)||n;var s=function(n,s){var a=function(t,e){return function(r){t(function(t,i){r(!t||e,{err:t,result:i})},s)}};while(t){o.push(a(e,!(t-=1)))}r.series(o,function(t,e){e=e[e.length-1];(n||i)(e.err,e.result)})};return i?s():s};r.waterfall=function(t,e){e=e||function(){};if(!a(t)){var i=new Error("First argument to waterfall must be an array of functions");return e(i)}if(!t.length){return e()}var n=function(t){return function(i){if(i){e.apply(null,arguments);e=function(){}}else{var o=Array.prototype.slice.call(arguments,1);var s=t.next();if(s){o.push(n(s))}else{o.push(e)}r.setImmediate(function(){t.apply(null,o)})}}};n(r.iterator(t))()};var b=function(t,e,r){r=r||function(){};if(a(e)){t.map(e,function(t,e){if(t){t(function(t){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1){r=r[0]}e.call(null,t,r)})}},r)}else{var i={};t.each(c(e),function(t,r){e[t](function(e){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1){n=n[0]}i[t]=n;r(e)})},function(t){r(t,i)})}};r.parallel=function(t,e){b({map:r.map,each:r.each},t,e)};r.parallelLimit=function(t,e,r){b({map:m(e),each:f(e)},t,r)};r.series=function(t,e){e=e||function(){};if(a(t)){r.mapSeries(t,function(t,e){if(t){t(function(t){var r=Array.prototype.slice.call(arguments,1);if(r.length<=1){r=r[0]}e.call(null,t,r)})}},e)}else{var i={};r.eachSeries(c(t),function(e,r){t[e](function(t){var n=Array.prototype.slice.call(arguments,1);if(n.length<=1){n=n[0]}i[e]=n;r(t)})},function(t){e(t,i)})}};r.iterator=function(t){var e=function(r){var i=function(){if(t.length){t[r].apply(null,arguments)}return i.next()};i.next=function(){return r<t.length-1?e(r+1):null};return i};return e(0)};r.apply=function(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e.concat(Array.prototype.slice.call(arguments)))}};var T=function(t,e,r,i){var n=[];t(e,function(t,e){r(t,function(t,r){n=n.concat(r||[]);e(t)})},function(t){i(t,n)})};r.concat=d(T);r.concatSeries=v(T);r.whilst=function(t,e,i){if(t()){e(function(n){if(n){return i(n)}r.whilst(t,e,i)})}else{i()}};r.doWhilst=function(t,e,i){t(function(n){if(n){return i(n)}var o=Array.prototype.slice.call(arguments,1);if(e.apply(null,o)){r.doWhilst(t,e,i)}else{i()}})};r.until=function(t,e,i){if(!t()){e(function(n){if(n){return i(n)}r.until(t,e,i)})}else{i()}};r.doUntil=function(t,e,i){t(function(n){if(n){return i(n)}var o=Array.prototype.slice.call(arguments,1);if(!e.apply(null,o)){r.doUntil(t,e,i)}else{i()}})};r.queue=function(t,e){if(e===undefined){e=1}function i(t,e,i,n){if(!t.started){t.started=true}if(!a(e)){e=[e]}if(e.length==0){return r.setImmediate(function(){if(t.drain){t.drain()}})}l(e,function(e){var o={data:e,callback:typeof n==="function"?n:null};if(i){t.tasks.unshift(o)}else{t.tasks.push(o)}if(t.saturated&&t.tasks.length===t.concurrency){t.saturated()}r.setImmediate(t.process)})}var n=0;var s={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,started:false,paused:false,push:function(t,e){i(s,t,false,e)},kill:function(){s.drain=null;s.tasks=[]},unshift:function(t,e){i(s,t,true,e)},process:function(){if(!s.paused&&n<s.concurrency&&s.tasks.length){var e=s.tasks.shift();if(s.empty&&s.tasks.length===0){s.empty()}n+=1;var r=function(){n-=1;if(e.callback){e.callback.apply(e,arguments)}if(s.drain&&s.tasks.length+n===0){s.drain()}s.process()};var i=o(r);t(e.data,i)}},length:function(){return s.tasks.length},running:function(){return n},idle:function(){return s.tasks.length+n===0},pause:function(){if(s.paused===true){return}s.paused=true;s.process()},resume:function(){if(s.paused===false){return}s.paused=false;s.process()}};return s};r.priorityQueue=function(t,e){function i(t,e){return t.priority-e.priority}function n(t,e,r){var i=-1,n=t.length-1;while(i<n){var o=i+(n-i+1>>>1);if(r(e,t[o])>=0){i=o}else{n=o-1}}return i}function o(t,e,o,s){if(!t.started){t.started=true}if(!a(e)){e=[e]}if(e.length==0){return r.setImmediate(function(){if(t.drain){t.drain()}})}l(e,function(e){var a={data:e,priority:o,callback:typeof s==="function"?s:null};t.tasks.splice(n(t.tasks,a,i)+1,0,a);if(t.saturated&&t.tasks.length===t.concurrency){t.saturated()}r.setImmediate(t.process)})}var s=r.queue(t,e);s.push=function(t,e,r){o(s,t,e,r)};delete s.unshift;return s};r.cargo=function(t,e){var i=false,n=[];var o={tasks:n,payload:e,saturated:null,empty:null,drain:null,drained:true,push:function(t,i){if(!a(t)){t=[t]}l(t,function(t){n.push({data:t,callback:typeof i==="function"?i:null});o.drained=false;if(o.saturated&&n.length===e){o.saturated()}});r.setImmediate(o.process)},process:function s(){if(i)return;if(n.length===0){if(o.drain&&!o.drained)o.drain();o.drained=true;return}var r=typeof e==="number"?n.splice(0,e):n.splice(0,n.length);var a=h(r,function(t){return t.data});if(o.empty)o.empty();i=true;t(a,function(){i=false;var t=arguments;l(r,function(e){if(e.callback){e.callback.apply(null,t)}});s()})},length:function(){return n.length},running:function(){return i}};return o};var w=function(t){return function(e){var r=Array.prototype.slice.call(arguments,1);e.apply(null,r.concat([function(e){var r=Array.prototype.slice.call(arguments,1);if(typeof console!=="undefined"){if(e){if(console.error){console.error(e)}}else if(console[t]){l(r,function(e){console[t](e)})}}}]))}};r.log=w("log");r.dir=w("dir");r.memoize=function(t,e){var i={};var n={};e=e||function(t){return t};var o=function(){var o=Array.prototype.slice.call(arguments);var s=o.pop();var a=e.apply(null,o);if(a in i){r.nextTick(function(){s.apply(null,i[a])})}else if(a in n){n[a].push(s)}else{n[a]=[s];t.apply(null,o.concat([function(){i[a]=arguments;var t=n[a];delete n[a];for(var e=0,r=t.length;e<r;e++){t[e].apply(null,arguments)}}]))}};o.memo=i;o.unmemoized=t;return o};r.unmemoize=function(t){return function(){return(t.unmemoized||t).apply(null,arguments)}};r.times=function(t,e,i){var n=[];for(var o=0;o<t;o++){n.push(o)}return r.map(n,e,i)};r.timesSeries=function(t,e,i){var n=[];for(var o=0;o<t;o++){n.push(o)}return r.mapSeries(n,e,i)};r.seq=function(){var t=arguments;return function(){var e=this;var i=Array.prototype.slice.call(arguments);var n=i.pop();r.reduce(t,i,function(t,r,i){r.apply(e,t.concat([function(){var t=arguments[0];var e=Array.prototype.slice.call(arguments,1);i(t,e)}]))},function(t,r){n.apply(e,[t].concat(r))})}};r.compose=function(){return r.seq.apply(null,Array.prototype.reverse.call(arguments))};var E=function(t,e){var r=function(){var r=this;var i=Array.prototype.slice.call(arguments);var n=i.pop();return t(e,function(t,e){t.apply(r,i.concat([e]))},n)};if(arguments.length>2){var i=Array.prototype.slice.call(arguments,2);return r.apply(this,i)}else{return r}};r.applyEach=d(E);r.applyEachSeries=v(E);r.forever=function(t,e){function r(i){if(i){if(e){return e(i)}throw i}t(r)}r()};if(typeof e!=="undefined"&&e.exports){e.exports=r}else if(typeof define!=="undefined"&&define.amd){define([],function(){return r})}else{i.async=r}})()}).call(this,t("_process"))},{_process:9}],62:[function(t,e,r){"use strict";function i(t,e,r){this.fn=t;this.context=e;this.once=r||false}function n(){}n.prototype._events=undefined;n.prototype.listeners=function o(t,e){var r="~"+t,i=this._events&&this._events[r];if(e)return!!i;if(!i)return[];if(this._events[r].fn)return[this._events[r].fn];for(var n=0,o=this._events[r].length,s=new Array(o);n<o;n++){s[n]=this._events[r][n].fn}return s};n.prototype.emit=function s(t,e,r,i,n,o){var s="~"+t;if(!this._events||!this._events[s])return false;var a=this._events[s],l=arguments.length,h,u;if("function"===typeof a.fn){if(a.once)this.removeListener(t,a.fn,undefined,true);switch(l){case 1:return a.fn.call(a.context),true;case 2:return a.fn.call(a.context,e),true;case 3:return a.fn.call(a.context,e,r),true;case 4:return a.fn.call(a.context,e,r,i),true;case 5:return a.fn.call(a.context,e,r,i,n),true;case 6:return a.fn.call(a.context,e,r,i,n,o),true}for(u=1,h=new Array(l-1);u<l;u++){h[u-1]=arguments[u]}a.fn.apply(a.context,h)}else{var c=a.length,f;for(u=0;u<c;u++){if(a[u].once)this.removeListener(t,a[u].fn,undefined,true);switch(l){case 1:a[u].fn.call(a[u].context);break;case 2:a[u].fn.call(a[u].context,e);break;case 3:a[u].fn.call(a[u].context,e,r);break;default:if(!h)for(f=1,h=new Array(l-1);f<l;f++){h[f-1]=arguments[f]}a[u].fn.apply(a[u].context,h)}}}return true};n.prototype.on=function a(t,e,r){var n=new i(e,r||this),o="~"+t;if(!this._events)this._events={};if(!this._events[o])this._events[o]=n;else{if(!this._events[o].fn)this._events[o].push(n);else this._events[o]=[this._events[o],n]}return this};n.prototype.once=function l(t,e,r){var n=new i(e,r||this,true),o="~"+t;if(!this._events)this._events={};if(!this._events[o])this._events[o]=n;else{if(!this._events[o].fn)this._events[o].push(n);else this._events[o]=[this._events[o],n]}return this};n.prototype.removeListener=function h(t,e,r,i){var n="~"+t;if(!this._events||!this._events[n])return this;var o=this._events[n],s=[];if(e){if(o.fn){if(o.fn!==e||i&&!o.once||r&&o.context!==r){s.push(o)}}else{for(var a=0,l=o.length;a<l;a++){if(o[a].fn!==e||i&&!o[a].once||r&&o[a].context!==r){s.push(o[a])}}}}if(s.length){this._events[n]=s.length===1?s[0]:s}else{delete this._events[n]}return this};n.prototype.removeAllListeners=function u(t){if(!this._events)return this;if(t)delete this._events["~"+t];else this._events={};return this};n.prototype.off=n.prototype.removeListener;n.prototype.addListener=n.prototype.on;n.prototype.setMaxListeners=function c(){return this};e.exports=n},{}],63:[function(t,e,r){var i=t("async"),n=t("./Resource"),o=t("eventemitter3");function s(t,e){o.call(this);e=e||10;this.baseUrl=t||"";this.progress=0;this.loading=false;this._progressChunk=0;this._beforeMiddleware=[];this._afterMiddleware=[];this._boundLoadResource=this._loadResource.bind(this);this._boundOnLoad=this._onLoad.bind(this);this._buffer=[];this._numToLoad=0;this._queue=i.queue(this._boundLoadResource,e);this.resources={}}s.prototype=Object.create(o.prototype);s.prototype.constructor=s;e.exports=s;s.prototype.add=s.prototype.enqueue=function(t,e,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;++o){this.add(t[o])}return this}if(typeof t==="object"){i=e||t.callback||t.onComplete;r=t;e=t.url;t=t.name||t.key||t.url}if(typeof e!=="string"){i=r;r=e;e=t}if(typeof e!=="string"){throw new Error("No url passed to add resource to loader.")}if(typeof r==="function"){i=r;r=null}if(this.resources[t]){throw new Error('Resource with name "'+t+'" already exists.')}if(e.indexOf("data:")!==0){e=this.baseUrl+e}this.resources[t]=new n(t,e,r);if(typeof i==="function"){this.resources[t].once("afterMiddleware",i)}this._numToLoad++;if(this._queue.started){this._queue.push(this.resources[t]);this._progressChunk=(100-this.progress)/(this._queue.length()+this._queue.running())}else{this._buffer.push(this.resources[t]);this._progressChunk=100/this._buffer.length}return this};s.prototype.before=s.prototype.pre=function(t){this._beforeMiddleware.push(t);return this};s.prototype.after=s.prototype.use=function(t){this._afterMiddleware.push(t);return this};s.prototype.reset=function(){this._buffer.length=0;this._queue.kill();this._queue.started=false;this.progress=0;this._progressChunk=0;this.loading=false};s.prototype.load=function(t){if(typeof t==="function"){this.once("complete",t)}if(this._queue.started){return this}this.emit("start",this);for(var e=0;e<this._buffer.length;++e){this._queue.push(this._buffer[e])}this._buffer.length=0;return this};s.prototype._loadResource=function(t,e){var r=this;t._dequeue=e;this._runMiddleware(t,this._beforeMiddleware,function(){t.load(r._boundOnLoad)})};s.prototype._onComplete=function(){this.emit("complete",this,this.resources)};s.prototype._onLoad=function(t){this.progress+=this._progressChunk;this.emit("progress",this,t);if(t.error){this.emit("error",t.error,this,t)}else{this.emit("load",this,t)}this._runMiddleware(t,this._afterMiddleware,function(){t.emit("afterMiddleware",t);this._numToLoad--;if(this._numToLoad===0){this._onComplete()}});t._dequeue()};s.prototype._runMiddleware=function(t,e,r){var n=this;i.eachSeries(e,function(e,r){e.call(n,t,r)},r.bind(this,t))};s.LOAD_TYPE=n.LOAD_TYPE;s.XHR_READY_STATE=n.XHR_READY_STATE;s.XHR_RESPONSE_TYPE=n.XHR_RESPONSE_TYPE},{"./Resource":64,async:61,eventemitter3:62}],64:[function(t,e,r){var i=t("eventemitter3"),n=!!(window.XDomainRequest&&!("withCredentials"in new XMLHttpRequest));function o(t,e,r){i.call(this);r=r||{};if(typeof t!=="string"||typeof e!=="string"){throw new Error("Both name and url are required for constructing a resource.")}this.name=t;this.url=e;this.data=null;this.crossOrigin=r.crossOrigin;this.loadType=r.loadType||this._determineLoadType();this.xhrType=r.xhrType;this.error=null;this.xhr=null;this.isJson=false;this.isXml=false;this.isImage=false;this.isAudio=false;this.isVideo=false;this._dequeue=null;this._boundComplete=this.complete.bind(this);this._boundOnError=this._onError.bind(this);this._boundOnProgress=this._onProgress.bind(this);this._boundXhrOnError=this._xhrOnError.bind(this);this._boundXhrOnAbort=this._xhrOnAbort.bind(this);this._boundXhrOnLoad=this._xhrOnLoad.bind(this);this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}o.prototype=Object.create(i.prototype);o.prototype.constructor=o;e.exports=o;o.prototype.complete=function(){if(this.data&&this.data.removeEventListener){this.data.removeEventListener("error",this._boundOnError);this.data.removeEventListener("load",this._boundComplete);this.data.removeEventListener("progress",this._boundOnProgress);this.data.removeEventListener("canplaythrough",this._boundComplete);

}if(this.xhr){if(this.xhr.removeEventListener){this.xhr.removeEventListener("error",this._boundXhrOnError);this.xhr.removeEventListener("abort",this._boundXhrOnAbort);this.xhr.removeEventListener("progress",this._boundOnProgress);this.xhr.removeEventListener("load",this._boundXhrOnLoad)}else{this.xhr.onerror=null;this.xhr.ontimeout=null;this.xhr.onprogress=null;this.xhr.onload=null}}this.emit("complete",this)};o.prototype.load=function(t){this.emit("start",this);if(t){this.once("complete",t)}if(typeof this.crossOrigin!=="string"){this.crossOrigin=this._determineCrossOrigin()}switch(this.loadType){case o.LOAD_TYPE.IMAGE:this._loadImage();break;case o.LOAD_TYPE.AUDIO:this._loadElement("audio");break;case o.LOAD_TYPE.VIDEO:this._loadElement("video");break;case o.LOAD_TYPE.XHR:default:if(n){this._loadXdr()}else{this._loadXhr()}break}};o.prototype._loadImage=function(){this.data=new Image;if(this.crossOrigin){this.data.crossOrigin=""}this.data.src=this.url;this.isImage=true;this.data.addEventListener("error",this._boundOnError,false);this.data.addEventListener("load",this._boundComplete,false);this.data.addEventListener("progress",this._boundOnProgress,false)};o.prototype._loadElement=function(t){this.data=document.createElement(t);if(Array.isArray(this.url)){for(var e=0;e<this.url.length;++e){this.data.appendChild(this._createSource(t,this.url[e]))}}else{this.data.appendChild(this._createSource(t,this.url))}this["is"+t[0].toUpperCase()+t.substring(1)]=true;this.data.addEventListener("error",this._boundOnError,false);this.data.addEventListener("load",this._boundComplete,false);this.data.addEventListener("progress",this._boundOnProgress,false);this.data.addEventListener("canplaythrough",this._boundComplete,false);this.data.load()};o.prototype._loadXhr=function(){if(typeof this.xhrType!=="string"){this.xhrType=this._determineXhrType()}var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,true);if(this.xhrType===o.XHR_RESPONSE_TYPE.JSON||this.xhrType===o.XHR_RESPONSE_TYPE.DOCUMENT){t.responseType=o.XHR_RESPONSE_TYPE.TEXT}else{t.responseType=this.xhrType}t.addEventListener("error",this._boundXhrOnError,false);t.addEventListener("abort",this._boundXhrOnAbort,false);t.addEventListener("progress",this._boundOnProgress,false);t.addEventListener("load",this._boundXhrOnLoad,false);t.send()};o.prototype._loadXdr=function(){if(typeof this.xhrType!=="string"){this.xhrType=this._determineXhrType()}var t=this.xhr=new XDomainRequest;t.timeout=5e3;t.onerror=this._boundXhrOnError;t.ontimeout=this._boundXdrOnTimeout;t.onprogress=this._boundOnProgress;t.onload=this._boundXhrOnLoad;t.open("GET",this.url,true);setTimeout(function(){t.send()},0)};o.prototype._createSource=function(t,e,r){if(!r){r=t+"/"+e.substr(e.lastIndexOf(".")+1)}var i=document.createElement("source");i.src=e;i.type=r;return i};o.prototype._onError=function(t){this.error=new Error("Failed to load element using "+t.target.nodeName);this.complete()};o.prototype._onProgress=function(t){if(t.lengthComputable){this.emit("progress",this,t.loaded/t.total)}};o.prototype._xhrOnError=function(){this.error=new Error(s(this.xhr)+" Request failed. "+"Status: "+this.xhr.status+', text: "'+this.xhr.statusText+'"');this.complete()};o.prototype._xhrOnAbort=function(){this.error=new Error(s(this.xhr)+" Request was aborted by the user.");this.complete()};o.prototype._xdrOnTimeout=function(){this.error=new Error(s(this.xhr)+" Request timed out.");this.complete()};o.prototype._xhrOnLoad=function(){var t=this.xhr;if(t.status===200){if(this.xhrType===o.XHR_RESPONSE_TYPE.TEXT){this.data=t.responseText}else if(this.xhrType===o.XHR_RESPONSE_TYPE.JSON){try{this.data=JSON.parse(t.responseText);this.isJson=true}catch(e){this.error=new Error("Error trying to parse loaded json:",e)}}else if(this.xhrType===o.XHR_RESPONSE_TYPE.DOCUMENT){try{if(window.DOMParser){var r=new DOMParser;this.data=r.parseFromString(t.responseText,"text/xml")}else{var i=document.createElement("div");i.innerHTML=t.responseText;this.data=i}this.isXml=true}catch(e){this.error=new Error("Error trying to parse loaded xml:",e)}}else{this.data=t.response||t.responseText}}else{this.error=new Error("["+t.status+"]"+t.statusText+":"+t.responseURL)}this.complete()};function s(t){return t.toString().replace("object ","")}o.prototype._determineCrossOrigin=function(){if(this.url.indexOf("data:")===0){return""}var t=window.location,e=document.createElement("a");e.href=this.url;if(e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol){return"anonymous"}return""};o.prototype._determineXhrType=function(){var t=this.url.substr(this.url.lastIndexOf(".")+1);switch(t){case"xhtml":case"html":case"htm":case"xml":case"tmx":case"tsx":case"svg":return o.XHR_RESPONSE_TYPE.DOCUMENT;case"gif":case"png":case"bmp":case"jpg":case"jpeg":case"tif":case"tiff":case"webp":return o.XHR_RESPONSE_TYPE.BLOB;case"json":return o.XHR_RESPONSE_TYPE.JSON;case"text":case"txt":default:return o.XHR_RESPONSE_TYPE.TEXT}};o.prototype._determineLoadType=function(){var t=this.url.substr(this.url.lastIndexOf(".")+1);switch(t){case"gif":case"png":case"bmp":case"jpg":case"jpeg":case"tif":case"tiff":case"webp":return o.LOAD_TYPE.IMAGE;default:return o.LOAD_TYPE.XHR}};o.prototype._getMimeFromXhrType=function(t){switch(t){case o.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case o.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case o.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case o.XHR_RESPONSE_TYPE.JSON:return"application/json";case o.XHR_RESPONSE_TYPE.DEFAULT:case o.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}};o.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4};o.XHR_READY_STATE={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4};o.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"}},{eventemitter3:62}],65:[function(t,e,r){e.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(t){var e="";var r;var i=new Array(4);var n=0;var o=0;var s=0;while(n<t.length){r=new Array(3);for(o=0;o<r.length;o++){if(n<t.length){r[o]=t.charCodeAt(n++)&255}else{r[o]=0}}i[0]=r[0]>>2;i[1]=(r[0]&3)<<4|r[1]>>4;i[2]=(r[1]&15)<<2|r[2]>>6;i[3]=r[2]&63;s=n-(t.length-1);switch(s){case 2:i[3]=64;i[2]=64;break;case 1:i[3]=64;break;default:break}for(o=0;o<i.length;o++){e+=this._keyStr.charAt(i[o])}}return e}}},{}],66:[function(t,e,r){e.exports=t("./Loader");e.exports.Resource=t("./Resource");e.exports.middleware={caching:{memory:t("./middlewares/caching/memory")},parsing:{blob:t("./middlewares/parsing/blob")}}},{"./Loader":63,"./Resource":64,"./middlewares/caching/memory":67,"./middlewares/parsing/blob":68}],67:[function(t,e,r){var i={};e.exports=function(){return function(t,e){if(i[t.url]){t.data=i[t.url];t.complete()}else{t.once("complete",function(){i[this.url]=this.data});e()}}}},{}],68:[function(t,e,r){var i=t("../../Resource"),n=t("../../b64");window.URL=window.URL||window.webkitURL;e.exports=function(){return function(t,e){if(!t.data){return e()}if(t.xhr&&t.xhrType===i.XHR_RESPONSE_TYPE.BLOB){if(!window.Blob||typeof t.data==="string"){var r=t.xhr.getResponseHeader("content-type");if(r&&r.indexOf("image")===0){t.data=new Image;t.data.src="data:"+r+";base64,"+n.encodeBinary(t.xhr.responseText);t.isImage=true;t.data.onload=function(){t.data.onload=null;e()}}}else if(t.data.type.indexOf("image")===0){var o=URL.createObjectURL(t.data);t.blob=t.data;t.data=new Image;t.data.src=o;t.isImage=true;t.data.onload=function(){URL.revokeObjectURL(o);t.data.onload=null;e()}}}else{e()}}}},{"../../Resource":64,"../../b64":65}],69:[function(t,e,r){e.exports={name:"pixi.js",version:"3.0.0",description:"Pixi.js is a fast lightweight 2D library that works across all devices.",author:{name:"Mat Groves"},contributors:[{name:"Chad Engler",email:"chad@pantherdev.com"},{name:"Richard Davey",email:"rdavey@gmail.com"}],main:"./src/index.js",homepage:"http://goodboydigital.com/",bugs:{url:"https://github.com/GoodBoyDigital/pixi.js/issues"},license:"MIT",repository:{type:"git",url:"https://github.com/GoodBoyDigital/pixi.js.git"},scripts:{test:"gulp test",docs:"jsdoc -c ./gulp/util/jsdoc.conf.json"},devDependencies:{brfs:"^1.2.0",browserify:"^8.0.2",chai:"^1.10.0",del:"^1.1.0",gulp:"^3.8.10","gulp-cached":"^1.0.1","gulp-concat":"^2.5.2","gulp-debug":"^2.0.0","gulp-jsdoc":"^0.1.4","gulp-jshint":"^1.9.0","gulp-plumber":"^0.6.6","gulp-rename":"^1.2.0","gulp-uglify":"^1.0.2","gulp-util":"^3.0.1","ink-docstrap":"^0.5.2",jsdoc:"^3.3.0-alpha13","jshint-summary":"^0.4.0",karma:"^0.12.28","karma-firefox-launcher":"^0.1.0","karma-mocha":"^0.1.10","karma-spec-reporter":"^0.0.16",minimist:"^1.1.0",mocha:"^2.1.0","require-dir":"^0.1.0","run-sequence":"^1.0.2","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.0.0",watchify:"^2.2.1"},dependencies:{async:"^0.9.0","resource-loader":"^1.2.0"},browserify:{transform:["brfs"]},gitHead:"c3143bfe28c52db4d0d956e5528e41a7a48a3eeb",_id:"pixi.js@3.0.0",_shasum:"7ef605b59ba53889345e3313baee575dc281b3d5",_from:"pixi.js@>=3.0.0 <4.0.0",_npmVersion:"1.4.23",_npmUser:{name:"englercj",email:"englercj@live.com"},maintainers:[{name:"englercj",email:"englercj@live.com"}],dist:{shasum:"7ef605b59ba53889345e3313baee575dc281b3d5",tarball:"http://registry.npmjs.org/pixi.js/-/pixi.js-3.0.0.tgz"},directories:{},_resolved:"https://registry.npmjs.org/pixi.js/-/pixi.js-3.0.0.tgz",readme:"ERROR: No README data found!"}},{}],70:[function(t,e,r){e.exports={VERSION:t("../../package.json").version,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:false,forceFXAA:false,autoResize:false,transparent:false,backgroundColor:0,clearBeforeRender:true,preserveDrawingBuffer:false},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},SPRITE_BATCH_SIZE:2e3}},{"../../package.json":69}],71:[function(t,e,r){var i=t("../math"),n=t("./DisplayObject"),o=t("../textures/RenderTexture"),s=new i.Matrix;function a(){n.call(this);this.children=[]}a.prototype=Object.create(n.prototype);a.prototype.constructor=a;e.exports=a;Object.defineProperties(a.prototype,{width:{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;if(e!==0){this.scale.x=t/e}else{this.scale.x=1}this._width=t}},height:{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;if(e!==0){this.scale.y=t/e}else{this.scale.y=1}this._height=t}}});a.prototype.addChild=function(t){return this.addChildAt(t,this.children.length)};a.prototype.addChildAt=function(t,e){if(t===this){return t}if(e>=0&&e<=this.children.length){if(t.parent){t.parent.removeChild(t)}t.parent=this;this.children.splice(e,0,t);return t}else{throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)}};a.prototype.swapChildren=function(t,e){if(t===e){return}var r=this.getChildIndex(t);var i=this.getChildIndex(e);if(r<0||i<0){throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.")}this.children[r]=e;this.children[i]=t};a.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(e===-1){throw new Error("The supplied DisplayObject must be a child of the caller")}return e};a.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length){throw new Error("The supplied index is out of bounds")}var r=this.getChildIndex(t);this.children.splice(r,1);this.children.splice(e,0,t)};a.prototype.getChildAt=function(t){if(t<0||t>=this.children.length){throw new Error("getChildAt: Supplied index "+t+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller")}return this.children[t]};a.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(e===-1){return}return this.removeChildAt(e)};a.prototype.removeChildAt=function(t){var e=this.getChildAt(t);e.parent=null;this.children.splice(t,1);return e};a.prototype.removeChildren=function(t,e){var r=t||0;var i=typeof e==="number"?e:this.children.length;var n=i-r;if(n>0&&n<=i){var o=this.children.splice(r,n);for(var s=0;s<o.length;++s){o[s].parent=null}return o}else if(n===0&&this.children.length===0){return[]}else{throw new RangeError("removeChildren: numeric values are outside the acceptable range.")}};a.prototype.generateTexture=function(t,e,r){var i=this.getLocalBounds();var n=new o(t,i.width|0,i.height|0,t,r,e);s.tx=-i.x;s.ty=-i.y;n.render(this,s);return n};a.prototype.updateTransform=function(){if(!this.visible){return}this.displayObjectUpdateTransform();for(var t=0,e=this.children.length;t<e;++t){this.children[t].updateTransform()}};a.prototype.containerUpdateTransform=a.prototype.updateTransform;a.prototype.getBounds=function(){if(!this._currentBounds){if(this.children.length===0){return i.Rectangle.EMPTY}var t=Infinity;var e=Infinity;var r=-Infinity;var n=-Infinity;var o;var s;var a;var l=false;for(var h=0,u=this.children.length;h<u;++h){var c=this.children[h];if(!c.visible){continue}l=true;o=this.children[h].getBounds();t=t<o.x?t:o.x;e=e<o.y?e:o.y;s=o.width+o.x;a=o.height+o.y;r=r>s?r:s;n=n>a?n:a}if(!l){return i.Rectangle.EMPTY}var f=this._bounds;f.x=t;f.y=e;f.width=r-t;f.height=n-e;this._currentBounds=f}return this._currentBounds};a.prototype.getLocalBounds=function(){var t=this.worldTransform;this.worldTransform=i.Matrix.IDENTITY;for(var e=0,r=this.children.length;e<r;++e){this.children[e].updateTransform()}this.worldTransform=t;this._currentBounds=null;return this.getBounds()};a.prototype.renderWebGL=function(t){if(!this.visible||this.worldAlpha<=0||!this.renderable){return}var e,r;if(this._mask||this._filters){t.currentRenderer.flush();if(this._filters){t.filterManager.pushFilter(this,this._filters)}if(this._mask){t.maskManager.pushMask(this,this._mask)}t.currentRenderer.start();this._renderWebGL(t);for(e=0,r=this.children.length;e<r;e++){this.children[e].renderWebGL(t)}t.currentRenderer.flush();if(this._mask){t.maskManager.popMask(this,this._mask)}if(this._filters){t.filterManager.popFilter()}t.currentRenderer.start()}else{this._renderWebGL(t);for(e=0,r=this.children.length;e<r;++e){this.children[e].renderWebGL(t)}}};a.prototype._renderWebGL=function(t){};a.prototype._renderCanvas=function(t){};a.prototype.renderCanvas=function(t){if(!this.visible||this.alpha<=0||!this.renderable){return}if(this._mask){t.maskManager.pushMask(this._mask,t)}this._renderCanvas(t);for(var e=0,r=this.children.length;e<r;++e){this.children[e].renderCanvas(t)}if(this._mask){t.maskManager.popMask(t)}}},{"../math":80,"../textures/RenderTexture":117,"./DisplayObject":72}],72:[function(t,e,r){var i=t("../math"),n=t("../utils"),o=t("../textures/RenderTexture"),s=new i.Matrix;function a(){this.position=new i.Point;this.scale=new i.Point(1,1);this.pivot=new i.Point(0,0);this.rotation=0;this.alpha=1;this.visible=true;this.renderable=true;this.parent=null;this.worldAlpha=1;this.worldTransform=new i.Matrix;this.filterArea=null;this._sr=0;this._cr=1;this._bounds=new i.Rectangle(0,0,1,1);this._currentBounds=null;this._mask=null;this._cacheAsBitmap=false;this._cachedObject=null}a.prototype.constructor=a;n.eventTarget.mixin(a.prototype);e.exports=a;Object.defineProperties(a.prototype,{x:{get:function(){return this.position.x},set:function(t){this.position.x=t}},y:{get:function(){return this.position.y},set:function(t){this.position.y=t}},worldVisible:{get:function(){var t=this;do{if(!t.visible){return false}t=t.parent}while(t);return true}},mask:{get:function(){return this._mask},set:function(t){if(this._mask){this._mask.renderable=true}this._mask=t;if(this._mask){this._mask.renderable=false}}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(t){this._filters=t&&t.slice()}}});a.prototype.updateTransform=function(){var t=this.parent.worldTransform;var e=this.worldTransform;var r,n,o,s,a,l;if(this.rotation%i.PI_2){if(this.rotation!==this.rotationCache){this.rotationCache=this.rotation;this._sr=Math.sin(this.rotation);this._cr=Math.cos(this.rotation)}r=this._cr*this.scale.x;n=this._sr*this.scale.x;o=-this._sr*this.scale.y;s=this._cr*this.scale.y;a=this.position.x;l=this.position.y;if(this.pivot.x||this.pivot.y){a-=this.pivot.x*r+this.pivot.y*o;l-=this.pivot.x*n+this.pivot.y*s}e.a=r*t.a+n*t.c;e.b=r*t.b+n*t.d;e.c=o*t.a+s*t.c;e.d=o*t.b+s*t.d;e.tx=a*t.a+l*t.c+t.tx;e.ty=a*t.b+l*t.d+t.ty}else{r=this.scale.x;s=this.scale.y;a=this.position.x-this.pivot.x*r;l=this.position.y-this.pivot.y*s;e.a=r*t.a;e.b=r*t.b;e.c=s*t.c;e.d=s*t.d;e.tx=a*t.a+l*t.c+t.tx;e.ty=a*t.b+l*t.d+t.ty}this.worldAlpha=this.alpha*this.parent.worldAlpha;this._currentBounds=null};a.prototype.displayObjectUpdateTransform=a.prototype.updateTransform;a.prototype.getBounds=function(t){return i.Rectangle.EMPTY};a.prototype.getLocalBounds=function(){return this.getBounds(i.Matrix.IDENTITY)};a.prototype.toGlobal=function(t){this.displayObjectUpdateTransform();return this.worldTransform.apply(t)};a.prototype.toLocal=function(t,e){if(e){t=e.toGlobal(t)}this.displayObjectUpdateTransform();return this.worldTransform.applyInverse(t)};a.prototype.renderWebGL=function(t){};a.prototype.renderCanvas=function(t){};a.prototype.generateTexture=function(t,e,r){var i=this.getLocalBounds();var n=new o(t,i.width|0,i.height|0,t,r,e);s.tx=-i.x;s.ty=-i.y;n.render(this,s);return n}},{"../math":80,"../textures/RenderTexture":117,"../utils":125}],73:[function(t,e,r){var i=t("../display/Container"),n=t("../sprites/Sprite"),o=t("../textures/Texture"),s=t("../renderers/canvas/utils/CanvasBuffer"),a=t("../renderers/canvas/utils/CanvasGraphics"),l=t("./GraphicsData"),h=t("../math"),u=t("../const"),c=new h.Point;function f(){i.call(this);this.fillAlpha=1;this.lineWidth=0;this.lineColor=0;this.graphicsData=[];this.tint=16777215;this._prevTint=16777215;this.blendMode=u.BLEND_MODES.NORMAL;this.currentPath=null;this._webGL={};this.isMask=false;this.boundsPadding=0;this._localBounds=new h.Rectangle(0,0,1,1);this.dirty=true;this.glDirty=false;this.cachedSpriteDirty=false}f.prototype=Object.create(i.prototype);f.prototype.constructor=f;e.exports=f;Object.defineProperties(f.prototype,{});f.prototype.clone=function(){var t=new f;t.renderable=this.renderable;t.fillAlpha=this.fillAlpha;t.lineWidth=this.lineWidth;t.lineColor=this.lineColor;t.tint=this.tint;t.blendMode=this.blendMode;t.isMask=this.isMask;t.boundsPadding=this.boundsPadding;t.dirty=this.dirty;t.glDirty=this.glDirty;t.cachedSpriteDirty=this.cachedSpriteDirty;for(var e=0;e<this.graphicsData.length;++e){t.graphicsData.push(this.graphicsData.clone())}t.currentPath=t.graphicsData[t.graphicsData.length-1];t.updateLocalBounds();return t};f.prototype.lineStyle=function(t,e,r){this.lineWidth=t||0;this.lineColor=e||0;this.lineAlpha=arguments.length<3?1:r;if(this.currentPath){if(this.currentPath.shape.points.length){this.drawShape(new h.Polygon(this.currentPath.shape.points.slice(-2)))}else{this.currentPath.lineWidth=this.lineWidth;this.currentPath.lineColor=this.lineColor;this.currentPath.lineAlpha=this.lineAlpha}}return this};f.prototype.moveTo=function(t,e){this.drawShape(new h.Polygon([t,e]));return this};f.prototype.lineTo=function(t,e){this.currentPath.shape.points.push(t,e);this.dirty=true;return this};f.prototype.quadraticCurveTo=function(t,e,r,i){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points=[0,0]}}else{this.moveTo(0,0)}var n,o,s=20,a=this.currentPath.shape.points;if(a.length===0){this.moveTo(0,0)}var l=a[a.length-2];var h=a[a.length-1];var u=0;for(var c=1;c<=s;++c){u=c/s;n=l+(t-l)*u;o=h+(e-h)*u;a.push(n+(t+(r-t)*u-n)*u,o+(e+(i-e)*u-o)*u)}this.dirty=true;return this};f.prototype.bezierCurveTo=function(t,e,r,i,n,o){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points=[0,0]}}else{this.moveTo(0,0)}var s=20,a,l,h,u,c,f=this.currentPath.shape.points;var d=f[f.length-2];var p=f[f.length-1];var v=0;for(var g=1;g<=s;++g){v=g/s;a=1-v;l=a*a;h=l*a;u=v*v;c=u*v;f.push(h*d+3*l*v*t+3*a*u*r+c*n,h*p+3*l*v*e+3*a*u*i+c*o)}this.dirty=true;return this};f.prototype.arcTo=function(t,e,r,i,n){if(this.currentPath){if(this.currentPath.shape.points.length===0){this.currentPath.shape.points.push(t,e)}}else{this.moveTo(t,e)}var o=this.currentPath.shape.points,s=o[o.length-2],a=o[o.length-1],l=a-e,h=s-t,u=i-e,c=r-t,f=Math.abs(l*c-h*u);if(f<1e-8||n===0){if(o[o.length-2]!==t||o[o.length-1]!==e){o.push(t,e)}}else{var d=l*l+h*h,p=u*u+c*c,v=l*u+h*c,g=n*Math.sqrt(d)/f,m=n*Math.sqrt(p)/f,y=g*v/d,x=m*v/p,_=g*c+m*h,b=g*u+m*l,T=h*(m+y),w=l*(m+y),E=c*(g+x),S=u*(g+x),C=Math.atan2(w-b,T-_),A=Math.atan2(S-b,E-_);this.arc(_+t,b+e,n,C,A,h*u>c*l)}this.dirty=true;return this};f.prototype.arc=function(t,e,r,i,n,o){var s=t+Math.cos(i)*r;var a=e+Math.sin(i)*r;var l;if(this.currentPath){l=this.currentPath.shape.points;if(l.length===0){l.push(s,a)}else if(l[l.length-2]!==s||l[l.length-1]!==a){l.push(s,a)}}else{this.moveTo(s,a);l=this.currentPath.shape.points}if(i===n){return this}if(!o&&n<=i){n+=Math.PI*2}else if(o&&i<=n){i+=Math.PI*2}var h=o?(i-n)*-1:n-i;var u=Math.ceil(Math.abs(h)/(Math.PI*2))*40;if(h===0){return this}var c=h/(u*2);var f=c*2;var d=Math.cos(c);var p=Math.sin(c);var v=u-1;var g=v%1/v;for(var m=0;m<=v;m++){var y=m+g*m;var x=c+i+f*y;var _=Math.cos(x);var b=-Math.sin(x);l.push((d*_+p*b)*r+t,(d*-b+p*_)*r+e)}this.dirty=true;return this};f.prototype.beginFill=function(t,e){this.filling=true;this.fillColor=t||0;this.fillAlpha=e===undefined?1:e;if(this.currentPath){if(this.currentPath.shape.points.length<=2){this.currentPath.fill=this.filling;this.currentPath.fillColor=this.fillColor;this.currentPath.fillAlpha=this.fillAlpha}}return this};f.prototype.endFill=function(){this.filling=false;this.fillColor=null;this.fillAlpha=1;return this};f.prototype.drawRect=function(t,e,r,i){this.drawShape(new h.Rectangle(t,e,r,i));return this};f.prototype.drawRoundedRect=function(t,e,r,i,n){this.drawShape(new h.RoundedRectangle(t,e,r,i,n));return this};f.prototype.drawCircle=function(t,e,r){this.drawShape(new h.Circle(t,e,r));return this};f.prototype.drawEllipse=function(t,e,r,i){this.drawShape(new h.Ellipse(t,e,r,i));return this};f.prototype.drawPolygon=function(t){if(!(t instanceof Array)){t=Array.prototype.slice.call(arguments)}this.drawShape(new h.Polygon(t));return this};f.prototype.clear=function(){this.lineWidth=0;this.filling=false;this.dirty=true;this.clearDirty=true;this.graphicsData=[];return this};f.prototype.generateTexture=function(t,e){t=t||1;var r=this.getBounds();var i=new s(r.width*t,r.height*t);var n=o.fromCanvas(i.canvas,e);n.baseTexture.resolution=t;i.context.scale(t,t);i.context.translate(-r.x,-r.y);a.renderGraphics(this,i.context);return n};f.prototype._renderWebGL=function(t){if(this.glDirty){this.dirty=true;this.glDirty=false}t.setObjectRenderer(t.plugins.graphics);t.plugins.graphics.render(this)};f.prototype._renderCanvas=function(t){if(this.isMask===true){return}if(this._prevTint!==this.tint){this.dirty=true;this._prevTint=this.tint}if(this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty){this._generateCachedSprite();this.updateCachedSpriteTexture();this.cachedSpriteDirty=false;this.dirty=false}this._cachedSprite.alpha=this.alpha;n.prototype._renderCanvas.call(this._cachedSprite,t);return}else{var e=t.context;var r=this.worldTransform;if(this.blendMode!==t.currentBlendMode){t.currentBlendMode=this.blendMode;e.globalCompositeOperation=t.blendModes[t.currentBlendMode]}var i=t.resolution;e.setTransform(r.a*i,r.b*i,r.c*i,r.d*i,r.tx*i,r.ty*i);a.renderGraphics(this,e)}};f.prototype.getBounds=function(t){if(!this._currentBounds){if(!this.renderable){return h.Rectangle.EMPTY}if(this.dirty){this.updateLocalBounds();this.glDirty=true;this.cachedSpriteDirty=true;this.dirty=false}var e=this._localBounds;var r=e.x;var i=e.width+e.x;var n=e.y;var o=e.height+e.y;var s=t||this.worldTransform;var a=s.a;var l=s.b;var u=s.c;var c=s.d;var f=s.tx;var d=s.ty;var p=a*i+u*o+f;var v=c*o+l*i+d;var g=a*r+u*o+f;var m=c*o+l*r+d;var y=a*r+u*n+f;var x=c*n+l*r+d;var _=a*i+u*n+f;var b=c*n+l*i+d;var T=p;var w=v;var E=p;var S=v;E=g<E?g:E;E=y<E?y:E;E=_<E?_:E;S=m<S?m:S;S=x<S?x:S;S=b<S?b:S;T=g>T?g:T;T=y>T?y:T;T=_>T?_:T;w=m>w?m:w;w=x>w?x:w;w=b>w?b:w;this._bounds.x=E;this._bounds.width=T-E;this._bounds.y=S;this._bounds.height=w-S;this._currentBounds=this._bounds}return this._currentBounds};f.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,c);var e=this.graphicsData;for(var r=0;r<e.length;r++){var i=e[r];if(!i.fill){continue}if(i.shape){if(i.shape.contains(c.x,c.y)){return true}}}return false};f.prototype.updateLocalBounds=function(){var t=Infinity;var e=-Infinity;var r=Infinity;var i=-Infinity;if(this.graphicsData.length){var n,o,s,a,l,h;for(var c=0;c<this.graphicsData.length;c++){var f=this.graphicsData[c];var d=f.type;var p=f.lineWidth;n=f.shape;if(d===u.SHAPES.RECT||d===u.SHAPES.RREC){s=n.x-p/2;a=n.y-p/2;l=n.width+p;h=n.height+p;t=s<t?s:t;e=s+l>e?s+l:e;r=a<r?a:r;i=a+h>i?a+h:i}else if(d===u.SHAPES.CIRC){s=n.x;a=n.y;l=n.radius+p/2;h=n.radius+p/2;t=s-l<t?s-l:t;e=s+l>e?s+l:e;r=a-h<r?a-h:r;i=a+h>i?a+h:i}else if(d===u.SHAPES.ELIP){s=n.x;a=n.y;l=n.width+p/2;h=n.height+p/2;t=s-l<t?s-l:t;e=s+l>e?s+l:e;r=a-h<r?a-h:r;i=a+h>i?a+h:i}else{o=n.points;for(var v=0;v<o.length;v+=2){s=o[v];a=o[v+1];t=s-p<t?s-p:t;e=s+p>e?s+p:e;r=a-p<r?a-p:r;i=a+p>i?a+p:i}}}}else{t=0;e=0;r=0;i=0}var g=this.boundsPadding;this._localBounds.x=t-g;this._localBounds.width=e-t+g*2;this._localBounds.y=r-g;this._localBounds.height=i-r+g*2};f.prototype.drawShape=function(t){if(this.currentPath){if(this.currentPath.shape.points.length<=2){this.graphicsData.pop()}}this.currentPath=null;var e=new l(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,t);this.graphicsData.push(e);if(e.type===u.SHAPES.POLY){e.shape.closed=this.filling;this.currentPath=e}this.dirty=true;return e}},{"../const":70,"../display/Container":71,"../math":80,"../renderers/canvas/utils/CanvasBuffer":92,"../renderers/canvas/utils/CanvasGraphics":93,"../sprites/Sprite":114,"../textures/Texture":118,"./GraphicsData":74}],74:[function(t,e,r){function i(t,e,r,i,n,o,s){this.lineWidth=t;this.lineColor=e;this.lineAlpha=r;this._lineTint=e;this.fillColor=i;this.fillAlpha=n;this._fillTint=i;this.fill=o;this.shape=s;this.type=s.type}i.prototype.constructor=i;e.exports=i;i.prototype.clone=function(){return new i(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)}},{}],75:[function(t,e,r){var i=t("../../utils"),n=t("../../math"),o=t("../../const"),s=t("../../renderers/webgl/utils/ObjectRenderer"),a=t("../../renderers/webgl/WebGLRenderer"),l=t("./WebGLGraphicsData");function h(t){s.call(this,t);this.graphicsDataPool=[];this.primitiveShader=null;this.complexPrimitiveShader=null}h.prototype=Object.create(s.prototype);h.prototype.constructor=h;e.exports=h;a.registerPlugin("graphics",h);h.prototype.onContextChange=function(){};h.prototype.destroy=function(){s.prototype.destroy.call(this);this.graphicsDataPool=null};h.prototype.render=function(t){var e=this.renderer;var r=e.gl;var n=e.shaderManager.plugins.primitiveShader,o;if(t.dirty){this.updateGraphics(t,r)}var s=t._webGL[r.id];e.blendModeManager.setBlendMode(t.blendMode);for(var a=0;a<s.data.length;a++){if(s.data[a].mode===1){o=s.data[a];e.stencilManager.pushStencil(t,o,e);r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,(o.indices.length-4)*2);e.stencilManager.popStencil(t,o,e)}else{o=s.data[a];n=e.shaderManager.primitiveShader;e.shaderManager.setShader(n);r.uniformMatrix3fv(n.uniforms.translationMatrix._location,false,t.worldTransform.toArray(true));r.uniformMatrix3fv(n.uniforms.projectionMatrix._location,false,e.currentRenderTarget.projectionMatrix.toArray(true));r.uniform3fv(n.uniforms.tint._location,i.hex2rgb(t.tint));r.uniform1f(n.uniforms.alpha._location,t.worldAlpha);r.bindBuffer(r.ARRAY_BUFFER,o.buffer);r.vertexAttribPointer(n.attributes.aVertexPosition,2,r.FLOAT,false,4*6,0);r.vertexAttribPointer(n.attributes.aColor,4,r.FLOAT,false,4*6,2*4);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,o.indexBuffer);r.drawElements(r.TRIANGLE_STRIP,o.indices.length,r.UNSIGNED_SHORT,0)}}};h.prototype.updateGraphics=function(t){var e=this.renderer.gl;var r=t._webGL[e.id];if(!r){r=t._webGL[e.id]={lastIndex:0,data:[],gl:e}}t.dirty=false;var i;if(t.clearDirty){t.clearDirty=false;for(i=0;i<r.data.length;i++){var n=r.data[i];n.reset();this.graphicsDataPool.push(n)}r.data=[];r.lastIndex=0}var s;for(i=r.lastIndex;i<t.graphicsData.length;i++){var a=t.graphicsData[i];if(a.type===o.SHAPES.POLY){a.points=a.shape.points.slice();if(a.shape.closed){if(a.points[0]!==a.points[a.points.length-2]||a.points[1]!==a.points[a.points.length-1]){a.points.push(a.points[0],a.points[1])}}if(a.fill){if(a.points.length>=6){if(a.points.length<6*2){s=this.switchMode(r,0);var l=this.buildPoly(a,s);if(!l){s=this.switchMode(r,1);this.buildComplexPoly(a,s)}}else{s=this.switchMode(r,1);this.buildComplexPoly(a,s)}}}if(a.lineWidth>0){s=this.switchMode(r,0);this.buildLine(a,s)}}else{s=this.switchMode(r,0);if(a.type===o.SHAPES.RECT){this.buildRectangle(a,s)}else if(a.type===o.SHAPES.CIRC||a.type===o.SHAPES.ELIP){this.buildCircle(a,s)}else if(a.type===o.SHAPES.RREC){this.buildRoundedRectangle(a,s)}}r.lastIndex++}for(i=0;i<r.data.length;i++){s=r.data[i];if(s.dirty){s.upload()}}};h.prototype.switchMode=function(t,e){var r;if(!t.data.length){r=this.graphicsDataPool.pop()||new l(t.gl);r.mode=e;t.data.push(r)}else{r=t.data[t.data.length-1];if(r.points.length>32e4||r.mode!==e||e===1){r=this.graphicsDataPool.pop()||new l(t.gl);r.mode=e;t.data.push(r)}}r.dirty=true;return r};h.prototype.buildRectangle=function(t,e){var r=t.shape;var n=r.x;var o=r.y;var s=r.width;var a=r.height;if(t.fill){var l=i.hex2rgb(t.fillColor);var h=t.fillAlpha;var u=l[0]*h;var c=l[1]*h;var f=l[2]*h;var d=e.points;var p=e.indices;var v=d.length/6;d.push(n,o);d.push(u,c,f,h);d.push(n+s,o);d.push(u,c,f,h);d.push(n,o+a);d.push(u,c,f,h);d.push(n+s,o+a);d.push(u,c,f,h);p.push(v,v,v+1,v+2,v+3,v+3)}if(t.lineWidth){var g=t.points;t.points=[n,o,n+s,o,n+s,o+a,n,o+a,n,o];this.buildLine(t,e);t.points=g}};h.prototype.buildRoundedRectangle=function(t,e){var r=t.shape;var n=r.x;var o=r.y;var s=r.width;var a=r.height;var l=r.radius;var h=[];h.push(n,o+l);h=h.concat(this.quadraticBezierCurve(n,o+a-l,n,o+a,n+l,o+a));h=h.concat(this.quadraticBezierCurve(n+s-l,o+a,n+s,o+a,n+s,o+a-l));h=h.concat(this.quadraticBezierCurve(n+s,o+l,n+s,o,n+s-l,o));h=h.concat(this.quadraticBezierCurve(n+l,o,n,o,n,o+l));if(t.fill){var u=i.hex2rgb(t.fillColor);var c=t.fillAlpha;var f=u[0]*c;var d=u[1]*c;var p=u[2]*c;var v=e.points;var g=e.indices;var m=v.length/6;var y=i.PolyK.Triangulate(h);var x=0;for(x=0;x<y.length;x+=3){g.push(y[x]+m);g.push(y[x]+m);g.push(y[x+1]+m);g.push(y[x+2]+m);g.push(y[x+2]+m)}for(x=0;x<h.length;x++){v.push(h[x],h[++x],f,d,p,c)}}if(t.lineWidth){var _=t.points;t.points=h;this.buildLine(t,e);t.points=_}};h.prototype.quadraticBezierCurve=function(t,e,r,i,n,o){var s,a,l,h,u,c,f=20,d=[];function p(t,e,r){var i=e-t;return t+i*r}var v=0;for(var g=0;g<=f;g++){v=g/f;s=p(t,r,v);a=p(e,i,v);l=p(r,n,v);h=p(i,o,v);u=p(s,l,v);c=p(a,h,v);d.push(u,c)}return d};h.prototype.buildCircle=function(t,e){var r=t.shape;var n=r.x;var s=r.y;var a;var l;if(t.type===o.SHAPES.CIRC){a=r.radius;l=r.radius}else{a=r.width;l=r.height}var h=40;var u=Math.PI*2/h;var c=0;if(t.fill){var f=i.hex2rgb(t.fillColor);var d=t.fillAlpha;var p=f[0]*d;var v=f[1]*d;var g=f[2]*d;var m=e.points;var y=e.indices;var x=m.length/6;y.push(x);for(c=0;c<h+1;c++){m.push(n,s,p,v,g,d);m.push(n+Math.sin(u*c)*a,s+Math.cos(u*c)*l,p,v,g,d);y.push(x++,x++)}y.push(x-1)}if(t.lineWidth){var _=t.points;t.points=[];for(c=0;c<h+1;c++){t.points.push(n+Math.sin(u*c)*a,s+Math.cos(u*c)*l);

}this.buildLine(t,e);t.points=_}};h.prototype.buildLine=function(t,e){var r=0;var o=t.points;if(o.length===0){return}if(t.lineWidth%2){for(r=0;r<o.length;r++){o[r]+=.5}}var s=new n.Point(o[0],o[1]);var a=new n.Point(o[o.length-2],o[o.length-1]);if(s.x===a.x&&s.y===a.y){o=o.slice();o.pop();o.pop();a=new n.Point(o[o.length-2],o[o.length-1]);var l=a.x+(s.x-a.x)*.5;var h=a.y+(s.y-a.y)*.5;o.unshift(l,h);o.push(l,h)}var u=e.points;var c=e.indices;var f=o.length/2;var d=o.length;var p=u.length/6;var v=t.lineWidth/2;var g=i.hex2rgb(t.lineColor);var m=t.lineAlpha;var y=g[0]*m;var x=g[1]*m;var _=g[2]*m;var b,T,w,E,S,C,A,R;var M,O,D,F,P,B;var L,k,I,N,U,j;var X,Y,W;w=o[0];E=o[1];S=o[2];C=o[3];M=-(E-C);O=w-S;W=Math.sqrt(M*M+O*O);M/=W;O/=W;M*=v;O*=v;u.push(w-M,E-O,y,x,_,m);u.push(w+M,E+O,y,x,_,m);for(r=1;r<f-1;r++){w=o[(r-1)*2];E=o[(r-1)*2+1];S=o[r*2];C=o[r*2+1];A=o[(r+1)*2];R=o[(r+1)*2+1];M=-(E-C);O=w-S;W=Math.sqrt(M*M+O*O);M/=W;O/=W;M*=v;O*=v;D=-(C-R);F=S-A;W=Math.sqrt(D*D+F*F);D/=W;F/=W;D*=v;F*=v;L=-O+E-(-O+C);k=-M+S-(-M+w);I=(-M+w)*(-O+C)-(-M+S)*(-O+E);N=-F+R-(-F+C);U=-D+S-(-D+A);j=(-D+A)*(-F+C)-(-D+S)*(-F+R);X=L*U-N*k;if(Math.abs(X)<.1){X+=10.1;u.push(S-M,C-O,y,x,_,m);u.push(S+M,C+O,y,x,_,m);continue}b=(k*j-U*I)/X;T=(N*I-L*j)/X;Y=(b-S)*(b-S)+(T-C)+(T-C);if(Y>140*140){P=M-D;B=O-F;W=Math.sqrt(P*P+B*B);P/=W;B/=W;P*=v;B*=v;u.push(S-P,C-B);u.push(y,x,_,m);u.push(S+P,C+B);u.push(y,x,_,m);u.push(S-P,C-B);u.push(y,x,_,m);d++}else{u.push(b,T);u.push(y,x,_,m);u.push(S-(b-S),C-(T-C));u.push(y,x,_,m)}}w=o[(f-2)*2];E=o[(f-2)*2+1];S=o[(f-1)*2];C=o[(f-1)*2+1];M=-(E-C);O=w-S;W=Math.sqrt(M*M+O*O);M/=W;O/=W;M*=v;O*=v;u.push(S-M,C-O);u.push(y,x,_,m);u.push(S+M,C+O);u.push(y,x,_,m);c.push(p);for(r=0;r<d;r++){c.push(p++)}c.push(p-1)};h.prototype.buildComplexPoly=function(t,e){var r=t.points.slice();if(r.length<6){return}var n=e.indices;e.points=r;e.alpha=t.fillAlpha;e.color=i.hex2rgb(t.fillColor);var o=Infinity;var s=-Infinity;var a=Infinity;var l=-Infinity;var h,u;for(var c=0;c<r.length;c+=2){h=r[c];u=r[c+1];o=h<o?h:o;s=h>s?h:s;a=u<a?u:a;l=u>l?u:l}r.push(o,a,s,a,s,l,o,l);var f=r.length/2;for(c=0;c<f;c++){n.push(c)}};h.prototype.buildPoly=function(t,e){var r=t.points;if(r.length<6){return}var n=e.points;var o=e.indices;var s=r.length/2;var a=i.hex2rgb(t.fillColor);var l=t.fillAlpha;var h=a[0]*l;var u=a[1]*l;var c=a[2]*l;var f=i.PolyK.Triangulate(r);if(!f){return false}var d=n.length/6;var p=0;for(p=0;p<f.length;p+=3){o.push(f[p]+d);o.push(f[p]+d);o.push(f[p+1]+d);o.push(f[p+2]+d);o.push(f[p+2]+d)}for(p=0;p<s;p++){n.push(r[p*2],r[p*2+1],h,u,c,l)}return true}},{"../../const":70,"../../math":80,"../../renderers/webgl/WebGLRenderer":96,"../../renderers/webgl/utils/ObjectRenderer":110,"../../utils":125,"./WebGLGraphicsData":76}],76:[function(t,e,r){function i(t){this.gl=t;this.color=[0,0,0];this.points=[];this.indices=[];this.buffer=t.createBuffer();this.indexBuffer=t.createBuffer();this.mode=1;this.alpha=1;this.dirty=true}i.prototype.constructor=i;e.exports=i;i.prototype.reset=function(){this.points=[];this.indices=[]};i.prototype.upload=function(){var t=this.gl;this.glPoints=new Float32Array(this.points);t.bindBuffer(t.ARRAY_BUFFER,this.buffer);t.bufferData(t.ARRAY_BUFFER,this.glPoints,t.STATIC_DRAW);this.glIndices=new Uint16Array(this.indices);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.glIndices,t.STATIC_DRAW);this.dirty=false}},{}],77:[function(t,e,r){var i=e.exports={utils:t("./utils"),math:t("./math"),CONST:t("./const"),DisplayObject:t("./display/DisplayObject"),Container:t("./display/Container"),Stage:t("./display/Container"),DisplayObjectContainer:t("./display/Container"),Sprite:t("./sprites/Sprite"),ParticleContainer:t("./particles/ParticleContainer"),SpriteRenderer:t("./sprites/webgl/SpriteRenderer"),ParticleRenderer:t("./particles/webgl/ParticleRenderer"),Graphics:t("./graphics/Graphics"),GraphicsData:t("./graphics/GraphicsData"),GraphicsRenderer:t("./graphics/webgl/GraphicsRenderer"),Texture:t("./textures/Texture"),BaseTexture:t("./textures/BaseTexture"),RenderTexture:t("./textures/RenderTexture"),VideoBaseTexture:t("./textures/VideoBaseTexture"),CanvasRenderer:t("./renderers/canvas/CanvasRenderer"),CanvasGraphics:t("./renderers/canvas/utils/CanvasGraphics"),CanvasBuffer:t("./renderers/canvas/utils/CanvasBuffer"),WebGLRenderer:t("./renderers/webgl/WebGLRenderer"),ShaderManager:t("./renderers/webgl/managers/ShaderManager"),Shader:t("./renderers/webgl/shaders/Shader"),AbstractFilter:t("./renderers/webgl/filters/AbstractFilter"),autoDetectRenderer:function(t,e,r,n){t=t||800;e=e||600;if(!n&&a()){return new i.WebGLRenderer(t,e,r)}return new i.CanvasRenderer(t,e,r)}};var n=t("./const");for(var o in n){i[o]=n[o]}var s={stencil:true};function a(){try{if(!window.WebGLRenderingContext){return false}var t=document.createElement("canvas"),e=t.getContext("webgl",s)||t.getContext("experimental-webgl",s);return!!(e&&e.getContextAttributes().stencil)}catch(r){return false}}},{"./const":70,"./display/Container":71,"./display/DisplayObject":72,"./graphics/Graphics":73,"./graphics/GraphicsData":74,"./graphics/webgl/GraphicsRenderer":75,"./math":80,"./particles/ParticleContainer":86,"./particles/webgl/ParticleRenderer":88,"./renderers/canvas/CanvasRenderer":91,"./renderers/canvas/utils/CanvasBuffer":92,"./renderers/canvas/utils/CanvasGraphics":93,"./renderers/webgl/WebGLRenderer":96,"./renderers/webgl/filters/AbstractFilter":97,"./renderers/webgl/managers/ShaderManager":103,"./renderers/webgl/shaders/Shader":108,"./sprites/Sprite":114,"./sprites/webgl/SpriteRenderer":115,"./textures/BaseTexture":116,"./textures/RenderTexture":117,"./textures/Texture":118,"./textures/VideoBaseTexture":120,"./utils":125}],78:[function(t,e,r){var i=t("./Point");function n(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0}n.prototype.constructor=n;e.exports=n;n.prototype.fromArray=function(t){this.a=t[0];this.b=t[1];this.c=t[3];this.d=t[4];this.tx=t[2];this.ty=t[5]};n.prototype.toArray=function(t){if(!this.array){this.array=new Float32Array(9)}var e=this.array;if(t){e[0]=this.a;e[1]=this.b;e[2]=0;e[3]=this.c;e[4]=this.d;e[5]=0;e[6]=this.tx;e[7]=this.ty;e[8]=1}else{e[0]=this.a;e[1]=this.c;e[2]=this.tx;e[3]=this.b;e[4]=this.d;e[5]=this.ty;e[6]=0;e[7]=0;e[8]=1}return e};n.prototype.apply=function(t,e){e=e||new i;var r=t.x;var n=t.y;e.x=this.a*r+this.c*n+this.tx;e.y=this.b*r+this.d*n+this.ty;return e};n.prototype.applyInverse=function(t,e){e=e||new i;var r=1/(this.a*this.d+this.c*-this.b);var n=t.x;var o=t.y;e.x=this.d*r*n+-this.c*r*o+(this.ty*this.c-this.tx*this.d)*r;e.y=this.a*r*o+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r;return e};n.prototype.translate=function(t,e){this.tx+=t;this.ty+=e;return this};n.prototype.scale=function(t,e){this.a*=t;this.d*=e;this.c*=t;this.b*=e;this.tx*=t;this.ty*=e;return this};n.prototype.rotate=function(t){var e=Math.cos(t);var r=Math.sin(t);var i=this.a;var n=this.c;var o=this.tx;this.a=i*e-this.b*r;this.b=i*r+this.b*e;this.c=n*e-this.d*r;this.d=n*r+this.d*e;this.tx=o*e-this.ty*r;this.ty=o*r+this.ty*e;return this};n.prototype.append=function(t){var e=this.a;var r=this.b;var i=this.c;var n=this.d;this.a=t.a*e+t.b*i;this.b=t.a*r+t.b*n;this.c=t.c*e+t.d*i;this.d=t.c*r+t.d*n;this.tx=t.tx*e+t.ty*i+this.tx;this.ty=t.tx*r+t.ty*n+this.ty;return this};n.prototype.prepend=function(t){var e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){var r=this.a;var i=this.c;this.a=r*t.a+this.b*t.c;this.b=r*t.b+this.b*t.d;this.c=i*t.a+this.d*t.c;this.d=i*t.b+this.d*t.d}this.tx=e*t.a+this.ty*t.c+t.tx;this.ty=e*t.b+this.ty*t.d+t.ty;return this};n.prototype.invert=function(){var t=this.a;var e=this.b;var r=this.c;var i=this.d;var n=this.tx;var o=t*i-e*r;this.a=i/o;this.b=-e/o;this.c=-r/o;this.d=t/o;this.tx=(r*this.ty-i*n)/o;this.ty=-(t*this.ty-e*n)/o;return this};n.prototype.identity=function(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0;return this};n.prototype.clone=function(){var t=new n;t.a=this.a;t.b=this.b;t.c=this.c;t.d=this.d;t.tx=this.tx;t.ty=this.ty;return t};n.prototype.copy=function(t){t.a=this.a;t.b=this.b;t.c=this.c;t.d=this.d;t.tx=this.tx;t.ty=this.ty;return t};n.IDENTITY=new n;n.TEMP_MATRIX=new n},{"./Point":79}],79:[function(t,e,r){function i(t,e){this.x=t||0;this.y=e||0}i.prototype.constructor=i;e.exports=i;i.prototype.clone=function(){return new i(this.x,this.y)};i.prototype.set=function(t,e){this.x=t||0;this.y=e||(e!==0?this.x:0)}},{}],80:[function(t,e,r){e.exports={PI_2:Math.PI*2,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,Point:t("./Point"),Matrix:t("./Matrix"),Circle:t("./shapes/Circle"),Ellipse:t("./shapes/Ellipse"),Polygon:t("./shapes/Polygon"),Rectangle:t("./shapes/Rectangle"),RoundedRectangle:t("./shapes/RoundedRectangle")}},{"./Matrix":78,"./Point":79,"./shapes/Circle":81,"./shapes/Ellipse":82,"./shapes/Polygon":83,"./shapes/Rectangle":84,"./shapes/RoundedRectangle":85}],81:[function(t,e,r){var i=t("./Rectangle"),n=t("../../const");function o(t,e,r){this.x=t||0;this.y=e||0;this.radius=r||0;this.type=n.SHAPES.CIRC}o.prototype.constructor=o;e.exports=o;o.prototype.clone=function(){return new o(this.x,this.y,this.radius)};o.prototype.contains=function(t,e){if(this.radius<=0){return false}var r=this.x-t,i=this.y-e,n=this.radius*this.radius;r*=r;i*=i;return r+i<=n};o.prototype.getBounds=function(){return new i(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)}},{"../../const":70,"./Rectangle":84}],82:[function(t,e,r){var i=t("./Rectangle"),n=t("../../const");function o(t,e,r,i){this.x=t||0;this.y=e||0;this.width=r||0;this.height=i||0;this.type=n.SHAPES.ELIP}o.prototype.constructor=o;e.exports=o;o.prototype.clone=function(){return new o(this.x,this.y,this.width,this.height)};o.prototype.contains=function(t,e){if(this.width<=0||this.height<=0){return false}var r=(t-this.x)/this.width,i=(e-this.y)/this.height;r*=r;i*=i;return r+i<=1};o.prototype.getBounds=function(){return new i(this.x-this.width,this.y-this.height,this.width,this.height)}},{"../../const":70,"./Rectangle":84}],83:[function(t,e,r){var i=t("../Point"),n=t("../../const");function o(t){if(!(t instanceof Array)){t=Array.prototype.slice.call(arguments)}if(t[0]instanceof i){var e=[];for(var r=0,o=t.length;r<o;r++){e.push(t[r].x,t[r].y)}t=e}this.closed=true;this.points=t;this.type=n.SHAPES.POLY}o.prototype.constructor=o;e.exports=o;o.prototype.clone=function(){return new o(this.points.slice())};o.prototype.contains=function(t,e){var r=false;var i=this.points.length/2;for(var n=0,o=i-1;n<i;o=n++){var s=this.points[n*2],a=this.points[n*2+1],l=this.points[o*2],h=this.points[o*2+1],u=a>e!==h>e&&t<(l-s)*(e-a)/(h-a)+s;if(u){r=!r}}return r}},{"../../const":70,"../Point":79}],84:[function(t,e,r){var i=t("../../const");function n(t,e,r,n){this.x=t||0;this.y=e||0;this.width=r||0;this.height=n||0;this.type=i.SHAPES.RECT}n.prototype.constructor=n;e.exports=n;n.EMPTY=new n(0,0,0,0);n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)};n.prototype.contains=function(t,e){if(this.width<=0||this.height<=0){return false}if(t>=this.x&&t<this.x+this.width){if(e>=this.y&&e<this.y+this.height){return true}}return false}},{"../../const":70}],85:[function(t,e,r){var i=t("../../const");function n(t,e,r,n,o){this.x=t||0;this.y=e||0;this.width=r||0;this.height=n||0;this.radius=o||20;this.type=i.SHAPES.RREC}n.prototype.constructor=n;e.exports=n;n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height,this.radius)};n.prototype.contains=function(t,e){if(this.width<=0||this.height<=0){return false}if(t>=this.x&&t<=this.x+this.width){if(e>=this.y&&e<=this.y+this.height){return true}}return false}},{"../../const":70}],86:[function(t,e,r){var i=t("../display/Container");function n(t,e){i.call(this);this._properties=e||[false,true,false,false,false];this._size=t||15e3;this._buffers=null;this._updateStatic=false;this.interactiveChildren=false}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.updateTransform=function(){this.displayObjectUpdateTransform()};n.prototype.renderWebGL=function(t){if(!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable){return}t.setObjectRenderer(t.plugins.particle);t.plugins.particle.render(this)};n.prototype.addChildAt=function(t,e){if(t===this){return t}if(e>=0&&e<=this.children.length){if(t.parent){t.parent.removeChild(t)}t.parent=this;this.children.splice(e,0,t);this._updateStatic=true;return t}else{throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length)}};n.prototype.removeChildAt=function(t){var e=this.getChildAt(t);e.parent=null;this.children.splice(t,1);this._updateStatic=true;return e};n.prototype.renderCanvas=function(t){if(!this.visible||this.worldAlpha<=0||!this.children.length||!this.renderable){return}var e=t.context;var r=this.worldTransform;var i=true;e.globalAlpha=this.worldAlpha;this.displayObjectUpdateTransform();for(var n=0;n<this.children.length;++n){var o=this.children[n];if(!o.visible){continue}var s=o.texture.frame;e.globalAlpha=this.worldAlpha*o.alpha;if(o.rotation%(Math.PI*2)===0){if(i){e.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty);i=false}e.drawImage(o.texture.baseTexture.source,s.x,s.y,s.width,s.height,o.anchor.x*(-s.width*o.scale.x)+o.position.x+.5|0,o.anchor.y*(-s.height*o.scale.y)+o.position.y+.5|0,s.width*o.scale.x,s.height*o.scale.y)}else{if(!i){i=true}o.displayObjectUpdateTransform();var a=o.worldTransform;if(t.roundPixels){e.setTransform(a.a,a.b,a.c,a.d,a.tx|0,a.ty|0)}else{e.setTransform(a.a,a.b,a.c,a.d,a.tx,a.ty)}e.drawImage(o.texture.baseTexture.source,s.x,s.y,s.width,s.height,o.anchor.x*-s.width+.5|0,o.anchor.y*-s.height+.5|0,s.width,s.height)}}}},{"../display/Container":71}],87:[function(t,e,r){function i(t,e,r){this.gl=t;this.vertSize=2;this.vertByteSize=this.vertSize*4;this.size=r;this.dynamicProperties=[];this.staticProperties=[];for(var i=0;i<e.length;i++){var n=e[i];if(n.dynamic){this.dynamicProperties.push(n)}else{this.staticProperties.push(n)}}this.staticStride=0;this.staticBuffer=null;this.staticData=null;this.dynamicStride=0;this.dynamicBuffer=null;this.dynamicData=null;this.initBuffers()}i.prototype.constructor=i;e.exports=i;i.prototype.initBuffers=function(){var t=this.gl;var e;var r;var i=0;this.dynamicStride=0;for(e=0;e<this.dynamicProperties.length;e++){r=this.dynamicProperties[e];r.offset=i;i+=r.size;this.dynamicStride+=r.size}this.dynamicData=new Float32Array(this.size*this.dynamicStride*4);this.dynamicBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this.dynamicBuffer);t.bufferData(t.ARRAY_BUFFER,this.dynamicData,t.DYNAMIC_DRAW);var n=0;this.staticStride=0;for(e=0;e<this.staticProperties.length;e++){r=this.staticProperties[e];r.offset=n;n+=r.size;this.staticStride+=r.size}this.staticData=new Float32Array(this.size*this.staticStride*4);this.staticBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this.staticBuffer);t.bufferData(t.ARRAY_BUFFER,this.staticData,t.DYNAMIC_DRAW)};i.prototype.uploadDynamic=function(t,e,r){var i=this.gl;for(var n=0;n<this.dynamicProperties.length;n++){var o=this.dynamicProperties[n];o.uploadFunction(t,e,r,this.dynamicData,this.dynamicStride,o.offset)}i.bindBuffer(i.ARRAY_BUFFER,this.dynamicBuffer);i.bufferSubData(i.ARRAY_BUFFER,0,this.dynamicData)};i.prototype.uploadStatic=function(t,e,r){var i=this.gl;for(var n=0;n<this.staticProperties.length;n++){var o=this.staticProperties[n];o.uploadFunction(t,e,r,this.staticData,this.staticStride,o.offset)}i.bindBuffer(i.ARRAY_BUFFER,this.staticBuffer);i.bufferSubData(i.ARRAY_BUFFER,0,this.staticData)};i.prototype.bind=function(){var t=this.gl;var e,r;t.bindBuffer(t.ARRAY_BUFFER,this.dynamicBuffer);for(e=0;e<this.dynamicProperties.length;e++){r=this.dynamicProperties[e];t.vertexAttribPointer(r.attribute,r.size,t.FLOAT,false,this.dynamicStride*4,r.offset*4)}t.bindBuffer(t.ARRAY_BUFFER,this.staticBuffer);for(e=0;e<this.staticProperties.length;e++){r=this.staticProperties[e];t.vertexAttribPointer(r.attribute,r.size,t.FLOAT,false,this.staticStride*4,r.offset*4)}};i.prototype.destroy=function(){}},{}],88:[function(t,e,r){var i=t("../../renderers/webgl/utils/ObjectRenderer"),n=t("../../renderers/webgl/WebGLRenderer"),o=t("./ParticleShader"),s=t("./ParticleBuffer"),a=t("../../math");function l(t){i.call(this,t);this.size=15e3;var e=this.size*6;this.indices=new Uint16Array(e);for(var r=0,n=0;r<e;r+=6,n+=4){this.indices[r+0]=n+0;this.indices[r+1]=n+1;this.indices[r+2]=n+2;this.indices[r+3]=n+0;this.indices[r+4]=n+2;this.indices[r+5]=n+3}this.shader=null;this.tempMatrix=new a.Matrix}l.prototype=Object.create(i.prototype);l.prototype.constructor=l;e.exports=l;n.registerPlugin("particle",l);l.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=new o(this.renderer.shaderManager);this.indexBuffer=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW);this.properties=[{attribute:this.shader.attributes.aVertexPosition,dynamic:false,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,dynamic:true,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,dynamic:false,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,dynamic:false,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,dynamic:false,size:1,uploadFunction:this.uploadAlpha,offset:0}]};l.prototype.start=function(){var t=this.renderer.gl;t.activeTexture(t.TEXTURE0);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.shader;this.renderer.shaderManager.setShader(e)};l.prototype.render=function(t){var e=t.children,r=e.length,i=t._size;if(r===0){return}else if(r>i){r=i}if(!t._buffers){t._buffers=this.generateBuffers(t)}var n=this.renderer.gl;var o=t.worldTransform.copy(this.tempMatrix);o.prepend(this.renderer.currentRenderTarget.projectionMatrix);n.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location,false,o.toArray(true));var s=t._updateStatic;var a=e[0]._texture.baseTexture;if(!a._glTextures[n.id]){this.renderer.updateTexture(a);if(!this.properties[0].dynamic||!this.properties[3].dynamic){s=true}}else{n.bindTexture(n.TEXTURE_2D,a._glTextures[n.id])}var l=0;for(var h=0;h<r;h+=this.size){var u=r-h;if(u>this.size){u=this.size}var c=t._buffers[l++];c.uploadDynamic(e,h,u);if(s){c.uploadStatic(e,h,u)}c.bind(this.shader);n.drawElements(n.TRIANGLES,u*6,n.UNSIGNED_SHORT,0);this.renderer.drawCount++}t._updateStatic=false};l.prototype.generateBuffers=function(t){var e=this.renderer.gl,r=[],i=t._size,n;for(n=0;n<t._properties.length;n++){this.properties[n].dynamic=t._properties[n]}for(n=0;n<i;n+=this.size){r.push(new s(e,this.properties,this.size,this.shader))}return r};l.prototype.uploadVertices=function(t,e,r,i,n,o){var s,a,l,h,u,c,f,d,p;for(var v=0;v<r;v++){s=t[e+v];a=s._texture;h=s.scale.x;u=s.scale.y;if(a.trim){l=a.trim;f=l.x-s.anchor.x*l.width;c=f+a.crop.width;p=l.y-s.anchor.y*l.height;d=p+a.crop.height}else{c=a._frame.width*(1-s.anchor.x);f=a._frame.width*-s.anchor.x;d=a._frame.height*(1-s.anchor.y);p=a._frame.height*-s.anchor.y}i[o]=f*h;i[o+1]=p*u;i[o+n]=c*h;i[o+n+1]=p*u;i[o+n*2]=c*h;i[o+n*2+1]=d*u;i[o+n*3]=f*h;i[o+n*3+1]=d*u;o+=n*4}};l.prototype.uploadPosition=function(t,e,r,i,n,o){for(var s=0;s<r;s++){var a=t[e+s].position;i[o]=a.x;i[o+1]=a.y;i[o+n]=a.x;i[o+n+1]=a.y;i[o+n*2]=a.x;i[o+n*2+1]=a.y;i[o+n*3]=a.x;i[o+n*3+1]=a.y;o+=n*4}};l.prototype.uploadRotation=function(t,e,r,i,n,o){for(var s=0;s<r;s++){var a=t[e+s].rotation;i[o]=a;i[o+n]=a;i[o+n*2]=a;i[o+n*3]=a;o+=n*4}};l.prototype.uploadUvs=function(t,e,r,i,n,o){for(var s=0;s<r;s++){var a=t[e+s]._texture._uvs;if(a){i[o]=a.x0;i[o+1]=a.y0;i[o+n]=a.x1;i[o+n+1]=a.y1;i[o+n*2]=a.x2;i[o+n*2+1]=a.y2;i[o+n*3]=a.x3;i[o+n*3+1]=a.y3;o+=n*4}else{i[o]=0;i[o+1]=0;i[o+n]=0;i[o+n+1]=0;i[o+n*2]=0;i[o+n*2+1]=0;i[o+n*3]=0;i[o+n*3+1]=0;o+=n*4}}};l.prototype.uploadAlpha=function(t,e,r,i,n,o){for(var s=0;s<r;s++){var a=t[e+s].alpha;i[o]=a;i[o+n]=a;i[o+n*2]=a;i[o+n*3]=a;o+=n*4}};l.prototype.destroy=function(){this.shader.destroy()}},{"../../math":80,"../../renderers/webgl/WebGLRenderer":96,"../../renderers/webgl/utils/ObjectRenderer":110,"./ParticleBuffer":87,"./ParticleShader":89}],89:[function(t,e,r){var i=t("../../renderers/webgl/shaders/TextureShader");function n(t){i.call(this,t,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n"),null,{aPositionCoord:0,aRotation:0})}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n},{"../../renderers/webgl/shaders/TextureShader":109}],90:[function(t,e,r){var i=t("../utils"),n=t("../math"),o=t("../const");function s(t,e,r,s){i.sayHello(t);if(s){for(var a in o.DEFAULT_RENDER_OPTIONS){if(typeof s[a]==="undefined"){s[a]=o.DEFAULT_RENDER_OPTIONS[a]}}}else{s=o.DEFAULT_RENDER_OPTIONS}this.type=o.RENDERER_TYPE.UNKNOWN;this.width=e||800;this.height=r||600;this.view=s.view||document.createElement("canvas");this.resolution=s.resolution;this.transparent=s.transparent;this.autoResize=s.autoResize||false;this.blendModes=null;this.preserveDrawingBuffer=s.preserveDrawingBuffer;this.clearBeforeRender=s.clearBeforeRender;this._backgroundColor=16777215;this._backgroundColorRgb=[1,1,1];this._backgroundColorString="#000000";this.backgroundColor=s.backgroundColor||this._backgroundColor;this._tempDisplayObjectParent={worldTransform:new n.Matrix,worldAlpha:1,children:[]};this._lastObjectRendered=this._tempDisplayObjectParent}s.prototype.constructor=s;e.exports=s;i.eventTarget.mixin(s.prototype);Object.defineProperties(s.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t;this._backgroundColorString=i.hex2string(t);i.hex2rgb(t,this._backgroundColorRgb)}}});s.prototype.resize=function(t,e){this.width=t*this.resolution;this.height=e*this.resolution;this.view.width=this.width;this.view.height=this.height;if(this.autoResize){this.view.style.width=this.width/this.resolution+"px";this.view.style.height=this.height/this.resolution+"px"}};s.prototype.destroy=function(t){if(t&&this.view.parent){this.view.parent.removeChild(this.view)}this.type=o.RENDERER_TYPE.UNKNOWN;this.width=0;this.height=0;this.view=null;this.resolution=0;this.transparent=false;this.autoResize=false;this.blendModes=null;this.preserveDrawingBuffer=false;this.clearBeforeRender=false;this._backgroundColor=0;this._backgroundColorRgb=null;this._backgroundColorString=null}},{"../const":70,"../math":80,"../utils":125}],91:[function(t,e,r){var i=t("../SystemRenderer"),n=t("./utils/CanvasMaskManager"),o=t("../../utils"),s=t("../../math"),a=t("../../const");function l(t,e,r){i.call(this,"Canvas",t,e,r);this.type=a.RENDERER_TYPE.CANVAS;this.context=this.view.getContext("2d",{alpha:this.transparent});this.refresh=true;this.maskManager=new n;this.roundPixels=false;this.currentScaleMode=a.SCALE_MODES.DEFAULT;this.currentBlendMode=a.BLEND_MODES.NORMAL;this.smoothProperty="imageSmoothingEnabled";if(!this.context.imageSmoothingEnabled){if(this.context.webkitImageSmoothingEnabled){this.smoothProperty="webkitImageSmoothingEnabled"}else if(this.context.mozImageSmoothingEnabled){this.smoothProperty="mozImageSmoothingEnabled"}else if(this.context.oImageSmoothingEnabled){this.smoothProperty="oImageSmoothingEnabled"}else if(this.context.msImageSmoothingEnabled){this.smoothProperty="msImageSmoothingEnabled"}}this.initPlugins();this._mapBlendModes();this._tempDisplayObjectParent={worldTransform:new s.Matrix,worldAlpha:1};this.resize(t,e)}l.prototype=Object.create(i.prototype);l.prototype.constructor=l;e.exports=l;o.pluginTarget.mixin(l);l.prototype.render=function(t){var e=t.parent;this._lastObjectRendered=t;t.parent=this._tempDisplayObjectParent;t.updateTransform();t.parent=e;this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;this.currentBlendMode=a.BLEND_MODES.NORMAL;this.context.globalCompositeOperation=this.blendModes[a.BLEND_MODES.NORMAL];if(navigator.isCocoonJS&&this.view.screencanvas){this.context.fillStyle="black";this.context.clear()}if(this.clearBeforeRender){if(this.transparent){this.context.clearRect(0,0,this.width,this.height)}else{this.context.fillStyle=this._backgroundColorString;this.context.fillRect(0,0,this.width,this.height)}}this.renderDisplayObject(t,this.context)};l.prototype.destroy=function(t){this.destroyPlugins();i.prototype.destroy.call(this,t);this.context=null;this.refresh=true;this.maskManager.destroy();this.maskManager=null;this.roundPixels=false;this.currentScaleMode=0;this.currentBlendMode=0;this.smoothProperty=null};l.prototype.renderDisplayObject=function(t,e){var r=this.context;this.context=e;t.renderCanvas(this);this.context=r};l.prototype._mapBlendModes=function(){if(!this.blendModes){this.blendModes={};if(o.canUseNewCanvasBlendModes()){this.blendModes[a.BLEND_MODES.NORMAL]="source-over";this.blendModes[a.BLEND_MODES.ADD]="lighter";this.blendModes[a.BLEND_MODES.MULTIPLY]="multiply";this.blendModes[a.BLEND_MODES.SCREEN]="screen";this.blendModes[a.BLEND_MODES.OVERLAY]="overlay";this.blendModes[a.BLEND_MODES.DARKEN]="darken";this.blendModes[a.BLEND_MODES.LIGHTEN]="lighten";this.blendModes[a.BLEND_MODES.COLOR_DODGE]="color-dodge";this.blendModes[a.BLEND_MODES.COLOR_BURN]="color-burn";this.blendModes[a.BLEND_MODES.HARD_LIGHT]="hard-light";this.blendModes[a.BLEND_MODES.SOFT_LIGHT]="soft-light";this.blendModes[a.BLEND_MODES.DIFFERENCE]="difference";this.blendModes[a.BLEND_MODES.EXCLUSION]="exclusion";this.blendModes[a.BLEND_MODES.HUE]="hue";this.blendModes[a.BLEND_MODES.SATURATION]="saturation";this.blendModes[a.BLEND_MODES.COLOR]="color";this.blendModes[a.BLEND_MODES.LUMINOSITY]="luminosity"}else{this.blendModes[a.BLEND_MODES.NORMAL]="source-over";this.blendModes[a.BLEND_MODES.ADD]="lighter";this.blendModes[a.BLEND_MODES.MULTIPLY]="source-over";this.blendModes[a.BLEND_MODES.SCREEN]="source-over";this.blendModes[a.BLEND_MODES.OVERLAY]="source-over";this.blendModes[a.BLEND_MODES.DARKEN]="source-over";this.blendModes[a.BLEND_MODES.LIGHTEN]="source-over";this.blendModes[a.BLEND_MODES.COLOR_DODGE]="source-over";this.blendModes[a.BLEND_MODES.COLOR_BURN]="source-over";this.blendModes[a.BLEND_MODES.HARD_LIGHT]="source-over";this.blendModes[a.BLEND_MODES.SOFT_LIGHT]="source-over";this.blendModes[a.BLEND_MODES.DIFFERENCE]="source-over";this.blendModes[a.BLEND_MODES.EXCLUSION]="source-over";this.blendModes[a.BLEND_MODES.HUE]="source-over";this.blendModes[a.BLEND_MODES.SATURATION]="source-over";this.blendModes[a.BLEND_MODES.COLOR]="source-over";this.blendModes[a.BLEND_MODES.LUMINOSITY]="source-over"}}}},{"../../const":70,"../../math":80,"../../utils":125,"../SystemRenderer":90,"./utils/CanvasMaskManager":94}],92:[function(t,e,r){function i(t,e){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.width=t;this.canvas.height=e}i.prototype.constructor=i;e.exports=i;Object.defineProperties(i.prototype,{width:{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t}},height:{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t}}});i.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.canvas.width,this.canvas.height)};i.prototype.resize=function(t,e){this.canvas.width=t;this.canvas.height=e};i.prototype.destroy=function(){this.context=null;this.canvas=null}},{}],93:[function(t,e,r){var i=t("../../../const");var n=e.exports={};n.renderGraphics=function(t,e){var r=t.worldAlpha;if(t.dirty){this.updateGraphicsTint(t);t.dirty=false}for(var n=0;n<t.graphicsData.length;n++){var o=t.graphicsData[n];var s=o.shape;var a=o._fillTint;var l=o._lineTint;e.lineWidth=o.lineWidth;if(o.type===i.SHAPES.POLY){e.beginPath();var h=s.points;e.moveTo(h[0],h[1]);for(var u=1;u<h.length/2;u++){e.lineTo(h[u*2],h[u*2+1])}if(s.closed){e.lineTo(h[0],h[1])}if(h[0]===h[h.length-2]&&h[1]===h[h.length-1]){e.closePath()}if(o.fill){e.globalAlpha=o.fillAlpha*r;e.fillStyle="#"+("00000"+(a|0).toString(16)).substr(-6);e.fill()}if(o.lineWidth){e.globalAlpha=o.lineAlpha*r;e.strokeStyle="#"+("00000"+(l|0).toString(16)).substr(-6);e.stroke()}}else if(o.type===i.SHAPES.RECT){if(o.fillColor||o.fillColor===0){e.globalAlpha=o.fillAlpha*r;e.fillStyle="#"+("00000"+(a|0).toString(16)).substr(-6);e.fillRect(s.x,s.y,s.width,s.height)}if(o.lineWidth){e.globalAlpha=o.lineAlpha*r;e.strokeStyle="#"+("00000"+(l|0).toString(16)).substr(-6);e.strokeRect(s.x,s.y,s.width,s.height)}}else if(o.type===i.SHAPES.CIRC){e.beginPath();e.arc(s.x,s.y,s.radius,0,2*Math.PI);e.closePath();if(o.fill){e.globalAlpha=o.fillAlpha*r;e.fillStyle="#"+("00000"+(a|0).toString(16)).substr(-6);e.fill()}if(o.lineWidth){e.globalAlpha=o.lineAlpha*r;e.strokeStyle="#"+("00000"+(l|0).toString(16)).substr(-6);e.stroke()}}else if(o.type===i.SHAPES.ELIP){var c=s.width*2;var f=s.height*2;var d=s.x-c/2;var p=s.y-f/2;e.beginPath();var v=.5522848,g=c/2*v,m=f/2*v,y=d+c,x=p+f,_=d+c/2,b=p+f/2;e.moveTo(d,b);e.bezierCurveTo(d,b-m,_-g,p,_,p);e.bezierCurveTo(_+g,p,y,b-m,y,b);e.bezierCurveTo(y,b+m,_+g,x,_,x);e.bezierCurveTo(_-g,x,d,b+m,d,b);e.closePath();if(o.fill){e.globalAlpha=o.fillAlpha*r;e.fillStyle="#"+("00000"+(a|0).toString(16)).substr(-6);e.fill()}if(o.lineWidth){e.globalAlpha=o.lineAlpha*r;e.strokeStyle="#"+("00000"+(l|0).toString(16)).substr(-6);e.stroke()}}else if(o.type===i.SHAPES.RREC){var T=s.x;var w=s.y;var E=s.width;var S=s.height;var C=s.radius;var A=Math.min(E,S)/2|0;C=C>A?A:C;e.beginPath();e.moveTo(T,w+C);e.lineTo(T,w+S-C);e.quadraticCurveTo(T,w+S,T+C,w+S);e.lineTo(T+E-C,w+S);e.quadraticCurveTo(T+E,w+S,T+E,w+S-C);e.lineTo(T+E,w+C);e.quadraticCurveTo(T+E,w,T+E-C,w);e.lineTo(T+C,w);e.quadraticCurveTo(T,w,T,w+C);e.closePath();if(o.fillColor||o.fillColor===0){e.globalAlpha=o.fillAlpha*r;e.fillStyle="#"+("00000"+(a|0).toString(16)).substr(-6);e.fill()}if(o.lineWidth){e.globalAlpha=o.lineAlpha*r;e.strokeStyle="#"+("00000"+(l|0).toString(16)).substr(-6);e.stroke()}}}};n.renderGraphicsMask=function(t,e){var r=t.graphicsData.length;if(r===0){return}e.beginPath();for(var n=0;n<r;n++){var o=t.graphicsData[n];var s=o.shape;if(o.type===i.SHAPES.POLY){var a=s.points;e.moveTo(a[0],a[1]);for(var l=1;l<a.length/2;l++){e.lineTo(a[l*2],a[l*2+1])}if(a[0]===a[a.length-2]&&a[1]===a[a.length-1]){e.closePath()}}else if(o.type===i.SHAPES.RECT){e.rect(s.x,s.y,s.width,s.height);e.closePath()}else if(o.type===i.SHAPES.CIRC){e.arc(s.x,s.y,s.radius,0,2*Math.PI);e.closePath()}else if(o.type===i.SHAPES.ELIP){var h=s.width*2;var u=s.height*2;var c=s.x-h/2;var f=s.y-u/2;var d=.5522848,p=h/2*d,v=u/2*d,g=c+h,m=f+u,y=c+h/2,x=f+u/2;e.moveTo(c,x);e.bezierCurveTo(c,x-v,y-p,f,y,f);e.bezierCurveTo(y+p,f,g,x-v,g,x);e.bezierCurveTo(g,x+v,y+p,m,y,m);e.bezierCurveTo(y-p,m,c,x+v,c,x);e.closePath()}else if(o.type===i.SHAPES.RREC){var _=s.x;var b=s.y;var T=s.width;var w=s.height;var E=s.radius;var S=Math.min(T,w)/2|0;E=E>S?S:E;e.moveTo(_,b+E);e.lineTo(_,b+w-E);e.quadraticCurveTo(_,b+w,_+E,b+w);e.lineTo(_+T-E,b+w);e.quadraticCurveTo(_+T,b+w,_+T,b+w-E);e.lineTo(_+T,b+E);e.quadraticCurveTo(_+T,b,_+T-E,b);e.lineTo(_+E,b);e.quadraticCurveTo(_,b,_,b+E);e.closePath()}}};n.updateGraphicsTint=function(t){
if(t.tint===16777215){return}var e=(t.tint>>16&255)/255;var r=(t.tint>>8&255)/255;var i=(t.tint&255)/255;for(var n=0;n<t.graphicsData.length;n++){var o=t.graphicsData[n];var s=o.fillColor|0;var a=o.lineColor|0;o._fillTint=((s>>16&255)/255*e*255<<16)+((s>>8&255)/255*r*255<<8)+(s&255)/255*i*255;o._lineTint=((a>>16&255)/255*e*255<<16)+((a>>8&255)/255*r*255<<8)+(a&255)/255*i*255}}},{"../../../const":70}],94:[function(t,e,r){var i=t("./CanvasGraphics");function n(){}n.prototype.constructor=n;e.exports=n;n.prototype.pushMask=function(t,e){e.context.save();var r=t.alpha;var n=t.worldTransform;var o=e.resolution;e.context.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o);if(!t.texture){i.renderGraphicsMask(t,e.context);e.context.clip()}t.worldAlpha=r};n.prototype.popMask=function(t){t.context.restore()}},{"./CanvasGraphics":93}],95:[function(t,e,r){var i=t("../../../utils");var n=e.exports={};n.getTintedTexture=function(t,e){var r=t.texture;e=n.roundColor(e);var i="#"+("00000"+(e|0).toString(16)).substr(-6);r.tintCache=r.tintCache||{};if(r.tintCache[i]){return r.tintCache[i]}var o=n.canvas||document.createElement("canvas");n.tintMethod(r,e,o);if(n.convertTintToImage){var s=new Image;s.src=o.toDataURL();r.tintCache[i]=s}else{r.tintCache[i]=o;n.canvas=null}return o};n.tintWithMultiply=function(t,e,r){var i=r.getContext("2d");var n=t.crop;r.width=n.width;r.height=n.height;i.fillStyle="#"+("00000"+(e|0).toString(16)).substr(-6);i.fillRect(0,0,n.width,n.height);i.globalCompositeOperation="multiply";i.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height);i.globalCompositeOperation="destination-atop";i.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height)};n.tintWithOverlay=function(t,e,r){var i=r.getContext("2d");var n=t.crop;r.width=n.width;r.height=n.height;i.globalCompositeOperation="copy";i.fillStyle="#"+("00000"+(e|0).toString(16)).substr(-6);i.fillRect(0,0,n.width,n.height);i.globalCompositeOperation="destination-atop";i.drawImage(t.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height)};n.tintWithPerPixel=function(t,e,r){var n=r.getContext("2d");var o=t.crop;r.width=o.width;r.height=o.height;n.globalCompositeOperation="copy";n.drawImage(t.baseTexture.source,o.x,o.y,o.width,o.height,0,0,o.width,o.height);var s=i.hex2rgb(e);var a=s[0],l=s[1],h=s[2];var u=n.getImageData(0,0,o.width,o.height);var c=u.data;for(var f=0;f<c.length;f+=4){c[f+0]*=a;c[f+1]*=l;c[f+2]*=h}n.putImageData(u,0,0)};n.roundColor=function(t){var e=n.cacheStepsPerColorChannel;var r=i.hex2rgb(t);r[0]=Math.min(255,r[0]/e*e);r[1]=Math.min(255,r[1]/e*e);r[2]=Math.min(255,r[2]/e*e);return i.rgb2hex(r)};n.cacheStepsPerColorChannel=8;n.convertTintToImage=false;n.canUseMultiply=i.canUseNewCanvasBlendModes();n.tintMethod=n.canUseMultiply?n.tintWithMultiply:n.tintWithPerPixel},{"../../../utils":125}],96:[function(t,e,r){var i=t("../SystemRenderer"),n=t("./managers/ShaderManager"),o=t("./managers/MaskManager"),s=t("./managers/StencilManager"),a=t("./managers/FilterManager"),l=t("./managers/BlendModeManager"),h=t("./utils/RenderTarget"),u=t("./utils/ObjectRenderer"),c=t("./filters/FXAAFilter"),f=t("../../utils"),d=t("../../const");function p(t,e,r){r=r||{};i.call(this,"WebGL",t,e,r);this.type=d.RENDERER_TYPE.WEBGL;this.handleContextLost=this.handleContextLost.bind(this);this.handleContextRestored=this.handleContextRestored.bind(this);this._updateTextureBound=function(t){this.updateTexture(t.target)}.bind(this);this._destroyTextureBound=function(t){this.destroyTexture(t.target)}.bind(this);this.view.addEventListener("webglcontextlost",this.handleContextLost,false);this.view.addEventListener("webglcontextrestored",this.handleContextRestored,false);this._useFXAA=!!r.forceFXAA&&r.antialias;this._FXAAFilter=null;this._contextOptions={alpha:this.transparent,antialias:r.antialias,premultipliedAlpha:this.transparent&&this.transparent!=="notMultiplied",stencil:true,preserveDrawingBuffer:r.preserveDrawingBuffer};this.drawCount=0;this.shaderManager=new n(this);this.maskManager=new o(this);this.stencilManager=new s(this);this.filterManager=new a(this);this.blendModeManager=new l(this);this.currentRenderTarget=this.renderTarget;this.currentRenderer=new u(this);this.initPlugins();this._initContext();this._mapBlendModes();this._renderTargetStack=[]}p.prototype=Object.create(i.prototype);p.prototype.constructor=p;e.exports=p;f.pluginTarget.mixin(p);p.glContextId=0;p.prototype._initContext=function(){var t=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);this.gl=t;if(!t){throw new Error("This browser does not support webGL. Try using the canvas renderer")}this.glContextId=p.glContextId++;t.id=this.glContextId;t.renderer=this;t.disable(t.DEPTH_TEST);t.disable(t.CULL_FACE);t.enable(t.BLEND);this.renderTarget=new h(this.gl,this.width,this.height,null,this.resolution,true);this.emit("context",t);this.resize(this.width,this.height);if(!this._useFXAA){this._useFXAA=this._contextOptions.antialias&&!t.getContextAttributes().antialias}if(this._useFXAA){window.console.warn("FXAA antialiasing being used instead of native antialiasing");this._FXAAFilter=[new c]}};p.prototype.render=function(t){if(this.gl.isContextLost()){return}this._lastObjectRendered=t;if(this._useFXAA){this._FXAAFilter[0].uniforms.resolution.value.x=this.width;this._FXAAFilter[0].uniforms.resolution.value.y=this.height;t.filterArea=this.renderTarget.size;t.filters=this._FXAAFilter}var e=t.parent;t.parent=this._tempDisplayObjectParent;t.updateTransform();t.parent=e;var r=this.gl;this.setRenderTarget(this.renderTarget);if(this.clearBeforeRender){if(this.transparent){r.clearColor(0,0,0,0)}else{r.clearColor(this._backgroundColorRgb[0],this._backgroundColorRgb[1],this._backgroundColorRgb[2],1)}r.clear(r.COLOR_BUFFER_BIT)}this.renderDisplayObject(t,this.renderTarget)};p.prototype.renderDisplayObject=function(t,e){this.setRenderTarget(e);this.filterManager.setFilterStack(e.filterStack);t.renderWebGL(this);this.currentRenderer.flush()};p.prototype.setObjectRenderer=function(t){if(this.currentRenderer===t){return}this.currentRenderer.stop();this.currentRenderer=t;this.currentRenderer.start()};p.prototype.setRenderTarget=function(t){if(this.currentRenderTarget===t){return}this.currentRenderTarget=t;this.currentRenderTarget.activate();this.stencilManager.setMaskStack(t.stencilMaskStack)};p.prototype.resize=function(t,e){i.prototype.resize.call(this,t,e);this.filterManager.resize(t,e);this.renderTarget.resize(t,e);if(this.currentRenderTarget===this.renderTarget){this.renderTarget.activate()}};p.prototype.updateTexture=function(t){t=t.baseTexture||t;if(!t.hasLoaded){return}var e=this.gl;if(!t._glTextures[e.id]){t._glTextures[e.id]=e.createTexture();t.on("update",this._updateTextureBound);t.on("dispose",this._destroyTextureBound)}e.bindTexture(e.TEXTURE_2D,t._glTextures[e.id]);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultipliedAlpha);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t.scaleMode===d.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST);if(t.mipmap&&t.isPowerOfTwo){e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===d.SCALE_MODES.LINEAR?e.LINEAR_MIPMAP_LINEAR:e.NEAREST_MIPMAP_NEAREST);e.generateMipmap(e.TEXTURE_2D)}else{e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.scaleMode===d.SCALE_MODES.LINEAR?e.LINEAR:e.NEAREST)}if(!t.isPowerOfTwo){e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}else{e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)}return t._glTextures[e.id]};p.prototype.destroyTexture=function(t){t=t.baseTexture||t;if(!t.hasLoaded){return}if(t._glTextures[this.gl.id]){this.gl.deleteTexture(t._glTextures[this.gl.id])}};p.prototype.handleContextLost=function(t){t.preventDefault()};p.prototype.handleContextRestored=function(){this._initContext();for(var t in f.BaseTextureCache){f.BaseTextureCache[t]._glTextures.length=0}};p.prototype.destroy=function(t){this.destroyPlugins();this.view.removeEventListener("webglcontextlost",this.handleContextLost);this.view.removeEventListener("webglcontextrestored",this.handleContextRestored);i.prototype.destroy.call(this,t);this.uuid=0;this.shaderManager.destroy();this.maskManager.destroy();this.stencilManager.destroy();this.filterManager.destroy();this.shaderManager=null;this.maskManager=null;this.filterManager=null;this.blendModeManager=null;this.handleContextLost=null;this.handleContextRestored=null;this._contextOptions=null;this.drawCount=0;this.gl=null};p.prototype._mapBlendModes=function(){var t=this.gl;if(!this.blendModes){this.blendModes={};this.blendModes[d.BLEND_MODES.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.ADD]=[t.SRC_ALPHA,t.DST_ALPHA];this.blendModes[d.BLEND_MODES.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.SCREEN]=[t.SRC_ALPHA,t.ONE];this.blendModes[d.BLEND_MODES.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA];this.blendModes[d.BLEND_MODES.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA]}}},{"../../const":70,"../../utils":125,"../SystemRenderer":90,"./filters/FXAAFilter":98,"./managers/BlendModeManager":100,"./managers/FilterManager":101,"./managers/MaskManager":102,"./managers/ShaderManager":103,"./managers/StencilManager":104,"./utils/ObjectRenderer":110,"./utils/RenderTarget":112}],97:[function(t,e,r){var i=t("../shaders/TextureShader");function n(t,e,r){this.shaders=[];this.padding=0;this.uniforms=r||{};this.vertexSrc=t||i.defaultVertexSrc;this.fragmentSrc=e||i.defaultFragmentSrc}n.prototype.constructor=n;e.exports=n;n.prototype.getShader=function(t){var e=t.gl;var r=this.shaders[e.id];if(!r){r=new i(t.shaderManager,this.vertexSrc,this.fragmentSrc,this.uniforms,this.attributes);this.shaders[e.id]=r}return r};n.prototype.applyFilter=function(t,e,r,i){var n=this.getShader(t);t.filterManager.applyFilter(n,e,r,i)};n.prototype.syncUniform=function(t){for(var e=0,r=this.shaders.length;e<r;++e){this.shaders[e].syncUniform(t)}}},{"../shaders/TextureShader":109}],98:[function(t,e,r){var i=t("./AbstractFilter");function n(){i.call(this,"\nprecision mediump float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform vec2 resolution;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n   vResolution = resolution;\n\n   //compute the texture coords and send them to varyings\n   texcoords(aTextureCoord * resolution, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'precision lowp float;\n\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE,\n            vec2 v_rgbSW, vec2 v_rgbSE,\n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D uSampler;\n\n\nvoid main(void){\n\n    gl_FragColor = fxaa(uSampler, vTextureCoord * vResolution, vResolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n}\n',{resolution:{type:"v2",value:{x:1,y:1}}})}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.applyFilter=function(t,e,r){var i=t.filterManager;var n=this.getShader(t);i.applyFilter(n,e,r)}},{"./AbstractFilter":97}],99:[function(t,e,r){var i=t("./AbstractFilter"),n=t("../../../math");function o(t){var e=new n.Matrix;i.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    original *= (masky.r * masky.a * clip);\n    gl_FragColor = original;\n}\n",{mask:{type:"sampler2D",value:t._texture},otherMatrix:{type:"mat3",value:e.toArray(true)}});this.maskSprite=t;this.maskMatrix=e}o.prototype=Object.create(i.prototype);o.prototype.constructor=o;e.exports=o;o.prototype.applyFilter=function(t,e,r){var i=t.filterManager;this.uniforms.mask.value=this.maskSprite._texture;i.calculateMappedMatrix(e.frame,this.maskSprite,this.maskMatrix);this.uniforms.otherMatrix.value=this.maskMatrix.toArray(true);var n=this.getShader(t);i.applyFilter(n,e,r)};Object.defineProperties(o.prototype,{map:{get:function(){return this.uniforms.mask.value},set:function(t){this.uniforms.mask.value=t}},offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}})},{"../../../math":80,"./AbstractFilter":97}],100:[function(t,e,r){var i=t("./WebGLManager");function n(t){i.call(this,t);this.currentBlendMode=99999}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.setBlendMode=function(t){if(this.currentBlendMode===t){return false}this.currentBlendMode=t;var e=this.renderer.blendModes[this.currentBlendMode];this.renderer.gl.blendFunc(e[0],e[1]);return true}},{"./WebGLManager":105}],101:[function(t,e,r){var i=t("./WebGLManager"),n=t("../utils/RenderTarget"),o=t("../../../const"),s=t("../utils/Quad"),a=t("../../../math");function l(t){i.call(this,t);this.filterStack=[];this.filterStack.push({renderTarget:t.currentRenderTarget,filter:[],bounds:null});this.texturePool=[];this.textureSize=new a.Rectangle(0,0,t.width,t.height);this.currentFrame=null}l.prototype=Object.create(i.prototype);l.prototype.constructor=l;e.exports=l;l.prototype.onContextChange=function(){this.texturePool.length=0;var t=this.renderer.gl;this.quad=new s(t)};l.prototype.setFilterStack=function(t){this.filterStack=t};l.prototype.pushFilter=function(t,e){var r=t.filterArea||t.getBounds();r.x=r.x|0;r.y=r.y|0;r.width=r.width|0;r.height=r.height|0;var i=e[0].padding;r.x-=i;r.y-=i;r.width+=i*2;r.height+=i*2;if(this.renderer.currentRenderTarget.transform){var n=this.renderer.currentRenderTarget.transform;r.x+=n.tx;r.y+=n.ty;this.capFilterArea(r);r.x-=n.tx;r.y-=n.ty}else{this.capFilterArea(r)}this.currentFrame=r;var o=this.getRenderTarget();this.renderer.setRenderTarget(o);o.clear();this.filterStack.push({renderTarget:o,filter:e})};l.prototype.popFilter=function(){var t=this.filterStack.pop();var e=this.filterStack[this.filterStack.length-1];var r=t.renderTarget;var i=e.renderTarget;var n=this.renderer.gl;this.currentFrame=r.frame;this.quad.map(this.textureSize,r.frame);n.bindBuffer(n.ARRAY_BUFFER,this.quad.vertexBuffer);n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.quad.indexBuffer);var o=t.filter;if(o.length===1){if(o[0].uniforms.dimensions){o[0].uniforms.dimensions.value[0]=this.renderer.width;o[0].uniforms.dimensions.value[1]=this.renderer.height;o[0].uniforms.dimensions.value[2]=this.quad.vertices[0];o[0].uniforms.dimensions.value[3]=this.quad.vertices[5]}o[0].applyFilter(this.renderer,r,i);this.returnRenderTarget(r)}else{var s=r;var a=this.getRenderTarget(true);for(var l=0;l<o.length-1;l++){var h=o[l];if(h.uniforms.dimensions){h.uniforms.dimensions.value[0]=this.renderer.width;h.uniforms.dimensions.value[1]=this.renderer.height;h.uniforms.dimensions.value[2]=this.quad.vertices[0];h.uniforms.dimensions.value[3]=this.quad.vertices[5]}h.applyFilter(this.renderer,s,a);var u=s;s=a;a=u}o[o.length-1].applyFilter(this.renderer,s,i);this.returnRenderTarget(s);this.returnRenderTarget(a)}return t.filter};l.prototype.getRenderTarget=function(t){var e=this.texturePool.pop()||new n(this.renderer.gl,this.textureSize.width,this.textureSize.height,o.SCALE_MODES.LINEAR,this.renderer.resolution*o.FILTER_RESOLUTION);e.frame=this.currentFrame;if(t){e.clear(true)}return e};l.prototype.returnRenderTarget=function(t){this.texturePool.push(t)};l.prototype.applyFilter=function(t,e,r,i){var n=this.renderer.gl;this.renderer.setRenderTarget(r);if(i){r.clear()}this.renderer.shaderManager.setShader(t);t.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(true);t.syncUniforms();n.vertexAttribPointer(t.attributes.aVertexPosition,2,n.FLOAT,false,0,0);n.vertexAttribPointer(t.attributes.aTextureCoord,2,n.FLOAT,false,0,2*4*4);n.vertexAttribPointer(t.attributes.aColor,4,n.FLOAT,false,0,4*4*4);n.activeTexture(n.TEXTURE0);n.bindTexture(n.TEXTURE_2D,e.texture);n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0)};l.prototype.calculateMappedMatrix=function(t,e,r){var i=e.worldTransform.copy(a.Matrix.TEMP_MATRIX),n=e._texture.baseTexture;var o=r.identity();var s=this.textureSize.height/this.textureSize.width;o.translate(t.x/this.textureSize.width,t.y/this.textureSize.height);o.scale(1,s);var l=this.textureSize.width/n.width;var h=this.textureSize.height/n.height;i.tx/=n.width*l;i.ty/=n.width*l;i.invert();o.prepend(i);o.scale(1,1/s);o.scale(l,h);o.translate(e.anchor.x,e.anchor.y);return o};l.prototype.capFilterArea=function(t){if(t.x<0){t.width+=t.x;t.x=0}if(t.y<0){t.height+=t.y;t.y=0}if(t.x+t.width>this.textureSize.width){t.width=this.textureSize.width-t.x}if(t.y+t.height>this.textureSize.height){t.height=this.textureSize.height-t.y}};l.prototype.resize=function(t,e){this.textureSize.width=t;this.textureSize.height=e;for(var r=0;r<this.texturePool.length;r++){this.texturePool[r].resize(t,e)}};l.prototype.destroy=function(){this.filterStack=null;this.offsetY=0;for(var t=0;t<this.texturePool.length;t++){this.texturePool[t].destroy()}this.texturePool=null}},{"../../../const":70,"../../../math":80,"../utils/Quad":111,"../utils/RenderTarget":112,"./WebGLManager":105}],102:[function(t,e,r){var i=t("./WebGLManager"),n=t("../filters/SpriteMaskFilter");function o(t){i.call(this,t);this.stencilStack=[];this.reverse=true;this.count=0;this.alphaMaskPool=[]}o.prototype=Object.create(i.prototype);o.prototype.constructor=o;e.exports=o;o.prototype.pushMask=function(t,e){if(e.texture){this.pushSpriteMask(t,e)}else{this.pushStencilMask(t,e)}};o.prototype.popMask=function(t,e){if(e.texture){this.popSpriteMask(t,e)}else{this.popStencilMask(t,e)}};o.prototype.pushSpriteMask=function(t,e){var r=this.alphaMaskPool.pop();if(!r){r=[new n(e)]}this.renderer.filterManager.pushFilter(t,r)};o.prototype.popSpriteMask=function(){var t=this.renderer.filterManager.popFilter();this.alphaMaskPool.push(t)};o.prototype.pushStencilMask=function(t,e){this.renderer.stencilManager.pushMask(e)};o.prototype.popStencilMask=function(t,e){this.renderer.stencilManager.popMask(e)}},{"../filters/SpriteMaskFilter":99,"./WebGLManager":105}],103:[function(t,e,r){var i=t("./WebGLManager"),n=t("../shaders/TextureShader"),o=t("../shaders/ComplexPrimitiveShader"),s=t("../shaders/PrimitiveShader"),a=t("../../../utils");function l(t){i.call(this,t);this.maxAttibs=10;this.attribState=[];this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++){this.attribState[e]=false}this.stack=[];this._currentId=-1;this.currentShader=null}l.prototype=Object.create(i.prototype);l.prototype.constructor=l;a.pluginTarget.mixin(l);e.exports=l;l.prototype.onContextChange=function(){this.initPlugins();this.defaultShader=new n(this);this.primitiveShader=new s(this);this.complexPrimitiveShader=new o(this)};l.prototype.setAttribs=function(t){var e;for(e=0;e<this.tempAttribState.length;e++){this.tempAttribState[e]=false}for(var r in t){this.tempAttribState[t[r]]=true}var i=this.renderer.gl;for(e=0;e<this.attribState.length;e++){if(this.attribState[e]!==this.tempAttribState[e]){this.attribState[e]=this.tempAttribState[e];if(this.attribState[e]){i.enableVertexAttribArray(e)}else{i.disableVertexAttribArray(e)}}}};l.prototype.setShader=function(t){if(this._currentId===t.uuid){return false}this._currentId=t.uuid;this.currentShader=t;this.renderer.gl.useProgram(t.program);this.setAttribs(t.attributes);return true};l.prototype.destroy=function(){i.prototype.destroy.call(this);this.destroyPlugins();this.attribState=null;this.tempAttribState=null}},{"../../../utils":125,"../shaders/ComplexPrimitiveShader":106,"../shaders/PrimitiveShader":107,"../shaders/TextureShader":109,"./WebGLManager":105}],104:[function(t,e,r){var i=t("./WebGLManager"),n=t("../../../utils");function o(t){i.call(this,t);this.stencilMaskStack=null}o.prototype=Object.create(i.prototype);o.prototype.constructor=o;e.exports=o;o.prototype.setMaskStack=function(t){this.stencilMaskStack=t;var e=this.renderer.gl;if(t.stencilStack.length===0){e.disable(e.STENCIL_TEST)}else{e.enable(e.STENCIL_TEST)}};o.prototype.pushStencil=function(t,e){this.renderer.currentRenderTarget.attachStencilBuffer();var r=this.renderer.gl,i=this.stencilMaskStack;this.bindGraphics(t,e,this.renderer);if(i.stencilStack.length===0){r.enable(r.STENCIL_TEST);r.clear(r.STENCIL_BUFFER_BIT);i.reverse=true;i.count=0}i.stencilStack.push(e);var n=i.count;r.colorMask(false,false,false,false);r.stencilFunc(r.ALWAYS,0,255);r.stencilOp(r.KEEP,r.KEEP,r.INVERT);if(e.mode===1){r.drawElements(r.TRIANGLE_FAN,e.indices.length-4,r.UNSIGNED_SHORT,0);if(i.reverse){r.stencilFunc(r.EQUAL,255-n,255);r.stencilOp(r.KEEP,r.KEEP,r.DECR)}else{r.stencilFunc(r.EQUAL,n,255);r.stencilOp(r.KEEP,r.KEEP,r.INCR)}r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,(e.indices.length-4)*2);if(i.reverse){r.stencilFunc(r.EQUAL,255-(n+1),255)}else{r.stencilFunc(r.EQUAL,n+1,255)}i.reverse=!i.reverse}else{if(!i.reverse){r.stencilFunc(r.EQUAL,255-n,255);r.stencilOp(r.KEEP,r.KEEP,r.DECR)}else{r.stencilFunc(r.EQUAL,n,255);r.stencilOp(r.KEEP,r.KEEP,r.INCR)}r.drawElements(r.TRIANGLE_STRIP,e.indices.length,r.UNSIGNED_SHORT,0);if(!i.reverse){r.stencilFunc(r.EQUAL,255-(n+1),255)}else{r.stencilFunc(r.EQUAL,n+1,255)}}r.colorMask(true,true,true,true);r.stencilOp(r.KEEP,r.KEEP,r.KEEP);i.count++};o.prototype.bindGraphics=function(t,e){this._currentGraphics=t;var r=this.renderer.gl;var i;if(e.mode===1){i=this.renderer.shaderManager.complexPrimitiveShader;this.renderer.shaderManager.setShader(i);r.uniformMatrix3fv(i.uniforms.translationMatrix._location,false,t.worldTransform.toArray(true));r.uniformMatrix3fv(i.uniforms.projectionMatrix._location,false,this.renderer.currentRenderTarget.projectionMatrix.toArray(true));r.uniform3fv(i.uniforms.tint._location,n.hex2rgb(t.tint));r.uniform3fv(i.uniforms.color._location,e.color);r.uniform1f(i.uniforms.alpha._location,t.worldAlpha);r.bindBuffer(r.ARRAY_BUFFER,e.buffer);r.vertexAttribPointer(i.attributes.aVertexPosition,2,r.FLOAT,false,4*2,0);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer)}else{i=this.renderer.shaderManager.primitiveShader;this.renderer.shaderManager.setShader(i);r.uniformMatrix3fv(i.uniforms.translationMatrix._location,false,t.worldTransform.toArray(true));r.uniformMatrix3fv(i.uniforms.projectionMatrix._location,false,this.renderer.currentRenderTarget.projectionMatrix.toArray(true));r.uniform3fv(i.uniforms.tint._location,n.hex2rgb(t.tint));r.uniform1f(i.uniforms.alpha._location,t.worldAlpha);r.bindBuffer(r.ARRAY_BUFFER,e.buffer);r.vertexAttribPointer(i.attributes.aVertexPosition,2,r.FLOAT,false,4*6,0);r.vertexAttribPointer(i.attributes.aColor,4,r.FLOAT,false,4*6,2*4);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer)}};o.prototype.popStencil=function(t,e){var r=this.renderer.gl,i=this.stencilMaskStack;i.stencilStack.pop();i.count--;if(i.stencilStack.length===0){r.disable(r.STENCIL_TEST)}else{var n=i.count;this.bindGraphics(t,e,this.renderer);r.colorMask(false,false,false,false);if(e.mode===1){i.reverse=!i.reverse;if(i.reverse){r.stencilFunc(r.EQUAL,255-(n+1),255);r.stencilOp(r.KEEP,r.KEEP,r.INCR)}else{r.stencilFunc(r.EQUAL,n+1,255);r.stencilOp(r.KEEP,r.KEEP,r.DECR)}r.drawElements(r.TRIANGLE_FAN,4,r.UNSIGNED_SHORT,(e.indices.length-4)*2);r.stencilFunc(r.ALWAYS,0,255);r.stencilOp(r.KEEP,r.KEEP,r.INVERT);r.drawElements(r.TRIANGLE_FAN,e.indices.length-4,r.UNSIGNED_SHORT,0);if(!i.reverse){r.stencilFunc(r.EQUAL,255-n,255)}else{r.stencilFunc(r.EQUAL,n,255)}}else{if(!i.reverse){r.stencilFunc(r.EQUAL,255-(n+1),255);r.stencilOp(r.KEEP,r.KEEP,r.INCR)}else{r.stencilFunc(r.EQUAL,n+1,255);r.stencilOp(r.KEEP,r.KEEP,r.DECR)}r.drawElements(r.TRIANGLE_STRIP,e.indices.length,r.UNSIGNED_SHORT,0);if(!i.reverse){r.stencilFunc(r.EQUAL,255-n,255)}else{r.stencilFunc(r.EQUAL,n,255)}}r.colorMask(true,true,true,true);r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}};o.prototype.destroy=function(){i.prototype.destroy.call(this);this.stencilMaskStack.stencilStack=null};o.prototype.pushMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);if(t.dirty){this.renderer.plugins.graphics.updateGraphics(t,this.renderer.gl)}if(!t._webGL[this.renderer.gl.id].data.length){return}this.pushStencil(t,t._webGL[this.renderer.gl.id].data[0],this.renderer)};o.prototype.popMask=function(t){this.renderer.setObjectRenderer(this.renderer.plugins.graphics);this.popStencil(t,t._webGL[this.renderer.gl.id].data[0],this.renderer)}},{"../../../utils":125,"./WebGLManager":105}],105:[function(t,e,r){function i(t){this.renderer=t;var e=this;this.renderer.on("context",this._onContextChangeFn=function(){e.onContextChange()})}i.prototype.constructor=i;e.exports=i;i.prototype.onContextChange=function(){};i.prototype.destroy=function(){this.renderer.off("context",this._onContextChangeFn);this.renderer=null}},{}],106:[function(t,e,r){var i=t("./Shader");function n(t){i.call(this,t,["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{
tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},color:{type:"3f",value:[0,0,0]},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n},{"./Shader":108}],107:[function(t,e,r){var i=t("./Shader");function n(t){i.call(this,t,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aColor:0})}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n},{"./Shader":108}],108:[function(t,e,r){var i=t("../../../utils"),n=t("../../../const");function o(t,e,r,n,o){if(!e||!r){throw new Error("Pixi.js Error. Shader requires vertexSrc and fragmentSrc")}this.uuid=i.uuid();this.gl=t.renderer.gl;this.shaderManager=t;this.program=null;this.uniforms=n||{};this.attributes=o||{};this.textureCount=1;this.vertexSrc=e;this.fragmentSrc=r;this.init()}o.prototype.constructor=o;e.exports=o;o.prototype.init=function(){this.compile();this.gl.useProgram(this.program);this.cacheUniformLocations(Object.keys(this.uniforms));this.cacheAttributeLocations(Object.keys(this.attributes))};o.prototype.cacheUniformLocations=function(t){for(var e=0;e<t.length;++e){this.uniforms[t[e]]._location=this.gl.getUniformLocation(this.program,t[e])}};o.prototype.cacheAttributeLocations=function(t){for(var e=0;e<t.length;++e){this.attributes[t[e]]=this.gl.getAttribLocation(this.program,t[e])}};o.prototype.compile=function(){var t=this.gl;var e=this._glCompile(t.VERTEX_SHADER,this.vertexSrc);var r=this._glCompile(t.FRAGMENT_SHADER,this.fragmentSrc);var i=t.createProgram();t.attachShader(i,e);t.attachShader(i,r);t.linkProgram(i);if(!t.getProgramParameter(i,t.LINK_STATUS)){console.error("Pixi.js Error: Could not initialize shader.");console.error("gl.VALIDATE_STATUS",t.getProgramParameter(i,t.VALIDATE_STATUS));console.error("gl.getError()",t.getError());if(t.getProgramInfoLog(i)!==""){console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(i))}t.deleteProgram(i);i=null}t.deleteShader(e);t.deleteShader(r);return this.program=i};o.prototype.syncUniform=function(t){var e=t._location,r=t.value,n=this.gl,o,s;switch(t.type){case"i":case"1i":n.uniform1i(e,r);break;case"f":case"1f":n.uniform1f(e,r);break;case"2f":n.uniform2f(e,r[0],r[1]);break;case"3f":n.uniform3f(e,r[0],r[1],r[2]);break;case"4f":n.uniform4f(e,r[0],r[1],r[2],r[3]);break;case"v2":n.uniform2f(e,r.x,r.y);break;case"v3":n.uniform3f(e,r.x,r.y,r.z);break;case"v4":n.uniform4f(e,r.x,r.y,r.z,r.w);break;case"1iv":n.uniform1iv(e,r);break;case"2iv":n.uniform2iv(e,r);break;case"3iv":n.uniform3iv(e,r);break;case"4iv":n.uniform4iv(e,r);break;case"1fv":n.uniform1fv(e,r);break;case"2fv":n.uniform2fv(e,r);break;case"3fv":n.uniform3fv(e,r);break;case"4fv":n.uniform4fv(e,r);break;case"m2":case"mat2":case"Matrix2fv":n.uniformMatrix2fv(e,t.transpose,r);break;case"m3":case"mat3":case"Matrix3fv":n.uniformMatrix3fv(e,t.transpose,r);break;case"m4":case"mat4":case"Matrix4fv":n.uniformMatrix4fv(e,t.transpose,r);break;case"c":if(typeof r==="number"){r=i.hex2rgb(r)}n.uniform3f(e,r[0],r[1],r[2]);break;case"iv1":n.uniform1iv(e,r);break;case"iv":n.uniform3iv(e,r);break;case"fv1":n.uniform1fv(e,r);break;case"fv":n.uniform3fv(e,r);break;case"v2v":if(!t._array){t._array=new Float32Array(2*r.length)}for(o=0,s=r.length;o<s;++o){t._array[o*2]=r[o].x;t._array[o*2+1]=r[o].y}n.uniform2fv(e,t._array);break;case"v3v":if(!t._array){t._array=new Float32Array(3*r.length)}for(o=0,s=r.length;o<s;++o){t._array[o*3]=r[o].x;t._array[o*3+1]=r[o].y;t._array[o*3+2]=r[o].z}n.uniform3fv(e,t._array);break;case"v4v":if(!t._array){t._array=new Float32Array(4*r.length)}for(o=0,s=r.length;o<s;++o){t._array[o*4]=r[o].x;t._array[o*4+1]=r[o].y;t._array[o*4+2]=r[o].z;t._array[o*4+3]=r[o].w}n.uniform4fv(e,t._array);break;case"t":case"sampler2D":if(!t.value||!t.value.baseTexture.hasLoaded){break}n.activeTexture(n["TEXTURE"+this.textureCount]);var a=t.value.baseTexture._glTextures[n.id];if(!a){this.initSampler2D(t)}n.bindTexture(n.TEXTURE_2D,a);n.uniform1i(t._location,this.textureCount);this.textureCount++;break;default:window.console.warn("Pixi.js Shader Warning: Unknown uniform type: "+t.type)}};o.prototype.syncUniforms=function(){this.textureCount=1;for(var t in this.uniforms){this.syncUniform(this.uniforms[t])}};o.prototype.initSampler2D=function(t){var e=this.gl;var r=t.value.baseTexture;if(!r.hasLoaded){return}if(t.textureData){var i=t.textureData;r._glTextures[e.id]=e.createTexture();e.bindTexture(e.TEXTURE_2D,r._glTextures[e.id]);e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultipliedAlpha);e.texImage2D(e.TEXTURE_2D,0,i.luminance?e.LUMINANCE:e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r.source);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,i.magFilter?i.magFilter:e.LINEAR);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,i.wrapS?i.wrapS:e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,i.wrapS?i.wrapS:e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,i.wrapT?i.wrapT:e.CLAMP_TO_EDGE)}else{this.shaderManager.renderer.updateTexture(r)}};o.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.gl=null;this.uniforms=null;this.attributes=null;this.vertexSrc=null;this.fragmentSrc=null};o.prototype._glCompile=function(t,e){var r=this.gl.createShader(t);this.gl.shaderSource(r,e);this.gl.compileShader(r);if(!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)){window.console.log(this.gl.getShaderInfoLog(r));return null}return r}},{"../../../const":70,"../../../utils":125}],109:[function(t,e,r){var i=t("./Shader");function n(t,e,r,o,s){var a={uSampler:{type:"sampler2D",value:0},projectionMatrix:{type:"mat3",value:new Float32Array(1,0,0,0,1,0,0,0,1)}};if(o){for(var l in o){a[l]=o[l]}}var h={aVertexPosition:0,aTextureCoord:0,aColor:0};if(s){for(var u in s){h[u]=s[u]}}e=e||n.defaultVertexSrc;r=r||n.defaultFragmentSrc;i.call(this,t,e,r,a,h)}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n;n.defaultVertexSrc=["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n");n.defaultFragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n")},{"./Shader":108}],110:[function(t,e,r){var i=t("../managers/WebGLManager");function n(t){i.call(this,t)}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.start=function(){};n.prototype.stop=function(){this.flush()};n.prototype.flush=function(){};n.prototype.render=function(t){}},{"../managers/WebGLManager":105}],111:[function(t,e,r){function i(t){this.gl=t;this.vertices=new Float32Array([0,0,200,0,200,200,0,200]);this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);this.indices=new Uint16Array([0,1,2,0,3,2]);this.vertexBuffer=t.createBuffer();this.indexBuffer=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);t.bufferData(t.ARRAY_BUFFER,(8+8+16)*4,t.DYNAMIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW);this.upload()}i.prototype.constructor=i;i.prototype.map=function(t,e){var r=0;var i=0;this.uvs[0]=r;this.uvs[1]=i;this.uvs[2]=r+e.width/t.width;this.uvs[3]=i;this.uvs[4]=r+e.width/t.width;this.uvs[5]=i+e.height/t.height;this.uvs[6]=r;this.uvs[7]=i+e.height/t.height;r=e.x;i=e.y;this.vertices[0]=r;this.vertices[1]=i;this.vertices[2]=r+e.width;this.vertices[3]=i;this.vertices[4]=r+e.width;this.vertices[5]=i+e.height;this.vertices[6]=r;this.vertices[7]=i+e.height;this.upload()};i.prototype.upload=function(){var t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices);t.bufferSubData(t.ARRAY_BUFFER,8*4,this.uvs);t.bufferSubData(t.ARRAY_BUFFER,(8+8)*4,this.colors)};e.exports=i},{}],112:[function(t,e,r){var i=t("../../../math"),n=t("../../../utils"),o=t("../../../const"),s=t("./StencilMaskStack");var a=function(t,e,r,a,l,h){this.gl=t;this.frameBuffer=null;this.texture=null;this.size=new i.Rectangle(0,0,1,1);this.resolution=l||o.RESOLUTION;this.projectionMatrix=new i.Matrix;this.transform=null;this.frame=null;this.stencilBuffer=null;this.stencilMaskStack=new s;this.filterStack=[{renderTarget:this,filter:[],bounds:this.size}];this.scaleMode=a||o.SCALE_MODES.DEFAULT;this.root=h;if(!this.root){this.frameBuffer=t.createFramebuffer();this.texture=t.createTexture();t.bindTexture(t.TEXTURE_2D,this.texture);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,a===o.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,a===o.SCALE_MODES.LINEAR?t.LINEAR:t.NEAREST);var u=n.isPowerOfTwo(e,r);if(!u){t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}else{t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT)}t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0)}this.resize(e,r)};a.prototype.constructor=a;e.exports=a;a.prototype.clear=function(t){var e=this.gl;if(t){e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer)}e.clearColor(0,0,0,0);e.clear(e.COLOR_BUFFER_BIT)};a.prototype.attachStencilBuffer=function(){if(this.stencilBuffer){return}if(!this.root){var t=this.gl;this.stencilBuffer=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,this.stencilBuffer);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,this.stencilBuffer);t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,this.size.width*this.resolution,this.size.height*this.resolution)}};a.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.frameBuffer);var e=this.frame||this.size;this.calculateProjection(e);if(this.transform){this.projectionMatrix.append(this.transform)}t.viewport(0,0,e.width*this.resolution,e.height*this.resolution)};a.prototype.calculateProjection=function(t){var e=this.projectionMatrix;e.identity();if(!this.root){e.a=1/t.width*2;e.d=1/t.height*2;e.tx=-1-t.x*e.a;e.ty=-1-t.y*e.d}else{e.a=1/t.width*2;e.d=-1/t.height*2;e.tx=-1-t.x*e.a;e.ty=1-t.y*e.d}};a.prototype.resize=function(t,e){t=t|0;e=e|0;if(this.size.width===t&&this.size.height===e){return}this.size.width=t;this.size.height=e;if(!this.root){var r=this.gl;r.bindTexture(r.TEXTURE_2D,this.texture);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t*this.resolution,e*this.resolution,0,r.RGBA,r.UNSIGNED_BYTE,null);if(this.stencilBuffer){r.bindRenderbuffer(r.RENDERBUFFER,this.stencilBuffer);r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,t*this.resolution,e*this.resolution)}}var i=this.frame||this.size;this.calculateProjection(i)};a.prototype.destroy=function(){var t=this.gl;t.deleteFramebuffer(this.frameBuffer);t.deleteTexture(this.texture);this.frameBuffer=null;this.texture=null}},{"../../../const":70,"../../../math":80,"../../../utils":125,"./StencilMaskStack":113}],113:[function(t,e,r){function i(){this.stencilStack=[];this.reverse=true;this.count=0}i.prototype.constructor=i;e.exports=i},{}],114:[function(t,e,r){var i=t("../math"),n=t("../textures/Texture"),o=t("../display/Container"),s=t("../renderers/canvas/utils/CanvasTinter"),a=t("../utils"),l=t("../const"),h=new i.Point;function u(t){o.call(this);this.anchor=new i.Point;this._texture=null;this._width=0;this._height=0;this.tint=16777215;this.blendMode=l.BLEND_MODES.NORMAL;this.shader=null;this.cachedTint=16777215;this.texture=t||n.EMPTY}u.prototype.destroy=function(t,e){o.prototype.destroy.call(this);this.anchor=null;if(t){this._texture.destroy(e)}this._texture=null;this.shader=null};u.prototype=Object.create(o.prototype);u.prototype.constructor=u;e.exports=u;Object.defineProperties(u.prototype,{width:{get:function(){return this.scale.x*this.texture._frame.width},set:function(t){this.scale.x=t/this.texture._frame.width;this._width=t}},height:{get:function(){return this.scale.y*this.texture._frame.height},set:function(t){this.scale.y=t/this.texture._frame.height;this._height=t}},texture:{get:function(){return this._texture},set:function(t){if(this._texture===t){return}this._texture=t;this.cachedTint=16777215;if(t){if(t.baseTexture.hasLoaded){this._onTextureUpdate()}else{t.once("update",this._onTextureUpdate.bind(this))}}}}});u.prototype._onTextureUpdate=function(){if(this._width){this.scale.x=this._width/this.texture.frame.width}if(this._height){this.scale.y=this._height/this.texture.frame.height}};u.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.sprite);t.plugins.sprite.render(this)};u.prototype.getBounds=function(t){if(!this._currentBounds){var e=this._texture._frame.width;var r=this._texture._frame.height;var i=e*(1-this.anchor.x);var n=e*-this.anchor.x;var o=r*(1-this.anchor.y);var s=r*-this.anchor.y;var a=t||this.worldTransform;var l=a.a;var h=a.b;var u=a.c;var c=a.d;var f=a.tx;var d=a.ty;var p,v,g,m;if(h===0&&u===0){if(l<0){l*=-1}if(c<0){c*=-1}p=l*n+f;v=l*i+f;g=c*s+d;m=c*o+d}else{var y=l*n+u*s+f;var x=c*s+h*n+d;var _=l*i+u*s+f;var b=c*s+h*i+d;var T=l*i+u*o+f;var w=c*o+h*i+d;var E=l*n+u*o+f;var S=c*o+h*n+d;p=y;p=_<p?_:p;p=T<p?T:p;p=E<p?E:p;g=x;g=b<g?b:g;g=w<g?w:g;g=S<g?S:g;v=y;v=_>v?_:v;v=T>v?T:v;v=E>v?E:v;m=x;m=b>m?b:m;m=w>m?w:m;m=S>m?S:m}var C=this._bounds;C.x=p;C.width=v-p;C.y=g;C.height=m-g;this._currentBounds=C}return this._currentBounds};u.prototype.getLocalBounds=function(){this._bounds.x=-this._texture._frame.width*this.anchor.x;this._bounds.y=-this._texture._frame.height*this.anchor.y;this._bounds.width=this._texture._frame.width;this._bounds.height=this._texture._frame.height;return this._bounds};u.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,h);var e=this._texture._frame.width;var r=this._texture._frame.height;var i=-e*this.anchor.x;var n;if(h.x>i&&h.x<i+e){n=-r*this.anchor.y;if(h.y>n&&h.y<n+r){return true}}return false};u.prototype._renderCanvas=function(t){if(this.texture.crop.width<=0||this.texture.crop.height<=0){return}if(this.blendMode!==t.currentBlendMode){t.currentBlendMode=this.blendMode;t.context.globalCompositeOperation=t.blendModes[t.currentBlendMode]}if(this.texture.valid){var e=this._texture,r=this.worldTransform,i,n,o,a;var h=e.baseTexture.resolution/t.resolution;t.context.globalAlpha=this.worldAlpha;if(t.smoothProperty&&t.currentScaleMode!==e.baseTexture.scaleMode){t.currentScaleMode=e.baseTexture.scaleMode;t.context[t.smoothProperty]=t.currentScaleMode===l.SCALE_MODES.LINEAR}if(e.rotate){var u=r.a;var c=r.b;r.a=-r.c;r.b=-r.d;r.c=u;r.d=c;o=e.crop.height;a=e.crop.width;i=e.trim?e.trim.y-this.anchor.y*e.trim.height:this.anchor.y*-e._frame.height;n=e.trim?e.trim.x-this.anchor.x*e.trim.width:this.anchor.x*-e._frame.width}else{o=e.crop.width;a=e.crop.height;i=e.trim?e.trim.x-this.anchor.x*e.trim.width:this.anchor.x*-e._frame.width;n=e.trim?e.trim.y-this.anchor.y*e.trim.height:this.anchor.y*-e._frame.height}if(t.roundPixels){t.context.setTransform(r.a,r.b,r.c,r.d,r.tx*t.resolution|0,r.ty*t.resolution|0);i=i|0;n=n|0}else{t.context.setTransform(r.a,r.b,r.c,r.d,r.tx*t.resolution,r.ty*t.resolution)}if(this.tint!==16777215){if(this.cachedTint!==this.tint){this.cachedTint=this.tint;this.tintedTexture=s.getTintedTexture(this,this.tint)}t.context.drawImage(this.tintedTexture,0,0,o,a,i/h,n/h,o/h,o/h)}else{t.context.drawImage(e.baseTexture.source,e.crop.x,e.crop.y,o,a,i/h,n/h,o/h,a/h)}}};u.fromFrame=function(t){var e=a.TextureCache[t];if(!e){throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this)}return new u(e)};u.fromImage=function(t,e,r){return new u(n.fromImage(t,e,r))}},{"../const":70,"../display/Container":71,"../math":80,"../renderers/canvas/utils/CanvasTinter":95,"../textures/Texture":118,"../utils":125}],115:[function(t,e,r){var i=t("../../renderers/webgl/utils/ObjectRenderer"),n=t("../../renderers/webgl/shaders/Shader"),o=t("../../renderers/webgl/WebGLRenderer"),s=t("../../const");function a(t){i.call(this,t);this.vertSize=5;this.vertByteSize=this.vertSize*4;this.size=s.SPRITE_BATCH_SIZE;var e=this.size*4*this.vertByteSize;var r=this.size*6;this.vertices=new ArrayBuffer(e);this.positions=new Float32Array(this.vertices);this.colors=new Uint32Array(this.vertices);this.indices=new Uint16Array(r);this.lastIndexCount=0;for(var n=0,o=0;n<r;n+=6,o+=4){this.indices[n+0]=o+0;this.indices[n+1]=o+1;this.indices[n+2]=o+2;this.indices[n+3]=o+0;this.indices[n+4]=o+2;this.indices[n+5]=o+3}this.drawing=false;this.currentBatchSize=0;this.currentBaseTexture=null;this.textures=[];this.blendModes=[];this.shaders=[];this.sprites=[];this.shader=null}a.prototype=Object.create(i.prototype);a.prototype.constructor=a;e.exports=a;o.registerPlugin("sprite",a);a.prototype.onContextChange=function(){var t=this.renderer.gl;this.shader=this.renderer.shaderManager.defaultShader;this.vertexBuffer=t.createBuffer();this.indexBuffer=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW);this.currentBlendMode=99999};a.prototype.render=function(t){var e=t._texture;if(this.currentBatchSize>=this.size){this.flush();this.currentBaseTexture=e.baseTexture}var r=e._uvs;if(!r){return}var i=t.anchor.x;var n=t.anchor.y;var o,s,a,l;if(e.trim){var h=e.trim;s=h.x-i*h.width;o=s+e.crop.width;l=h.y-n*h.height;a=l+e.crop.height}else{o=e._frame.width*(1-i);s=e._frame.width*-i;a=e._frame.height*(1-n);l=e._frame.height*-n}var u=this.currentBatchSize*this.vertByteSize;var c=t.worldTransform;var f=c.a;var d=c.b;var p=c.c;var v=c.d;var g=c.tx;var m=c.ty;var y=this.colors;var x=this.positions;if(this.renderer.roundPixels){x[u]=f*s+p*l+g|0;x[u+1]=v*l+d*s+m|0;x[u+5]=f*o+p*l+g|0;x[u+6]=v*l+d*o+m|0;x[u+10]=f*o+p*a+g|0;x[u+11]=v*a+d*o+m|0;x[u+15]=f*s+p*a+g|0;x[u+16]=v*a+d*s+m|0}else{x[u]=f*s+p*l+g;x[u+1]=v*l+d*s+m;x[u+5]=f*o+p*l+g;x[u+6]=v*l+d*o+m;x[u+10]=f*o+p*a+g;x[u+11]=v*a+d*o+m;x[u+15]=f*s+p*a+g;x[u+16]=v*a+d*s+m}x[u+2]=r.x0;x[u+3]=r.y0;x[u+7]=r.x1;x[u+8]=r.y1;x[u+12]=r.x2;x[u+13]=r.y2;x[u+17]=r.x3;x[u+18]=r.y3;var _=t.tint;y[u+4]=y[u+9]=y[u+14]=y[u+19]=(_>>16)+(_&65280)+((_&255)<<16)+(t.worldAlpha*255<<24);this.sprites[this.currentBatchSize++]=t};a.prototype.flush=function(){if(this.currentBatchSize===0){return}var t=this.renderer.gl;var e;if(this.currentBatchSize>this.size*.5){t.bufferSubData(t.ARRAY_BUFFER,0,this.vertices)}else{var r=this.positions.subarray(0,this.currentBatchSize*this.vertByteSize);t.bufferSubData(t.ARRAY_BUFFER,0,r)}var i,n,o;var s=0;var a=0;var l=null;var h=this.renderer.blendModeManager.currentBlendMode;var u=null;var c=false;var f=false;var d;for(var p=0,v=this.currentBatchSize;p<v;p++){d=this.sprites[p];i=d._texture.baseTexture;n=d.blendMode;o=d.shader||this.shader;c=h!==n;f=u!==o;if(l!==i||c||f){this.renderBatch(l,s,a);a=p;s=0;l=i;if(c){h=n;this.renderer.blendModeManager.setBlendMode(h)}if(f){u=o;e=u.shaders?u.shaders[t.id]:u;if(!e){e=u.getShader(this.renderer)}this.renderer.shaderManager.setShader(e);e.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(true);e.syncUniforms();t.activeTexture(t.TEXTURE0)}}s++}this.renderBatch(l,s,a);this.currentBatchSize=0};a.prototype.renderBatch=function(t,e,r){if(e===0){return}var i=this.renderer.gl;if(!t._glTextures[i.id]){this.renderer.updateTexture(t)}else{i.bindTexture(i.TEXTURE_2D,t._glTextures[i.id])}i.drawElements(i.TRIANGLES,e*6,i.UNSIGNED_SHORT,r*6*2);this.renderer.drawCount++};a.prototype.start=function(){var t=this.renderer.gl;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var e=this.vertByteSize;t.vertexAttribPointer(this.shader.attributes.aVertexPosition,2,t.FLOAT,false,e,0);t.vertexAttribPointer(this.shader.attributes.aTextureCoord,2,t.FLOAT,false,e,2*4);t.vertexAttribPointer(this.shader.attributes.aColor,4,t.UNSIGNED_BYTE,true,e,4*4)};a.prototype.destroy=function(){this.renderer.gl.deleteBuffer(this.vertexBuffer);this.renderer.gl.deleteBuffer(this.indexBuffer);this.shader.destroy();this.renderer=null;this.vertices=null;this.positions=null;this.colors=null;this.indices=null;this.vertexBuffer=null;this.indexBuffer=null;this.currentBaseTexture=null;this.drawing=false;this.textures=null;this.blendModes=null;this.shaders=null;this.sprites=null;this.shader=null}},{"../../const":70,"../../renderers/webgl/WebGLRenderer":96,"../../renderers/webgl/shaders/Shader":108,"../../renderers/webgl/utils/ObjectRenderer":110}],116:[function(t,e,r){var i=t("../utils"),n=t("../const");function o(t,e,r){this.uuid=i.uuid();this.resolution=r||1;this.width=100;this.height=100;this.realWidth=100;this.realHeight=100;this.scaleMode=e||n.SCALE_MODES.DEFAULT;this.hasLoaded=false;this.isLoading=false;this.source=null;this.premultipliedAlpha=true;this.imageUrl=null;this.isPowerOfTwo=false;this.mipmap=false;this._glTextures=[];if(t){this.loadSource(t)}}o.prototype.constructor=o;e.exports=o;i.eventTarget.mixin(o.prototype);o.prototype.update=function(){this.emit("update",this)};o.prototype.loadSource=function(t){var e=this.isLoading;this.hasLoaded=false;this.isLoading=false;if(e&&this.source){this.source.onload=null;this.source.onerror=null}this.source=t;if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height){this._sourceLoaded()}else if(!t.getContext){this.isLoading=true;var r=this;t.onload=function(){t.onload=null;t.onerror=null;if(!r.isLoading){return}r.isLoading=false;r._sourceLoaded();r.emit("loaded",r)};t.onerror=function(){t.onload=null;t.onerror=null;if(!r.isLoading){return}r.isLoading=false;r.emit("error",r)};if(t.complete&&t.src){this.isLoading=false;t.onload=null;t.onerror=null;if(t.width&&t.height){this._sourceLoaded();if(e){this.emit("loaded",this)}}else{if(e){this.emit("error",this)}}}}};o.prototype._sourceLoaded=function(){this.hasLoaded=true;this.realWidth=this.source.naturalWidth||this.source.width;this.realHeight=this.source.naturalHeight||this.source.height;this.width=this.realWidth/this.resolution;this.height=this.realHeight/this.resolution;this.isPowerOfTwo=i.isPowerOfTwo(this.width,this.height);this.update()};o.prototype.destroy=function(){if(this.imageUrl){delete i.BaseTextureCache[this.imageUrl];delete i.TextureCache[this.imageUrl];this.imageUrl=null;if(!navigator.isCocoonJS){this.source.src=""}}else if(this.source&&this.source._pixiId){delete i.BaseTextureCache[this.source._pixiId]}this.source=null;this.dispose()};o.prototype.dispose=function(){this.emit("dispose",this)};o.prototype.updateSourceImage=function(t){this.source.src=t;this.loadSource(this.source)};o.fromImage=function(t,e,r){var n=i.BaseTextureCache[t];if(e===undefined&&t.indexOf("data:")!==0){e=true}if(!n){var s=new Image;if(e){s.crossOrigin=""}n=new o(s,r);n.imageUrl=t;s.src=t;i.BaseTextureCache[t]=n;n.resolution=i.getResolutionOfUrl(t)}return n};o.fromCanvas=function(t,e){if(!t._pixiId){t._pixiId="canvas_"+i.uuid()}var r=i.BaseTextureCache[t._pixiId];if(!r){r=new o(t,e);i.BaseTextureCache[t._pixiId]=r}return r}},{"../const":70,"../utils":125}],117:[function(t,e,r){var i=t("./BaseTexture"),n=t("./Texture"),o=t("../renderers/webgl/utils/RenderTarget"),s=t("../renderers/webgl/managers/FilterManager"),a=t("../renderers/canvas/utils/CanvasBuffer"),l=t("../math"),h=t("../const"),u=new l.Matrix;function c(t,e,r,u,c){if(!t){throw new Error("Unable to create RenderTexture, you must pass a renderer into the constructor.")}e=e||100;r=r||100;c=c||h.RESOLUTION;var f=new i;f.width=e;f.height=r;f.resolution=c;f.scaleMode=u||h.SCALE_MODES.DEFAULT;f.hasLoaded=true;n.call(this,f,new l.Rectangle(0,0,e,r));this.width=e;this.height=r;this.resolution=c;this.render=null;this.renderer=t;if(this.renderer.type===h.RENDERER_TYPE.WEBGL){var d=this.renderer.gl;this.textureBuffer=new o(d,this.width,this.height,null,this.resolution);this.baseTexture._glTextures[d.id]=this.textureBuffer.texture;this.filterManager=new s(this.renderer);this.filterManager.onContextChange();this.filterManager.resize(e,r);this.render=this.renderWebGL;this.renderer.currentRenderer.start()}else{this.render=this.renderCanvas;this.textureBuffer=new a(this.width*this.resolution,this.height*this.resolution);this.baseTexture.source=this.textureBuffer.canvas}this.valid=true;this._updateUvs()}c.prototype=Object.create(n.prototype);c.prototype.constructor=c;e.exports=c;c.prototype.resize=function(t,e,r){if(t===this.width&&e===this.height){return}this.valid=t>0&&e>0;this.width=this._frame.width=this.crop.width=t;this.height=this._frame.height=this.crop.height=e;if(r){this.baseTexture.width=this.width;this.baseTexture.height=this.height}if(this.renderer.type===h.RENDERER_TYPE.WEBGL){this.projection.x=this.width/2;this.projection.y=-this.height/2}if(!this.valid){return}this.textureBuffer.resize(this.width*this.resolution,this.height*this.resolution);if(this.filterManager){this.filterManager.resize(this.width,this.height)}};c.prototype.clear=function(){if(!this.valid){return}if(this.renderer.type===h.RENDERER_TYPE.WEBGL){this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer)}this.textureBuffer.clear()};c.prototype.renderWebGL=function(t,e,r,i){if(!this.valid){return}i=!!i;this.textureBuffer.transform=e;t.worldAlpha=t.alpha;if(i){t.worldTransform.identity();t.currentBounds=null;var n=t.children;var o,s;for(o=0,s=n.length;o<s;++o){n[o].updateTransform()}}if(r){this.textureBuffer.clear()}var a=this.renderer.filterManager;this.renderer.filterManager=this.filterManager;this.renderer.renderDisplayObject(t,this.textureBuffer);this.renderer.filterManager=a};c.prototype.renderCanvas=function(t,e,r,i){if(!this.valid){return}i=!!i;var n=t.worldTransform;var o=u;o.identity();if(e){o.append(e)}t.worldTransform=o;t.worldAlpha=1;var s=t.children;var a,l;for(a=0,l=s.length;a<l;++a){s[a].updateTransform()}if(r){this.textureBuffer.clear()}t.worldTransform=n;var h=this.textureBuffer.context;var c=this.renderer.resolution;this.renderer.resolution=this.resolution;this.renderer.renderDisplayObject(t,h);this.renderer.resolution=c};c.prototype.destroy=function(){n.prototype.destroy.call(this,true);this.textureBuffer.destroy();if(this.filterManager){this.filterManager.destroy()}this.renderer=null};c.prototype.getImage=function(){var t=new Image;t.src=this.getBase64();return t};c.prototype.getBase64=function(){return this.getCanvas().toDataURL()};c.prototype.getCanvas=function(){if(this.renderer.type===h.RENDERER_TYPE.WEBGL){var t=this.renderer.gl;var e=this.textureBuffer.width;var r=this.textureBuffer.height;var i=new Uint8Array(4*e*r);t.bindFramebuffer(t.FRAMEBUFFER,this.textureBuffer.frameBuffer);t.readPixels(0,0,e,r,t.RGBA,t.UNSIGNED_BYTE,i);t.bindFramebuffer(t.FRAMEBUFFER,null);var n=new a(e,r);var o=n.context.getImageData(0,0,e,r);o.data.set(i);n.context.putImageData(o,0,0);return n.canvas}else{return this.textureBuffer.canvas}}},{"../const":70,"../math":80,"../renderers/canvas/utils/CanvasBuffer":92,"../renderers/webgl/managers/FilterManager":101,"../renderers/webgl/utils/RenderTarget":112,"./BaseTexture":116,"./Texture":118}],118:[function(t,e,r){var i=t("./BaseTexture"),n=t("./VideoBaseTexture"),o=t("./TextureUvs"),s=t("../utils/eventTarget"),a=t("../math"),l=t("../utils");function h(t,e,r,i,n){this.noFrame=false;if(!e){this.noFrame=true;e=new a.Rectangle(0,0,1,1)}if(t instanceof h){t=t.baseTexture}this.baseTexture=t;this._frame=e;this.trim=i;this.valid=false;this.requiresUpdate=false;this._uvs=null;this.width=0;this.height=0;this.crop=r||e;this.rotate=!!n;if(t.hasLoaded){if(this.noFrame){e=new a.Rectangle(0,0,t.width,t.height)}this.frame=e}else{t.addEventListener("loaded",this.onBaseTextureLoaded.bind(this))}}h.prototype.constructor=h;e.exports=h;s.mixin(h.prototype);Object.defineProperties(h.prototype,{frame:{get:function(){return this._frame},set:function(t){this._frame=t;this.noFrame=false;this.width=t.width;this.height=t.height;if(!this.trim&&!this.rotate&&(t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)){throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this)}this.valid=t&&t.width&&t.height&&this.baseTexture.hasLoaded;if(this.trim){this.width=this.trim.width;this.height=this.trim.height;this._frame.width=this.trim.width;this._frame.height=this.trim.height}else{this.crop=t}if(this.valid){this._updateUvs()}}}});h.prototype.update=function(){this.baseTexture.update()};h.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded);if(this.noFrame){this.frame=new a.Rectangle(0,0,t.width,t.height)}else{this.frame=this._frame}this.emit("update",this)};h.prototype.destroy=function(t){if(t){this.baseTexture.destroy()}this.valid=false};h.prototype.clone=function(){return new h(this.baseTexture,this.frame,this.crop,this.trim,this.rotate)};h.prototype._updateUvs=function(){if(!this._uvs){this._uvs=new o}this._uvs.set(this.crop,this.baseTexture,this.rotate)};h.fromImage=function(t,e,r){var n=l.TextureCache[t];if(!n){n=new h(i.fromImage(t,e,r));l.TextureCache[t]=n}return n};h.fromFrame=function(t){var e=l.TextureCache[t];if(!e){throw new Error('The frameId "'+t+'" does not exist in the texture cache')}return e};h.fromCanvas=function(t,e){return new h(i.fromCanvas(t,e))};h.fromVideo=function(t,e){return new h(n.baseTextureFromVideo(t,e))};h.fromVideoUrl=function(t,e){return new h(n.fromUrl(t,e))};h.addTextureToCache=function(t,e){l.TextureCache[e]=t};h.removeTextureFromCache=function(t){var e=l.TextureCache[t];delete l.TextureCache[t];delete l.BaseTextureCache[t];return e};h.emptyTexture=new h(new i)},{"../math":80,"../utils":125,"../utils/eventTarget":124,"./BaseTexture":116,"./TextureUvs":119,"./VideoBaseTexture":120}],119:[function(t,e,r){function i(){this.x0=0;this.y0=0;this.x1=0;this.y1=0;this.x2=0;this.y2=0;this.x3=0;this.y3=0}e.exports=i;i.prototype.set=function(t,e,r){var i=e.width;var n=e.height;if(r){this.x0=(t.x+t.height)/i;this.y0=t.y/n;this.x1=(t.x+t.height)/i;this.y1=(t.y+t.width)/n;this.x2=t.x/i;this.y2=(t.y+t.width)/n;this.x3=t.x/i;this.y3=t.y/n}else{this.x0=t.x/i;this.y0=t.y/n;this.x1=(t.x+t.width)/i;this.y1=t.y/n;this.x2=(t.x+t.width)/i;this.y2=(t.y+t.height)/n;this.x3=t.x/i;this.y3=(t.y+t.height)/n}}},{}],120:[function(t,e,r){var i=t("./BaseTexture"),n=t("../utils");function o(t,e){if(!t){throw new Error("No video source element specified.")}if((t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height){t.complete=true}i.call(this,t,e);this.autoUpdate=false;this._onUpdate=this._onUpdate.bind(this);this._onCanPlay=this._onCanPlay.bind(this);if(!t.complete){t.addEventListener("canplay",this._onCanPlay);t.addEventListener("canplaythrough",this._onCanPlay);t.addEventListener("play",this._onPlayStart.bind(this));t.addEventListener("pause",this._onPlayStop.bind(this));

}this.__loaded=false}o.prototype=Object.create(i.prototype);o.prototype.constructor=o;e.exports=o;o.prototype._onUpdate=function(){if(this.autoUpdate){window.requestAnimationFrame(this._onUpdate);this.update()}};o.prototype._onPlayStart=function(){if(!this.autoUpdate){window.requestAnimationFrame(this._onUpdate);this.autoUpdate=true}};o.prototype._onPlayStop=function(){this.autoUpdate=false};o.prototype._onCanPlay=function(){this.hasLoaded=true;if(this.source){this.source.removeEventListener("canplay",this._onCanPlay);this.source.removeEventListener("canplaythrough",this._onCanPlay);this.width=this.source.videoWidth;this.height=this.source.videoHeight;this.source.play();if(!this.__loaded){this.__loaded=true;this.emit("loaded",this)}}};o.prototype.destroy=function(){if(this.source&&this.source._pixiId){n.BaseTextureCache[this.source._pixiId]=null;delete n.BaseTextureCache[this.source._pixiId];this.source._pixiId=null;delete this.source._pixiId}i.prototype.destroy.call(this)};o.fromVideo=function(t,e){if(!t._pixiId){t._pixiId="video_"+n.uuid()}var r=n.BaseTextureCache[t._pixiId];if(!r){r=new o(t,e);n.BaseTextureCache[t._pixiId]=r}return r};o.fromUrl=function(t,e){var r=document.createElement("video");if(Array.isArray(t)){for(var i=0;i<t.length;++i){r.appendChild(s(t.src||t,t.mime))}}else{r.appendChild(s(t.src||t,t.mime))}r.load();r.play();return o.fromVideo(r,e)};o.fromUrls=o.fromUrl;function s(t,e){if(!e){e="video/"+t.substr(t.lastIndexOf(".")+1)}var r=document.createElement("source");r.src=t;r.type=e;return r}},{"../utils":125,"./BaseTexture":116}],121:[function(t,e,r){function i(t,e,r){this.__isEventObject=true;this.stopped=false;this.stoppedImmediate=false;this.target=t;this.type=e;this.data=r;this.timeStamp=Date.now()}i.prototype.constructor=i;e.exports=i;i.prototype.stopPropagation=function n(){this.stopped=true};i.prototype.stopImmediatePropagation=function o(){this.stoppedImmediate=true}},{}],122:[function(t,e,r){var i=e.exports={};i.Triangulate=function(t){var e=true;var r=t.length>>1;if(r<3)return[];var n=[];var o=[];for(var s=0;s<r;s++)o.push(s);s=0;var a=r;while(a>3){var l=o[(s+0)%a];var h=o[(s+1)%a];var u=o[(s+2)%a];var c=t[2*l],f=t[2*l+1];var d=t[2*h],p=t[2*h+1];var v=t[2*u],g=t[2*u+1];var m=false;if(i._convex(c,f,d,p,v,g,e)){m=true;for(var y=0;y<a;y++){var x=o[y];if(x===l||x===h||x===u)continue;if(i._PointInTriangle(t[2*x],t[2*x+1],c,f,d,p,v,g)){m=false;break}}}if(m){n.push(l,h,u);o.splice((s+1)%a,1);a--;s=0}else if(s++>3*a){if(e){n=[];o=[];for(s=0;s<r;s++)o.push(s);s=0;a=r;e=false}else{return null}}}n.push(o[0],o[1],o[2]);return n};i._PointInTriangle=function(t,e,r,i,n,o,s,a){var l=s-r;var h=a-i;var u=n-r;var c=o-i;var f=t-r;var d=e-i;var p=l*l+h*h;var v=l*u+h*c;var g=l*f+h*d;var m=u*u+c*c;var y=u*f+c*d;var x=1/(p*m-v*v);var _=(m*g-v*y)*x;var b=(p*y-v*g)*x;return _>=0&&b>=0&&_+b<1};i._convex=function(t,e,r,i,n,o,s){return(e-i)*(n-r)+(r-t)*(o-i)>=0===s}},{}],123:[function(t,e,r){var i=t("./eventTarget"),n=t("./EventData");var o=function(){this.updateBind=this.update.bind(this);this.active=false;this.eventData=new n(this,"tick",{deltaTime:1});this.deltaTime=1;this.timeElapsed=0;this.lastTime=0;this.speed=1;this.start()};i.mixin(o.prototype);o.prototype.start=function(){if(this.active){return}this.active=true;requestAnimationFrame(this.updateBind)};o.prototype.stop=function(){if(!this.active){return}this.active=false};o.prototype.update=function(){if(this.active){requestAnimationFrame(this.updateBind);var t=(new Date).getTime();var e=t-this.lastTime;if(e>100){e=100}this.deltaTime=e*.06;this.deltaTime*=this.speed;this.eventData.data.deltaTime=this.deltaTime;this.emit("tick",this.eventData);this.lastTime=t}};e.exports=new o},{"./EventData":121,"./eventTarget":124}],124:[function(t,e,r){var i=t("./EventData");var n=new i(null,null,{});function o(t){t.listeners=function e(t){this._listeners=this._listeners||{};return this._listeners[t]?this._listeners[t].slice():[]};t.emit=t.dispatchEvent=function r(t,e){this._listeners=this._listeners||{};if(!this._listeners[t]){return}if(!e||!e.__isEventObject){n.target=this;n.type=t;n.data=e;e=n}var r=this._listeners[t].slice(0),i=r.length,o=r[0],s;for(s=0;s<i;o=r[++s]){o(e);if(e.stoppedImmediate){return this}}if(e.stopped){return this}return this};t.on=t.addEventListener=function i(t,e){this._listeners=this._listeners||{};(this._listeners[t]=this._listeners[t]||[]).push(e);return this};t.once=function o(t,e){this._listeners=this._listeners||{};var r=this;function i(){e.apply(r.off(t,i),arguments)}i._originalHandler=e;return this.on(t,i)};t.off=t.removeEventListener=function s(t,e){this._listeners=this._listeners||{};if(!this._listeners[t]){return this}var r=this._listeners[t],i=e?r.length:0;while(i-->0){if(r[i]===e||r[i]._originalHandler===e){r.splice(i,1)}}if(r.length===0){this._listeners[t]=null}return this};t.removeAllListeners=function a(t){this._listeners=this._listeners||{};if(!this._listeners[t]){return this}this._listeners[t]=null;return this}}e.exports={mixin:function s(t){o(t)}}},{"./EventData":121}],125:[function(t,e,r){var i=t("../const");var n=e.exports={_uid:0,_saidHello:false,RAFramePolyfill:t("./requestAnimationFramePolyfill"),Ticker:t("./Ticker"),EventData:t("./EventData"),eventTarget:t("./eventTarget"),pluginTarget:t("./pluginTarget"),PolyK:t("./PolyK"),uuid:function(){return++n._uid},hex2rgb:function(t,e){e=e||[];e[0]=(t>>16&255)/255;e[1]=(t>>8&255)/255;e[2]=(t&255)/255;return e},hex2string:function(t){t=t.toString(16);t="000000".substr(0,6-t.length)+t;return"#"+t},rgb2hex:function(t){return(t[0]*255<<16)+(t[1]*255<<8)+t[2]*255},canUseNewCanvasBlendModes:function(){if(typeof document==="undefined"){return false}var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/";var e="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==";var r=new Image;r.src=t+"AP804Oa6"+e;var i=new Image;i.src=t+"/wCKxvRF"+e;var n=document.createElement("canvas");n.width=6;n.height=1;var o=n.getContext("2d");o.globalCompositeOperation="multiply";o.drawImage(r,0,0);o.drawImage(i,2,0);var s=o.getImageData(2,0,1,1).data;return s[0]===255&&s[1]===0&&s[2]===0},getNextPowerOfTwo:function(t){if(t>0&&(t&t-1)===0){return t}else{var e=1;while(e<t){e<<=1}return e}},isPowerOfTwo:function(t,e){return t>0&&(t&t-1)===0&&e>0&&(e&e-1)===0},getResolutionOfUrl:function(t){var e=i.RETINA_PREFIX.exec(t);if(e){return parseFloat(e[1])}return 1},sayHello:function(t){if(n._saidHello){return}if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var e=["%c %c %c Pixi.js "+i.VERSION+" - "+t+"  %c "+" %c "+" http://www.pixijs.com/  %c %c %c%c ","background: #ff66a5","background: #ff66a5","color: #ff66a5; background: #030307;","background: #ff66a5","background: #ffc3dc","background: #ff66a5","color: #ff2424; background: #fff","color: #ff2424; background: #fff","color: #ff2424; background: #fff"];window.console.log.apply(console,e)}else if(window.console){window.console.log("Pixi.js "+i.VERSION+" - "+t+" - http://www.pixijs.com/")}n._saidHello=true},TextureCache:{},BaseTextureCache:{}}},{"../const":70,"./EventData":121,"./PolyK":122,"./Ticker":123,"./eventTarget":124,"./pluginTarget":126,"./requestAnimationFramePolyfill":127}],126:[function(t,e,r){function i(t){t.__plugins={};t.registerPlugin=function(e,r){t.__plugins[e]=r};t.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var e in t.__plugins){this.plugins[e]=new t.__plugins[e](this)}};t.prototype.destroyPlugins=function(){for(var t in this.plugins){this.plugins[t].destroy();this.plugins[t]=null}this.plugins=null}}e.exports={mixin:function n(t){i(t)}}},{}],127:[function(t,e,r){(function(t){var e=0;var r=["ms","moz","webkit","o"];for(var i=0;i<r.length&&!t.requestAnimationFrame;++i){t.requestAnimationFrame=t[r[i]+"RequestAnimationFrame"];t.cancelAnimationFrame=t[r[i]+"CancelAnimationFrame"]||t[r[i]+"CancelRequestAnimationFrame"]}if(!t.requestAnimationFrame){t.requestAnimationFrame=function(r){var i=(new Date).getTime();var n=Math.max(0,16-(i-e));var o=t.setTimeout(function(){r(i+n)},n);e=i+n;return o}}if(!t.cancelAnimationFrame){t.cancelAnimationFrame=function(t){clearTimeout(t)}}})(window)},{}],128:[function(t,e,r){var i=t("./core"),n=t("./extras"),o=t("./text");i.Stage=function(){window.console.warn("You do not need to use a PIXI Stage any more, you can simply render any container.");return new i.Container};i.SpriteBatch=function(){window.console.warn("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")};i.AssetLoader=function(){window.console.warn("The loader system was overhauled in pixi v3, please see the new PIXI.Loader class.")};i.DisplayObjectContainer=function(){window.console.warn("DisplayObjectContainer has been shortened to Container, please use Container from now on");return new i.Container};i.Strip=function(t){window.console.warn("The Strip class has been renamed to Mesh, please use Mesh from now on");return new n.mesh.Mesh(t)};i.Sprite.prototype.setTexture=function(t){this.texture=t;window.console.warn("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")};o.BitmapText.prototype.setText=function(t){this.text=t;window.console.warn("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")};o.Text.prototype.setText=function(t){this.text=t;window.console.warn("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")};e.exports={}},{"./core":77,"./extras":133,"./text":183}],129:[function(t,e,r){var i=t("../core"),n=t("../core/utils");function o(t){i.Sprite.call(this,t[0]);this._textures=t;this.animationSpeed=1;this.loop=true;this.onComplete=null;this.currentFrame=0;this.playing=false;this._updateBound=this.update.bind(this)}o.prototype=Object.create(i.Sprite.prototype);o.prototype.constructor=o;e.exports=o;Object.defineProperties(o.prototype,{totalFrames:{get:function(){return this._textures.length}},textures:{get:function(){return this._textures},set:function(t){this._textures=t;this.texture=this._textures[Math.floor(this.currentFrame)%this._textures.length]}}});o.prototype.stop=function(){if(!this.playing){return}this.playing=false;n.Ticker.off("tick",this._updateBound)};o.prototype.play=function(){if(this.playing){return}this.playing=true;n.Ticker.on("tick",this._updateBound)};o.prototype.gotoAndStop=function(t){this.stop();this.currentFrame=t;var e=Math.floor(this.currentFrame);this.texture=this._textures[e%this._textures.length]};o.prototype.gotoAndPlay=function(t){this.currentFrame=t;this.play()};o.prototype.update=function(t){this.currentFrame+=this.animationSpeed*t.data.deltaTime;var e=Math.floor(this.currentFrame);if(e<0){if(this.loop){this.currentFrame+=this._textures.length;this.texture=this._textures[this.currentFrame]}else{this.gotoAndStop(0);if(this.onComplete){this.onComplete()}}}else if(this.loop||e<this._textures.length){this.texture=this._textures[e%this._textures.length]}else if(e>=this._textures.length){this.gotoAndStop(this.textures.length-1);if(this.onComplete){this.onComplete()}}};o.prototype.destroy=function(){this.stop();i.Sprite.prototype.destroy.call(this)};o.fromFrames=function(t){var e=[];for(var r=0;r<t.length;++r){e.push(new i.Texture.fromFrame(t[r]))}return new o(e)};o.fromImages=function(t){var e=[];for(var r=0;r<t.length;++r){e.push(new i.Texture.fromImage(t[r]))}return new o(e)}},{"../core":77,"../core/utils":125}],130:[function(t,e,r){var i=t("../core"),n=t("../core/textures/TextureUvs"),o=t("../core/textures/RenderTexture"),s=new i.Sprite,a=new i.math.Point;function l(t,e,r){i.Sprite.call(this,t);this.tileScale=new i.math.Point(1,1);this.tilePosition=new i.math.Point(0,0);this._width=e||100;this._height=r||100;this._tileScaleOffset=new i.math.Point(1,1);this._tilingTexture=null;this._refreshTexture=false;this._uvs=new n}l.prototype=Object.create(i.Sprite.prototype);l.prototype.constructor=l;e.exports=l;Object.defineProperties(l.prototype,{width:{get:function(){return this._width},set:function(t){this._width=t}},height:{get:function(){return this._height},set:function(t){this._height=t}}});l.prototype._onTextureUpdate=function(){return};l.prototype._renderWebGL=function(t){if(!this._tilingTexture||this._refreshTexture){this.generateTilingTexture(t,this.texture,true)}var e=this._tilingTexture;if(!e){return}var r=this._uvs;this.tilePosition.x%=e.baseTexture.width/this._tileScaleOffset.x;this.tilePosition.y%=e.baseTexture.height/this._tileScaleOffset.y;var i=this.tilePosition.x/(e.baseTexture.width/this._tileScaleOffset.x);var n=this.tilePosition.y/(e.baseTexture.height/this._tileScaleOffset.y);var o=this._width/e.baseTexture.width*this._tileScaleOffset.x;var s=this._height/e.baseTexture.height*this._tileScaleOffset.y;o/=this.tileScale.x;s/=this.tileScale.y;r.x0=0-i;r.y0=0-n;r.x1=1*o-i;r.y1=0-n;r.x2=1*o-i;r.y2=1*s-n;r.x3=0-i;r.y3=1*s-n;var a=e._uvs;var l=e._frame.width;var h=e._frame.height;e._uvs=r;e._frame.width=this.width;e._frame.height=this.height;t.setObjectRenderer(t.plugins.sprite);t.plugins.sprite.render(this);e._uvs=a;e._frame.width=l;e._frame.height=h};l.prototype._renderCanvas=function(t){var e=t.context;e.globalAlpha=this.worldAlpha;var r=this.worldTransform;var i=t.resolution;e.setTransform(r.a*i,r.b*i,r.c*i,r.d*i,r.tx*i,r.ty*i);if(!this.__tilePattern||this._refreshTexture){this.generateTilingTexture(false);if(this._tilingTexture){this.__tilePattern=e.createPattern(this._tilingTexture.baseTexture.source,"repeat")}else{return}}if(this.blendMode!==t.currentBlendMode){t.currentBlendMode=this.blendMode;e.globalCompositeOperation=t.blendModes[t.currentBlendMode]}var n=this.tilePosition;var o=this.tileScale;n.x%=this._tilingTexture.baseTexture.width;n.y%=this._tilingTexture.baseTexture.height;e.scale(o.x,o.y);e.translate(n.x+this.anchor.x*-this._width,n.y+this.anchor.y*-this._height);e.fillStyle=this.__tilePattern;e.fillRect(-n.x,-n.y,this._width/o.x,this._height/o.y);e.translate(-n.x+this.anchor.x*this._width,-n.y+this.anchor.y*this._height);e.scale(1/o.x,1/o.y)};l.prototype.getBounds=function(){var t=this._width;var e=this._height;var r=t*(1-this.anchor.x);var i=t*-this.anchor.x;var n=e*(1-this.anchor.y);var o=e*-this.anchor.y;var s=this.worldTransform;var a=s.a;var l=s.b;var h=s.c;var u=s.d;var c=s.tx;var f=s.ty;var d=a*i+h*o+c;var p=u*o+l*i+f;var v=a*r+h*o+c;var g=u*o+l*r+f;var m=a*r+h*n+c;var y=u*n+l*r+f;var x=a*i+h*n+c;var _=u*n+l*i+f;var b,T,w,E;b=d;b=v<b?v:b;b=m<b?m:b;b=x<b?x:b;w=p;w=g<w?g:w;w=y<w?y:w;w=_<w?_:w;T=d;T=v>T?v:T;T=m>T?m:T;T=x>T?x:T;E=p;E=g>E?g:E;E=y>E?y:E;E=_>E?_:E;var S=this._bounds;S.x=b;S.width=T-b;S.y=w;S.height=E-w;this._currentBounds=S;return S};l.prototype.onTextureUpdate=function(){};l.prototype.generateTilingTexture=function(t,e,r){if(!this.texture.baseTexture.hasLoaded){return}e=this.originalTexture||this._texture;var n=e.frame;var a,l;var h=n.width!==e.baseTexture.width||n.height!==e.baseTexture.height;if(r&&!e.baseTexture.isPowerOfTwo||h){a=i.utils.getNextPowerOfTwo(n.width);l=i.utils.getNextPowerOfTwo(n.height);s.texture=e;var u=new o(t,a,l,e.baseTexture.scaleMode,e.baseTexture.resolution);s.worldTransform.a=(a+1)/n.width;s.worldTransform.d=(l+1)/n.height;s.worldTransform.tx-=.5;s.worldTransform.ty-=.5;var c=t.currentRenderTarget;u.render(s,s.worldTransform,true,false);t.setRenderTarget(c);this._tileScaleOffset.x=a/n.width;this._tileScaleOffset.y=l/n.height;this._tilingTexture=u}else{if(this._tilingTexture&&this._tilingTexture.isTiling){this._tilingTexture.destroy(true)}this._tileScaleOffset.x=1;this._tileScaleOffset.y=1;this._tilingTexture=e}this._refreshTexture=false;this.originalTexture=this.texture;this._texture=this._tilingTexture};l.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,a);var e=this._width;var r=this._height;var i=-e*this.anchor.x;var n;if(a.x>i&&a.x<i+e){n=-r*this.anchor.y;if(a.y>n&&a.y<n+r){return true}}return false};l.prototype.destroy=function(){i.Sprite.prototype.destroy.call(this);this.tileScale=null;this._tileScaleOffset=null;this.tilePosition=null;this._tilingTexture.destroy(true);this._tilingTexture=null;this._uvs=null};l.fromFrame=function(t,e,r){var n=i.utils.TextureCache[t];if(!n){throw new Error('The frameId "'+t+'" does not exist in the texture cache '+this)}return new l(n,e,r)};l.fromImage=function(t,e,r,n,o){return new l(i.Texture.fromImage(t,n,o),e,r)}},{"../core":77,"../core/textures/RenderTexture":117,"../core/textures/TextureUvs":119}],131:[function(t,e,r){var i=t("../core/math"),n=t("../core/textures/RenderTexture"),o=t("../core/display/DisplayObject"),s=t("../core/sprites/Sprite"),a=new i.Matrix;o.prototype._cacheAsBitmap=false;o.prototype._originalRenderWebGL=null;o.prototype._originalRenderCanvas=null;o.prototype._originalUpdateTransform=null;o.prototype._originalHitTest=null;o.prototype._cachedSprite=null;Object.defineProperties(o.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){if(this._cacheAsBitmap===t){return}this._cacheAsBitmap=t;if(t){this._originalRenderWebGL=this.renderWebGL;this._originalRenderCanvas=this.renderCanvas;this._originalUpdateTransform=this.updateTransform;this._originalGetBounds=this.getBounds;this._originalContainesPoint=this.containsPoint;this.renderWebGL=this._renderCachedWebGL;this.renderCanvas=this._renderCachedCanvas}else{if(this._cachedSprite){this._destroyCachedDisplayObject()}this.renderWebGL=this._originalRenderWebGL;this.renderCanvas=this._originalRenderCanvas;this.getBounds=this._originalGetBounds;this.updateTransform=this._originalUpdateTransform;this.containsPoint=this._originalContainsPoint}}}});o.prototype._renderCachedWebGL=function(t){this._initCachedDisplayObject(t);this._cachedSprite.worldAlpha=this.worldAlpha;t.setObjectRenderer(t.plugins.sprite);t.plugins.sprite.render(this._cachedSprite)};o.prototype._initCachedDisplayObject=function(t){if(this._cachedSprite){return}t.currentRenderer.flush();var e=this.getLocalBounds().clone();if(this._filters){var r=this._filters[0].padding;e.x-=r;e.y-=r;e.width+=r*2;e.height+=r*2}var i=t.currentRenderTarget;var o=t.filterManager.filterStack;var l=new n(t,e.width|0,e.height|0);var h=a;h.tx=-e.x;h.ty=-e.y;this.renderWebGL=this._originalRenderWebGL;l.render(this,h,true);t.setRenderTarget(i);t.filterManager.filterStack=o;this.renderWebGL=this._renderCachedWebGL;this.updateTransform=this.displayObjectUpdateTransform;this.getBounds=this._getCachedBounds;this._cachedSprite=new s(l);this._cachedSprite.worldTransform=this.worldTransform;this._cachedSprite.anchor.x=-(e.x/e.width);this._cachedSprite.anchor.y=-(e.y/e.height);this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)};o.prototype._renderCachedCanvas=function(t){this._initCachedDisplayObjectCanvas(t);this._cachedSprite.worldAlpha=this.worldAlpha;this._cachedSprite.renderCanvas(t)};o.prototype._initCachedDisplayObjectCanvas=function(t){if(this._cachedSprite){return}var e=this.getLocalBounds();var r=t.context;var i=new n(t,e.width|0,e.height|0);var o=a;o.tx=-e.x;o.ty=-e.y;this.renderCanvas=this._originalRenderCanvas;i.render(this,o,true);t.context=r;this.renderCanvas=this._renderCachedCanvas;this.updateTransform=this.displayObjectUpdateTransform;this.getBounds=this._getCachedBounds;this._cachedSprite=new s(i);this._cachedSprite.worldTransform=this.worldTransform;this._cachedSprite.anchor.x=-(e.x/e.width);this._cachedSprite.anchor.y=-(e.y/e.height);this.hitTest=this._cachedSprite.hitTest.bind(this._cachedSprite)};o.prototype._getCachedBounds=function(){this._cachedSprite._currentBounds=null;return this._cachedSprite.getBounds()};o.prototype._destroyCachedDisplayObject=function(){this._cachedSprite._texture.destroy();this._cachedSprite=null};e.exports={}},{"../core/display/DisplayObject":72,"../core/math":80,"../core/sprites/Sprite":114,"../core/textures/RenderTexture":117}],132:[function(t,e,r){var i=t("../core/display/DisplayObject"),n=t("../core/display/Container");i.prototype.name=null;n.prototype.getChildByName=function(t){for(var e=0;e<this.children.length;e++){if(this.children[e].name===t){return this.children[e]}}return null};e.exports={}},{"../core/display/Container":71,"../core/display/DisplayObject":72}],133:[function(t,e,r){e.exports={MovieClip:t("./MovieClip"),TilingSprite:t("./TilingSprite"),mesh:t("./mesh/index"),cacheAsBitmap:t("./cacheAsBitmap"),getChildByName:t("./getChildByName")}},{"./MovieClip":129,"./TilingSprite":130,"./cacheAsBitmap":131,"./getChildByName":132,"./mesh/index":136}],134:[function(t,e,r){var i=t("../../core");function n(t,e,r,o,s){i.Container.call(this);this.texture=t;this.uvs=r||new Float32Array([0,1,1,1,1,0,0,1]);this.vertices=e||new Float32Array([0,0,100,0,100,100,0,100]);this.indices=o||new Uint16Array([0,1,2,3]);this.dirty=true;this.blendMode=i.CONST.BLEND_MODES.NORMAL;this.canvasPadding=0;this.drawMode=s||n.DRAW_MODES.TRIANGLE_MESH}n.prototype=Object.create(i.Container.prototype);n.prototype.constructor=n;e.exports=n;n.prototype._renderWebGL=function(t){t.setObjectRenderer(t.plugins.mesh);t.plugins.mesh.render(this)};n.prototype._renderCanvas=function(t){var e=t.context;var r=this.worldTransform;if(t.roundPixels){e.setTransform(r.a,r.b,r.c,r.d,r.tx|0,r.ty|0)}else{e.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty)}if(this.drawMode===n.DRAW_MODES.TRIANGLE_MESH){this._renderCanvasTriangleMesh(e)}else{this._renderCanvasTriangles(e)}};n.prototype._renderCanvasTriangleMesh=function(t){var e=this.vertices;var r=this.uvs;var i=e.length/2;for(var n=0;n<i-2;n++){var o=n*2;this._renderCanvasDrawTriangle(t,e,r,o,o+2,o+4)}};n.prototype._renderCanvasTriangles=function(t){var e=this.vertices;var r=this.uvs;var i=this.indices;var n=i.length;for(var o=0;o<n;o+=3){var s=i[o]*2,a=i[o+1]*2,l=i[o+2]*2;this._renderCanvasDrawTriangle(t,e,r,s,a,l)}};n.prototype._renderCanvasDrawTriangle=function(t,e,r,i,n,o){var s=this.texture.baseTexture.source;var a=this.texture.width;var l=this.texture.height;var h=e[i],u=e[n],c=e[o];var f=e[i+1],d=e[n+1],p=e[o+1];var v=r[i]*a,g=r[n]*a,m=r[o]*a;var y=r[i+1]*l,x=r[n+1]*l,_=r[o+1]*l;if(this.canvasPadding>0){var b=this.canvasPadding/this.worldTransform.a;var T=this.canvasPadding/this.worldTransform.d;var w=(h+u+c)/3;var E=(f+d+p)/3;var S=h-w;var C=f-E;var A=Math.sqrt(S*S+C*C);h=w+S/A*(A+b);f=E+C/A*(A+T);S=u-w;C=d-E;A=Math.sqrt(S*S+C*C);u=w+S/A*(A+b);d=E+C/A*(A+T);S=c-w;C=p-E;A=Math.sqrt(S*S+C*C);c=w+S/A*(A+b);p=E+C/A*(A+T)}t.save();t.beginPath();t.moveTo(h,f);t.lineTo(u,d);t.lineTo(c,p);t.closePath();t.clip();var R=v*x+y*m+g*_-x*m-y*g-v*_;var M=h*x+y*c+u*_-x*c-y*u-h*_;var O=v*u+h*m+g*c-u*m-h*g-v*c;var D=v*x*c+y*u*m+h*g*_-h*x*m-y*g*c-v*u*_;var F=f*x+y*p+d*_-x*p-y*d-f*_;var P=v*d+f*m+g*p-d*m-f*g-v*p;var B=v*x*p+y*d*m+f*g*_-f*x*m-y*g*p-v*d*_;t.transform(M/R,F/R,O/R,P/R,D/R,B/R);t.drawImage(s,0,0);t.restore()};n.prototype.renderMeshFlat=function(t){var e=this.context;var r=t.vertices;var i=r.length/2;e.beginPath();for(var n=1;n<i-2;n++){var o=n*2;var s=r[o],a=r[o+2],l=r[o+4];var h=r[o+1],u=r[o+3],c=r[o+5];e.moveTo(s,h);e.lineTo(a,u);e.lineTo(l,c)}e.fillStyle="#FF0000";e.fill();e.closePath()};n.prototype.onTextureUpdate=function(){this.updateFrame=true};n.prototype.getBounds=function(t){var e=t||this.worldTransform;var r=e.a;var n=e.b;var o=e.c;var s=e.d;var a=e.tx;var l=e.ty;var h=-Infinity;var u=-Infinity;var c=Infinity;var f=Infinity;var d=this.vertices;for(var p=0,v=d.length;p<v;p+=2){var g=d[p],m=d[p+1];var y=r*g+o*m+a;var x=s*m+n*g+l;c=y<c?y:c;f=x<f?x:f;h=y>h?y:h;u=x>u?x:u}if(c===-Infinity||u===Infinity){return i.math.Rectangle.EMPTY}var _=this._bounds;_.x=c;_.width=h-c;_.y=f;_.height=u-f;this._currentBounds=_;return _};n.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../../core":77}],135:[function(t,e,r){var i=t("./Mesh");function n(t,e){i.call(this,t);this.points=e;this.vertices=new Float32Array(e.length*4);this.uvs=new Float32Array(e.length*4);this.colors=new Float32Array(e.length*2);this.indices=new Uint16Array(e.length*2);this.refresh()}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.refresh=function(){var t=this.points;if(t.length<1){return}var e=this.uvs;var r=this.indices;var i=this.colors;e[0]=0;e[1]=0;e[2]=0;e[3]=1;i[0]=1;i[1]=1;r[0]=0;r[1]=1;var n=t.length,o,s,a;for(var l=1;l<n;l++){o=t[l];s=l*4;a=l/(n-1);if(l%2){e[s]=a;e[s+1]=0;e[s+2]=a;e[s+3]=1}else{e[s]=a;e[s+1]=0;e[s+2]=a;e[s+3]=1}s=l*2;i[s]=1;i[s+1]=1;s=l*2;r[s]=s;r[s+1]=s+1}};n.prototype.updateTransform=function(){var t=this.points;if(t.length<1){return}var e=t[0];var r;var i=0;var n=0;var o=this.vertices;var s=t.length,a,l,h,u,c;for(var f=0;f<s;f++){a=t[f];l=f*4;if(f<t.length-1){r=t[f+1]}else{r=a}n=-(r.x-e.x);i=r.y-e.y;h=(1-f/(s-1))*10;if(h>1){h=1}u=Math.sqrt(i*i+n*n);c=this.texture.height/2;i/=u;n/=u;i*=c;n*=c;o[l]=a.x+i;o[l+1]=a.y+n;o[l+2]=a.x-i;o[l+3]=a.y-n;e=a}this.containerUpdateTransform()}},{"./Mesh":134}],136:[function(t,e,r){e.exports={Mesh:t("./Mesh"),Rope:t("./Rope"),MeshRenderer:t("./webgl/MeshRenderer"),MeshShader:t("./webgl/MeshShader")}},{"./Mesh":134,"./Rope":135,"./webgl/MeshRenderer":137,"./webgl/MeshShader":138}],137:[function(t,e,r){var i=t("../../../core/renderers/webgl/utils/ObjectRenderer"),n=t("../../../core/renderers/webgl/WebGLRenderer");function o(t){i.call(this,t);this.indices=new Uint16Array(15e3);for(var e=0,r=0;e<15e3;e+=6,r+=4){this.indices[e+0]=r+0;this.indices[e+1]=r+1;this.indices[e+2]=r+2;this.indices[e+3]=r+0;this.indices[e+4]=r+2;this.indices[e+5]=r+3}}o.prototype=Object.create(i.prototype);o.prototype.constructor=o;e.exports=o;n.registerPlugin("mesh",o);o.prototype.onContextChange=function(){};o.prototype.render=function(t){if(!t._vertexBuffer){this._initWebGL(t)}var e=this.renderer,r=e.gl,i=t.texture.baseTexture,n=e.shaderManager.plugins.meshShader;var o=r.TRIANGLE_STRIP;e.blendModeManager.setBlendMode(t.blendMode);r.uniformMatrix3fv(n.uniforms.translationMatrix._location,false,t.worldTransform.toArray(true));r.uniformMatrix3fv(n.uniforms.projectionMatrix._location,false,e.currentRenderTarget.projectionMatrix.toArray(true));r.uniform1f(n.uniforms.alpha._location,t.worldAlpha);if(!t.dirty){r.bindBuffer(r.ARRAY_BUFFER,t._vertexBuffer);r.bufferSubData(r.ARRAY_BUFFER,0,t.vertices);r.vertexAttribPointer(n.attributes.aVertexPosition,2,r.FLOAT,false,0,0);r.bindBuffer(r.ARRAY_BUFFER,t._uvBuffer);r.vertexAttribPointer(n.attributes.aTextureCoord,2,r.FLOAT,false,0,0);r.activeTexture(r.TEXTURE0);if(!i._glTextures[r.id]){this.renderer.updateTexture(i)}else{r.bindTexture(r.TEXTURE_2D,i._glTextures[r.id])}}else{t.dirty=false;r.bindBuffer(r.ARRAY_BUFFER,t._vertexBuffer);r.bufferData(r.ARRAY_BUFFER,t.vertices,r.STATIC_DRAW);r.vertexAttribPointer(n.attributes.aVertexPosition,2,r.FLOAT,false,0,0);r.bindBuffer(r.ARRAY_BUFFER,t._uvBuffer);r.bufferData(r.ARRAY_BUFFER,t.uvs,r.STATIC_DRAW);r.vertexAttribPointer(n.attributes.aTextureCoord,2,r.FLOAT,false,0,0);r.activeTexture(r.TEXTURE0);if(!i._glTextures[r.id]){this.renderer.updateTexture(i)}else{r.bindTexture(r.TEXTURE_2D,i._glTextures[r.id])}r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t._indexBuffer);r.bufferData(r.ELEMENT_ARRAY_BUFFER,t.indices,r.STATIC_DRAW)}r.drawElements(o,t.indices.length,r.UNSIGNED_SHORT,0)};o.prototype._initWebGL=function(t){var e=this.renderer.gl;t._vertexBuffer=e.createBuffer();t._indexBuffer=e.createBuffer();t._uvBuffer=e.createBuffer();t._colorBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer);e.bufferData(e.ARRAY_BUFFER,t.vertices,e.DYNAMIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer);e.bufferData(e.ARRAY_BUFFER,t.uvs,e.STATIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer);e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW)};o.prototype.flush=function(){};o.prototype.start=function(){var t=this.renderer.gl,e=this.renderer.shaderManager.plugins.meshShader;this.renderer.shaderManager.setShader(e)};o.prototype.destroy=function(){}},{"../../../core/renderers/webgl/WebGLRenderer":96,"../../../core/renderers/webgl/utils/ObjectRenderer":110}],138:[function(t,e,r){var i=t("../../../core");function n(t){i.Shader.call(this,t,["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * alpha ;","}"].join("\n"),{alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aTextureCoord:0})}n.prototype=Object.create(i.Shader.prototype);n.prototype.constructor=n;e.exports=n;i.ShaderManager.registerPlugin("meshShader",n)},{"../../../core":77}],139:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nuniform vec4 dimensions;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n    if (clamp(p.x, 0.0, 4.0) == p.x && clamp(p.y, 0.0, 4.0) == p.y)\n    {\n        if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 uv = gl_FragCoord.xy;\n\n    vec3 col = texture2D(uSampler, floor( uv / pixelSize ) * pixelSize / dimensions.xy).rgb;\n\n    float gray = (col.r + col.g + col.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    vec2 p = mod( uv / ( pixelSize * 0.5 ), 2.0) - vec2(1.0);\n    col = col * character(n, p);\n\n    gl_FragColor = vec4(col, 1.0);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"1f",value:8}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.uniforms.pixelSize.value=t}}})},{"../../core":77}],140:[function(t,e,r){var i=t("../../core"),n=t("../blur/BlurXFilter"),o=t("../blur/BlurYFilter");function s(){i.AbstractFilter.call(this);this.blurXFilter=new n;this.blurYFilter=new o;this.defaultFilter=new i.AbstractFilter}s.prototype=Object.create(i.AbstractFilter.prototype);s.prototype.constructor=s;e.exports=s;s.prototype.applyFilter=function(t,e,r){var n=t.filterManager.getRenderTarget(true);this.defaultFilter.applyFilter(t,e,r);this.blurXFilter.applyFilter(t,e,n);t.blendModeManager.setBlendMode(i.CONST.BLEND_MODES.SCREEN);this.blurYFilter.applyFilter(t,n,r);t.blendModeManager.setBlendMode(i.CONST.BLEND_MODES.NORMAL);t.filterManager.returnRenderTarget(n)};Object.defineProperties(s.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}})},{"../../core":77,"../blur/BlurXFilter":142,"../blur/BlurYFilter":143}],141:[function(t,e,r){var i=t("../../core"),n=t("./BlurXFilter"),o=t("./BlurYFilter");function s(){i.AbstractFilter.call(this);this.blurXFilter=new n;this.blurYFilter=new o}s.prototype=Object.create(i.AbstractFilter.prototype);s.prototype.constructor=s;e.exports=s;s.prototype.applyFilter=function(t,e,r){var i=t.filterManager.getRenderTarget(true);this.blurXFilter.applyFilter(t,e,i);this.blurYFilter.applyFilter(t,i,r);

t.filterManager.returnRenderTarget(i)};Object.defineProperties(s.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.padding=t*1.5;this.blurXFilter.blur=this.blurYFilter.blur=t}},passes:{get:function(){return this.blurXFilter.passes},set:function(t){this.blurXFilter.passes=this.blurYFilter.passes=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t}}})},{"../../core":77,"./BlurXFilter":142,"./BlurYFilter":143}],142:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(-0.012 * strength, 0.0);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(-0.008 * strength, 0.0);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(-0.004 * strength, 0.0);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2( 0.004 * strength, 0.0);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2( 0.008 * strength, 0.0);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2( 0.012 * strength, 0.0);\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}});this.passes=1;this.strength=4}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.applyFilter=function(t,e,r,i){var n=this.getShader(t);this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.width/e.size.width);if(this.passes===1){t.filterManager.applyFilter(n,e,r,i)}else{var o=t.filterManager.getRenderTarget(true);var s=e;var a=o;for(var l=0;l<this.passes-1;l++){t.filterManager.applyFilter(n,s,a,i);var h=a;a=s;s=h}t.filterManager.applyFilter(n,s,r,i);t.filterManager.returnRenderTarget(o)}};Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=t;this.strength=t}}})},{"../../core":77}],143:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}});this.passes=1;this.strength=4}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.applyFilter=function(t,e,r,i){var n=this.getShader(t);this.uniforms.strength.value=this.strength/4/this.passes*(e.frame.height/e.size.height);if(this.passes===1){t.filterManager.applyFilter(n,e,r,i)}else{var o=t.filterManager.getRenderTarget(true);var s=e;var a=o;for(var l=0;l<this.passes-1;l++){t.filterManager.applyFilter(n,s,a,i);var h=a;a=s;s=h}t.filterManager.applyFilter(n,s,r,i);t.filterManager.returnRenderTarget(o)}};Object.defineProperties(n.prototype,{blur:{get:function(){return this.strength},set:function(t){this.padding=t;this.strength=t}}})},{"../../core":77}],144:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nconst vec2 delta = vec2(1.0/10.0, 0.0);\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta * percent);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n")}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n},{"../../core":77}],145:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float m[24];\n\nuniform vec4 d;\n\nvoid main(void)\n{\n    \n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n	gl_FragColor.r = m[0] * c.r + m[1] * c.g + m[2] * c.b + m[3] * c.a + m[4];\n	gl_FragColor.g = m[5] * c.r + m[6] * c.g + m[7] * c.b + m[8] * c.a + m[9];\n	gl_FragColor.b = m[10] * c.r + m[11] * c.g + m[12] * c.b + m[13] * c.a + m[14];\n	gl_FragColor.a = c.a;\n}\n",{m:{type:"1fv",value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;n.prototype._loadMatrix=function(t,e){e=!!e;var r=t;if(e){this._multiply(r,this.uniforms.m.value,t);r=this._colorMatrix(r)}this.uniforms.m.value=r};n.prototype._multiply=function(t,e,r){t[0]=e[0]*r[0]+e[1]*r[5]+e[2]*r[10]+e[3]*r[15]+e[4]*r[20];t[1]=e[0]*r[1]+e[1]*r[6]+e[2]*r[11]+e[3]*r[16]+e[4]*r[21];t[2]=e[0]*r[2]+e[1]*r[7]+e[2]*r[12]+e[3]*r[17]+e[4]*r[22];t[3]=e[0]*r[3]+e[1]*r[8]+e[2]*r[13]+e[3]*r[18]+e[4]*r[23];t[4]=e[0]*r[4]+e[1]*r[9]+e[2]*r[14]+e[3]*r[19]+e[4]*r[24];t[5]=e[5]*r[0]+e[6]*r[5]+e[7]*r[10]+e[8]*r[15]+e[9]*r[20];t[6]=e[5]*r[1]+e[6]*r[6]+e[7]*r[11]+e[8]*r[16]+e[9]*r[21];t[7]=e[5]*r[2]+e[6]*r[7]+e[7]*r[12]+e[8]*r[17]+e[9]*r[22];t[8]=e[5]*r[3]+e[6]*r[8]+e[7]*r[13]+e[8]*r[18]+e[9]*r[23];t[9]=e[5]*r[4]+e[6]*r[9]+e[7]*r[14]+e[8]*r[19]+e[9]*r[24];t[10]=e[10]*r[0]+e[11]*r[5]+e[12]*r[10]+e[13]*r[15]+e[14]*r[20];t[11]=e[10]*r[1]+e[11]*r[6]+e[12]*r[11]+e[13]*r[16]+e[14]*r[21];t[12]=e[10]*r[2]+e[11]*r[7]+e[12]*r[12]+e[13]*r[17]+e[14]*r[22];t[13]=e[10]*r[3]+e[11]*r[8]+e[12]*r[13]+e[13]*r[18]+e[14]*r[23];t[14]=e[10]*r[4]+e[11]*r[9]+e[12]*r[14]+e[13]*r[19]+e[14]*r[24];t[15]=e[15]*r[0]+e[16]*r[5]+e[17]*r[10]+e[18]*r[15]+e[19]*r[20];t[16]=e[15]*r[1]+e[16]*r[6]+e[17]*r[11]+e[18]*r[16]+e[19]*r[21];t[17]=e[15]*r[2]+e[16]*r[7]+e[17]*r[12]+e[18]*r[17]+e[19]*r[22];t[18]=e[15]*r[3]+e[16]*r[8]+e[17]*r[13]+e[18]*r[18]+e[19]*r[23];t[19]=e[15]*r[4]+e[16]*r[9]+e[17]*r[14]+e[18]*r[19]+e[19]*r[24];t[20]=e[20]*r[0]+e[21]*r[5]+e[22]*r[10]+e[23]*r[15]+e[24]*r[20];t[21]=e[20]*r[1]+e[21]*r[6]+e[22]*r[11]+e[23]*r[16]+e[24]*r[21];t[22]=e[20]*r[2]+e[21]*r[7]+e[22]*r[12]+e[23]*r[17]+e[24]*r[22];t[23]=e[20]*r[3]+e[21]*r[8]+e[22]*r[13]+e[23]*r[18]+e[24]*r[23];t[24]=e[20]*r[4]+e[21]*r[9]+e[22]*r[14]+e[23]*r[19]+e[24]*r[24];return t};n.prototype._colorMatrix=function(t){var e=new Float32Array(t);e[4]/=255;e[9]/=255;e[14]/=255;e[19]/=255;return e};n.prototype.brightness=function(t,e){var r=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(r,e)};n.prototype.greyscale=function(t,e){var r=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(r,e)};n.prototype.blackAndWhite=function(t){var e=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,t)};n.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var r=Math.cos(t),i=Math.sin(t);var n=.213,o=.715,s=.072;var a=[n+r*(1-n)+i*-n,o+r*-o+i*-o,s+r*-s+i*(1-s),0,0,n+r*-n+i*.143,o+r*(1-o)+i*.14,s+r*-s+i*-.283,0,0,n+r*-n+i*-(1-n),o+r*-o+i*o,s+r*(1-s)+i*s,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(a,e)};n.prototype.contrast=function(t,e){var r=(t||0)+1;var i=-128*(r-1);var n=[r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(n,e)};n.prototype.saturation=function(t,e){var r=(t||0)*2/3+1;var i=(r-1)*-.5;var n=[r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(n,e)};n.prototype.desaturate=function(t){this.saturation(-1)};n.prototype.negative=function(t){var e=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,t)};n.prototype.sepia=function(t){var e=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,t)};n.prototype.technicolor=function(t){var e=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0,0,0,0,0,0];this._loadMatrix(e,t)};n.prototype.polaroid=function(t){var e=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,t)};n.prototype.toBGR=function(t){var e=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,t)};n.prototype.kodachrome=function(t){var e=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,t)};n.prototype.browni=function(t){var e=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,t)};n.prototype.vintage=function(t){var e=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,t)};n.prototype.colorTone=function(t,e,r,i,n){t=t||.2;e=e||.15;r=r||16770432;i=i||3375104;var o=(r>>16&255)/255;var s=(r>>8&255)/255;var a=(r&255)/255;var l=(i>>16&255)/255;var h=(i>>8&255)/255;var u=(i&255)/255;var c=[.3,.59,.11,0,0,o,s,a,t,0,l,h,u,e,0,o-l,s-h,a-u,0,0,0,0,0,0,1];this._loadMatrix(c,n)};n.prototype.night=function(t,e){t=t||.1;var r=[t*-2,-t,0,0,0,-t,0,t,0,0,0,t,t*2,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(r,e)};n.prototype.predator=function(t,e){var r=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0,0,0,0,0,0];this._loadMatrix(r,e)};n.prototype.lsd=function(t){var e=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(e,t)};n.prototype.reset=function(){var t=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1];this._loadMatrix(t,false)};Object.defineProperties(n.prototype,{matrix:{get:function(){return this.uniforms.matrix.value},set:function(t){this.uniforms.matrix.value=t}}})},{"../../core":77}],146:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float step;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    color = floor(color * step) / step;\n\n    gl_FragColor = color;\n}\n",{step:{type:"1f",value:5}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{step:{get:function(){return this.uniforms.step.value},set:function(t){this.uniforms.step.value=t}}})},{"../../core":77}],147:[function(t,e,r){var i=t("../../core");function n(t,e,r){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n",{matrix:{type:"1fv",value:new Float32Array(t)},texelSize:{type:"2v",value:{x:1/e,y:1/r}}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{matrix:{get:function(){return this.uniforms.matrix.value},set:function(t){this.uniforms.matrix.value=new Float32Array(t)}},width:{get:function(){return 1/this.uniforms.texelSize.value.x},set:function(t){this.uniforms.texelSize.value.x=1/t}},height:{get:function(){return 1/this.uniforms.texelSize.value.y},set:function(t){this.uniforms.texelSize.value.y=1/t}}})},{"../../core":77}],148:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n},{"../../core":77}],149:[function(t,e,r){var i=t("../../core");function n(t){var e=new i.math.Matrix;t.renderable=false;i.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vMapCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nvoid main(void)\n{\n   vec4 original =  texture2D(uSampler, vTextureCoord);\n   vec4 map =  texture2D(mapSampler, vMapCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y));\n}\n",{mapSampler:{type:"sampler2D",value:t.texture},otherMatrix:{type:"mat3",value:e.toArray(true)},scale:{type:"v2",value:{x:1,y:1}}});this.maskSprite=t;this.maskMatrix=e;this.scale=new i.math.Point(20,20)}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.applyFilter=function(t,e,r){var i=t.filterManager;i.calculateMappedMatrix(e.frame,this.maskSprite,this.maskMatrix);this.uniforms.otherMatrix.value=this.maskMatrix.toArray(true);this.uniforms.scale.value.x=this.scale.x*(1/e.frame.width);this.uniforms.scale.value.y=this.scale.y*(1/e.frame.height);var n=this.getShader(t);i.applyFilter(n,e,r)};Object.defineProperties(n.prototype,{map:{get:function(){return this.uniforms.mapSampler.value},set:function(t){this.uniforms.mapSampler.value=t}}})},{"../../core":77}],150:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 dimensions;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * dimensions.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n",{scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{scale:{get:function(){return this.uniforms.scale.value},set:function(t){this.uniforms.scale.value=t}},angle:{get:function(){return this.uniforms.angle.value},set:function(t){this.uniforms.angle.value=t}}})},{"../../core":77}],151:[function(t,e,r){var i=t("../../core"),n=1/7e3;function o(){i.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform vec2 offset;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[14];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition+offset), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.028 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.024 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.020 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0, -0.016 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 6] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 7] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 8] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 9] = aTextureCoord + vec2(0.0,  0.012 * strength);\n    vBlurTexCoords[10] = aTextureCoord + vec2(0.0,  0.016 * strength);\n    vBlurTexCoords[11] = aTextureCoord + vec2(0.0,  0.020 * strength);\n    vBlurTexCoords[12] = aTextureCoord + vec2(0.0,  0.024 * strength);\n    vBlurTexCoords[13] = aTextureCoord + vec2(0.0,  0.028 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[14];\nvarying vec4 vColor;\n\nuniform float blur;\nuniform vec3 color;\nuniform float alpha;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec4 sum = vec4(0.0);\n\n    sum += texture2D(uSampler, vBlurTexCoords[ 0])*0.0044299121055113265;\n    sum += texture2D(uSampler, vBlurTexCoords[ 1])*0.00895781211794;\n    sum += texture2D(uSampler, vBlurTexCoords[ 2])*0.0215963866053;\n    sum += texture2D(uSampler, vBlurTexCoords[ 3])*0.0443683338718;\n    sum += texture2D(uSampler, vBlurTexCoords[ 4])*0.0776744219933;\n    sum += texture2D(uSampler, vBlurTexCoords[ 5])*0.115876621105;\n    sum += texture2D(uSampler, vBlurTexCoords[ 6])*0.147308056121;\n    sum += texture2D(uSampler, vTextureCoord         )*0.159576912161;\n    sum += texture2D(uSampler, vBlurTexCoords[ 7])*0.147308056121;\n    sum += texture2D(uSampler, vBlurTexCoords[ 8])*0.115876621105;\n    sum += texture2D(uSampler, vBlurTexCoords[ 9])*0.0776744219933;\n    sum += texture2D(uSampler, vBlurTexCoords[10])*0.0443683338718;\n    sum += texture2D(uSampler, vBlurTexCoords[11])*0.0215963866053;\n    sum += texture2D(uSampler, vBlurTexCoords[12])*0.00895781211794;\n    sum += texture2D(uSampler, vBlurTexCoords[13])*0.0044299121055113265;\n\n    gl_FragColor = vec4( color.rgb * sum.a * alpha, sum.a * alpha );\n}\n",{blur:{type:"1f",value:1/512},color:{type:"c",value:[0,0,0]},alpha:{type:"1f",value:.7},offset:{type:"2f",value:[5,5]}})}o.prototype=Object.create(i.AbstractFilter.prototype);o.prototype.constructor=o;e.exports=o;Object.defineProperties(o.prototype,{blur:{get:function(){return this.uniforms.blur.value/n},set:function(t){this.uniforms.blur.value=n*t}}})},{"../../core":77}],152:[function(t,e,r){var i=t("../../core"),n=t("../blur/BlurXFilter"),o=t("./BlurYTintFilter");function s(){i.AbstractFilter.call(this);this.blurXFilter=new n;this.blurYTintFilter=new o;this.defaultFilter=new i.AbstractFilter;this.padding=30;this._dirtyPosition=true;this._angle=45*Math.PI/180;this._distance=10;this.alpha=.75;this.hideObject=false;this.blendMode=i.CONST.BLEND_MODES.MULTIPLY}s.prototype=Object.create(i.AbstractFilter.prototype);s.prototype.constructor=s;e.exports=s;s.prototype.applyFilter=function(t,e,r){var n=t.filterManager.getRenderTarget(true);if(this._dirtyPosition){this._dirtyPosition=false;this.blurYTintFilter.uniforms.offset.value[0]=Math.sin(this._angle)*this._distance;this.blurYTintFilter.uniforms.offset.value[1]=Math.cos(this._angle)*this._distance}this.blurXFilter.applyFilter(t,e,n);t.blendModeManager.setBlendMode(this.blendMode);this.blurYTintFilter.applyFilter(t,n,r);t.blendModeManager.setBlendMode(i.CONST.BLEND_MODES.NORMAL);if(!this.hideObject){this.defaultFilter.applyFilter(t,e,r)}t.filterManager.returnRenderTarget(n)};Object.defineProperties(s.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYTintFilter.blur=t}},blurX:{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t}},blurY:{get:function(){return this.blurYTintFilter.blur},set:function(t){this.blurYTintFilter.blur=t}},color:{get:function(){return i.utils.rgb2hex(this.blurYTintFilter.uniforms.color.value)},set:function(t){this.blurYTintFilter.uniforms.color.value=i.utils.hex2rgb(t)}},alpha:{get:function(){return this.blurYTintFilter.uniforms.alpha.value},set:function(t){this.blurYTintFilter.uniforms.alpha.value=t}},distance:{get:function(){return this._distance},set:function(t){this._dirtyPosition=true;this._distance=t}},angle:{get:function(){return this._angle},set:function(t){this._dirtyPosition=true;this._angle=t}}})},{"../../core":77,"../blur/BlurXFilter":142,"./BlurYTintFilter":151}],153:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float gray;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);\n}\n",{gray:{type:"1f",value:1}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{gray:{get:function(){return this.uniforms.gray.value},set:function(t){this.uniforms.gray.value=t}}})},{"../../core":77}],154:[function(t,e,r){e.exports={AbstractFilter:t("../core/renderers/webgl/filters/AbstractFilter"),FXAAFilter:t("../core/renderers/webgl/filters/FXAAFilter"),SpriteMaskFilter:t("../core/renderers/webgl/filters/SpriteMaskFilter"),AsciiFilter:t("./ascii/AsciiFilter"),BloomFilter:t("./bloom/BloomFilter"),BlurFilter:t("./blur/BlurFilter"),BlurXFilter:t("./blur/BlurXFilter"),BlurYFilter:t("./blur/BlurYFilter"),ColorMatrixFilter:t("./color/ColorMatrixFilter"),ColorStepFilter:t("./color/ColorStepFilter"),ConvolutionFilter:t("./convolution/ConvolutionFilter"),CrossHatchFilter:t("./crosshatch/CrossHatchFilter"),DisplacementFilter:t("./displacement/DisplacementFilter"),DotScreenFilter:t("./dot/DotScreenFilter"),GrayFilter:t("./gray/GrayFilter"),DropShadowFilter:t("./dropshadow/DropShadowFilter"),InvertFilter:t("./invert/InvertFilter"),NoiseFilter:t("./noise/NoiseFilter"),NormalMapFilter:t("./normal/NormalMapFilter"),PixelateFilter:t("./pixelate/PixelateFilter"),RGBSplitFilter:t("./rgb/RGBSplitFilter"),ShockwaveFilter:t("./shockwave/ShockwaveFilter"),SepiaFilter:t("./sepia/SepiaFilter"),SmartBlurFilter:t("./blur/SmartBlurFilter"),TiltShiftFilter:t("./tiltshift/TiltShiftFilter"),TiltShiftXFilter:t("./tiltshift/TiltShiftXFilter"),TiltShiftYFilter:t("./tiltshift/TiltShiftYFilter"),TwistFilter:t("./twist/TwistFilter")}},{"../core/renderers/webgl/filters/AbstractFilter":97,"../core/renderers/webgl/filters/FXAAFilter":98,"../core/renderers/webgl/filters/SpriteMaskFilter":99,"./ascii/AsciiFilter":139,"./bloom/BloomFilter":140,"./blur/BlurFilter":141,"./blur/BlurXFilter":142,"./blur/BlurYFilter":143,"./blur/SmartBlurFilter":144,"./color/ColorMatrixFilter":145,"./color/ColorStepFilter":146,"./convolution/ConvolutionFilter":147,"./crosshatch/CrossHatchFilter":148,"./displacement/DisplacementFilter":149,"./dot/DotScreenFilter":150,"./dropshadow/DropShadowFilter":152,"./gray/GrayFilter":153,"./invert/InvertFilter":155,"./noise/NoiseFilter":156,"./normal/NormalMapFilter":157,"./pixelate/PixelateFilter":158,"./rgb/RGBSplitFilter":159,"./sepia/SepiaFilter":160,"./shockwave/ShockwaveFilter":161,"./tiltshift/TiltShiftFilter":163,"./tiltshift/TiltShiftXFilter":164,"./tiltshift/TiltShiftYFilter":165,"./twist/TwistFilter":166}],155:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform float invert;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);\n}\n",{invert:{type:"1f",value:1}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{invert:{get:function(){return this.uniforms.invert.value},set:function(t){this.uniforms.invert.value=t}}})},{"../../core":77}],156:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(vTextureCoord) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n",{noise:{type:"1f",value:.5}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{noise:{get:function(){return this.uniforms.noise.value},set:function(t){this.uniforms.noise.value=t}}})},{"../../core":77}],157:[function(t,e,r){var i=t("../../core");function n(t){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying float vColor;\n\nuniform sampler2D displacementMap;\nuniform sampler2D uSampler;\n\nuniform vec4 dimensions;\n\nconst vec2 Resolution = vec2(1.0,1.0);      //resolution of screen\nuniform vec3 LightPos;    //light position, normalized\nconst vec4 LightColor = vec4(1.0, 1.0, 1.0, 1.0);      //light RGBA -- alpha is intensity\nconst vec4 AmbientColor = vec4(1.0, 1.0, 1.0, 0.5);    //ambient RGBA -- alpha is intensity\nconst vec3 Falloff = vec3(0.0, 1.0, 0.2);         //attenuation coefficients\n\nuniform vec3 LightDir; // = vec3(1.0, 0.0, 1.0);\n\nuniform vec2 mapDimensions; // = vec2(256.0, 256.0);\n\n\nvoid main(void)\n{\n    vec2 mapCords = vTextureCoord.xy;\n\n    vec4 color = texture2D(uSampler, vTextureCoord.st);\n    vec3 nColor = texture2D(displacementMap, vTextureCoord.st).rgb;\n\n\n    mapCords *= vec2(dimensions.x/512.0, dimensions.y/512.0);\n\n    mapCords.y *= -1.0;\n    mapCords.y += 1.0;\n\n    // RGBA of our diffuse color\n    vec4 DiffuseColor = texture2D(uSampler, vTextureCoord);\n\n    // RGB of our normal map\n    vec3 NormalMap = texture2D(displacementMap, mapCords).rgb;\n\n    // The delta position of light\n    // vec3 LightDir = vec3(LightPos.xy - (gl_FragCoord.xy / Resolution.xy), LightPos.z);\n    vec3 LightDir = vec3(LightPos.xy - (mapCords.xy), LightPos.z);\n\n    // Correct for aspect ratio\n    // LightDir.x *= Resolution.x / Resolution.y;\n\n    // Determine distance (used for attenuation) BEFORE we normalize our LightDir\n    float D = length(LightDir);\n\n    // normalize our vectors\n    vec3 N = normalize(NormalMap * 2.0 - 1.0);\n    vec3 L = normalize(LightDir);\n\n    // Pre-multiply light color with intensity\n    // Then perform 'N dot L' to determine our diffuse term\n    vec3 Diffuse = (LightColor.rgb * LightColor.a) * max(dot(N, L), 0.0);\n\n    // pre-multiply ambient color with intensity\n    vec3 Ambient = AmbientColor.rgb * AmbientColor.a;\n\n    // calculate attenuation\n    float Attenuation = 1.0 / ( Falloff.x + (Falloff.y*D) + (Falloff.z*D*D) );\n\n    // the calculation which brings it all together\n    vec3 Intensity = Ambient + Diffuse * Attenuation;\n    vec3 FinalColor = DiffuseColor.rgb * Intensity;\n    gl_FragColor = vColor * vec4(FinalColor, DiffuseColor.a);\n\n    // gl_FragColor = vec4(1.0, 0.0, 0.0, Attenuation); // vColor * vec4(FinalColor, DiffuseColor.a);\n\n/*\n    // normalise color\n    vec3 normal = normalize(nColor * 2.0 - 1.0);\n\n    vec3 deltaPos = vec3( (light.xy - gl_FragCoord.xy) / resolution.xy, light.z );\n\n    float lambert = clamp(dot(normal, lightDir), 0.0, 1.0);\n\n    float d = sqrt(dot(deltaPos, deltaPos));\n    float att = 1.0 / ( attenuation.x + (attenuation.y*d) + (attenuation.z*d*d) );\n\n    vec3 result = (ambientColor * ambientIntensity) + (lightColor.rgb * lambert) * att;\n    result *= color.rgb;\n\n    gl_FragColor = vec4(result, 1.0);\n*/\n}\n",{
displacementMap:{type:"sampler2D",value:t},scale:{type:"2f",value:{x:15,y:15}},offset:{type:"2f",value:{x:0,y:0}},mapDimensions:{type:"2f",value:{x:1,y:1}},dimensions:{type:"4f",value:[0,0,0,0]},LightPos:{type:"3f",value:[0,1,0]}});t.baseTexture._powerOf2=true;if(t.baseTexture.hasLoaded){this.onTextureLoaded()}else{t.baseTexture.once("loaded",this.onTextureLoaded.bind(this))}}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.onTextureLoaded=function(){this.uniforms.mapDimensions.value.x=this.uniforms.displacementMap.value.width;this.uniforms.mapDimensions.value.y=this.uniforms.displacementMap.value.height};Object.defineProperties(n.prototype,{map:{get:function(){return this.uniforms.displacementMap.value},set:function(t){this.uniforms.displacementMap.value=t}},scale:{get:function(){return this.uniforms.scale.value},set:function(t){this.uniforms.scale.value=t}},offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}}})},{"../../core":77}],158:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 dimensions;\nuniform vec2 pixelSize;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord;\n\n    vec2 size = dimensions.xy / pixelSize;\n\n    vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;\n\n    gl_FragColor = texture2D(uSampler, color);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"v2",value:{x:10,y:10}}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(t){this.uniforms.pixelSize.value=t}}})},{"../../core":77}],159:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 dimensions;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n",{red:{type:"v2",value:{x:20,y:20}},green:{type:"v2",value:{x:-20,y:20}},blue:{type:"v2",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{red:{get:function(){return this.uniforms.red.value},set:function(t){this.uniforms.red.value=t}},green:{get:function(){return this.uniforms.green.value},set:function(t){this.uniforms.green.value=t}},blue:{get:function(){return this.uniforms.blue.value},set:function(t){this.uniforms.blue.value=t}}})},{"../../core":77}],160:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float sepia;\n\nconst mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);\n}\n",{sepia:{type:"1f",value:1}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{sepia:{get:function(){return this.uniforms.sepia.value},set:function(t){this.uniforms.sepia.value=t}}})},{"../../core":77}],161:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 center;\nuniform vec3 params; // 10.0, 0.8, 0.1\nuniform float time;\n\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    vec2 texCoord = uv;\n\n    float dist = distance(uv, center);\n\n    if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )\n    {\n        float diff = (dist - time);\n        float powDiff = 1.0 - pow(abs(diff*params.x), params.y);\n\n        float diffTime = diff  * powDiff;\n        vec2 diffUV = normalize(uv - center);\n        texCoord = uv + (diffUV * diffTime);\n    }\n\n    gl_FragColor = texture2D(uSampler, texCoord);\n}\n",{center:{type:"v2",value:{x:.5,y:.5}},params:{type:"v3",value:{x:10,y:.8,z:.1}},time:{type:"1f",value:0}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{center:{get:function(){return this.uniforms.center.value},set:function(t){this.uniforms.center.value=t}},params:{get:function(){return this.uniforms.params.value},set:function(t){this.uniforms.params.value=t}},time:{get:function(){return this.uniforms.time.value},set:function(t){this.uniforms.time.value=t}}})},{"../../core":77}],162:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{blur:{type:"1f",value:100},gradientBlur:{type:"1f",value:600},start:{type:"v2",value:{x:0,y:window.innerHeight/2}},end:{type:"v2",value:{x:600,y:window.innerHeight/2}},delta:{type:"v2",value:{x:30,y:30}},texSize:{type:"v2",value:{x:window.innerWidth,y:window.innerHeight}}});this.updateDelta()}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.updateDelta=function(){this.uniforms.delta.value.x=0;this.uniforms.delta.value.y=0};Object.defineProperties(n.prototype,{blur:{get:function(){return this.uniforms.blur.value},set:function(t){this.uniforms.blur.value=t}},gradientBlur:{get:function(){return this.uniforms.gradientBlur.value},set:function(t){this.uniforms.gradientBlur.value=t}},start:{get:function(){return this.uniforms.start.value},set:function(t){this.uniforms.start.value=t;this.updateDelta()}},end:{get:function(){return this.uniforms.end.value},set:function(t){this.uniforms.end.value=t;this.updateDelta()}}})},{"../../core":77}],163:[function(t,e,r){var i=t("../../core"),n=t("./TiltShiftXFilter"),o=t("./TiltShiftYFilter");function s(){i.AbstractFilter.call(this);this.tiltShiftXFilter=new n;this.tiltShiftYFilter=new o}s.prototype=Object.create(i.AbstractFilter.prototype);s.prototype.constructor=s;e.exports=s;s.prototype.applyFilter=function(t,e,r){var i=t.filterManager.getRenderTarget(true);this.tiltShiftXFilter.applyFilter(t,e,i);this.tiltShiftYFilter.applyFilter(t,i,r);t.filterManager.returnRenderTarget(i)};Object.defineProperties(s.prototype,{blur:{get:function(){return this.tiltShiftXFilter.blur},set:function(t){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=t}},gradientBlur:{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(t){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=t}},start:{get:function(){return this.tiltShiftXFilter.start},set:function(t){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=t}},end:{get:function(){return this.tiltShiftXFilter.end},set:function(t){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=t}}})},{"../../core":77,"./TiltShiftXFilter":164,"./TiltShiftYFilter":165}],164:[function(t,e,r){var i=t("./TiltShiftAxisFilter");function n(){i.call(this)}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x;var e=this.uniforms.end.value.y-this.uniforms.start.value.y;var r=Math.sqrt(t*t+e*e);this.uniforms.delta.value.x=t/r;this.uniforms.delta.value.y=e/r}},{"./TiltShiftAxisFilter":162}],165:[function(t,e,r){var i=t("./TiltShiftAxisFilter");function n(){i.call(this)}n.prototype=Object.create(i.prototype);n.prototype.constructor=n;e.exports=n;n.prototype.updateDelta=function(){var t=this.uniforms.end.value.x-this.uniforms.start.value.x;var e=this.uniforms.end.value.y-this.uniforms.start.value.y;var r=Math.sqrt(t*t+e*e);this.uniforms.delta.value.x=-e/r;this.uniforms.delta.value.y=t/r}},{"./TiltShiftAxisFilter":162}],166:[function(t,e,r){var i=t("../../core");function n(){i.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\n\nvoid main(void)\n{\n   vec2 coord = vTextureCoord - offset;\n   float dist = length(coord);\n\n   if (dist < radius)\n   {\n       float ratio = (radius - dist) / radius;\n       float angleMod = ratio * ratio * angle;\n       float s = sin(angleMod);\n       float c = cos(angleMod);\n       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n   }\n\n   gl_FragColor = texture2D(uSampler, coord+offset);\n}\n",{radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"v2",value:{x:.5,y:.5}}})}n.prototype=Object.create(i.AbstractFilter.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{offset:{get:function(){return this.uniforms.offset.value},set:function(t){this.uniforms.offset.value=t}},radius:{get:function(){return this.uniforms.radius.value},set:function(t){this.uniforms.radius.value=t}},angle:{get:function(){return this.uniforms.angle.value},set:function(t){this.uniforms.angle.value=t}}})},{"../../core":77}],167:[function(t,e,r){var i=t("./core");n(t("./extras"));n(t("./filters"));n(t("./interaction"));n(t("./loaders"));n(t("./spine"));n(t("./text"));n(t("./deprecation"));function n(t){for(var e in t){i[e]=t[e]}}e.exports=i},{"./core":77,"./deprecation":128,"./extras":133,"./filters":154,"./interaction":170,"./loaders":173,"./spine":180,"./text":183}],168:[function(t,e,r){var i=t("../core");function n(){this.global=new i.math.Point;this.target=null;this.originalEvent=null}n.prototype.constructor=n;e.exports=n;n.prototype.getLocalPosition=function(t,e){var r=t.worldTransform;var n=this.global;var o=r.a,s=r.c,a=r.tx,l=r.b,h=r.d,u=r.ty,c=1/(o*h+s*-l);e=e||new i.math.Point;e.x=h*c*n.x+-s*c*n.y+(u*s-a*h)*c;e.y=o*c*n.y+-l*c*n.x+(-u*o+a*l)*c;return e}},{"../core":77}],169:[function(t,e,r){var i=t("../core"),n=t("./InteractionData");var o=10;var s=true;function a(t){this.renderer=t;this.mouse=new n;this.eventData=new i.utils.EventData;this.eventData.data=this.mouse;this.interactiveDataPool=[];this.interactionDOMElement=null;this.eventsAdded=false;this.onMouseUp=this.onMouseUp.bind(this);this.processMouseUp=this.processMouseUp.bind(this);this.onMouseDown=this.onMouseDown.bind(this);this.processMouseDown=this.processMouseDown.bind(this);this.onMouseMove=this.onMouseMove.bind(this);this.processMouseMove=this.processMouseMove.bind(this);this.onMouseOut=this.onMouseOut.bind(this);this.processMouseOverOut=this.processMouseOverOut.bind(this);this.onTouchStart=this.onTouchStart.bind(this);this.processTouchStart=this.processTouchStart.bind(this);this.onTouchEnd=this.onTouchEnd.bind(this);this.processTouchEnd=this.processTouchEnd.bind(this);this.onTouchMove=this.onTouchMove.bind(this);this.processTouchMove=this.processTouchMove.bind(this);this.last=0;this.currentCursorStyle="inherit";this._tempPoint=new i.math.Point;this.resolution=1;this.setTargetElement(this.renderer.view,this.renderer.resolution);this.update()}a.prototype.constructor=a;e.exports=a;a.prototype.setTargetElement=function(t,e){this.removeEvents();this.interactionDOMElement=t;this.resolution=e||1;this.addEvents()};a.prototype.addEvents=function(){if(!this.interactionDOMElement){return}if(window.navigator.msPointerEnabled){this.interactionDOMElement.style["-ms-content-zooming"]="none";this.interactionDOMElement.style["-ms-touch-action"]="none"}this.interactionDOMElement.addEventListener("mousemove",this.onMouseMove,true);this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,true);this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,true);this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,true);this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,true);this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,true);window.addEventListener("mouseup",this.onMouseUp,true);this.eventsAdded=true};a.prototype.removeEvents=function(){if(!this.interactionDOMElement){return}if(window.navigator.msPointerEnabled){this.interactionDOMElement.style["-ms-content-zooming"]="";this.interactionDOMElement.style["-ms-touch-action"]=""}this.interactionDOMElement.removeEventListener("mousemove",this.onMouseMove,true);this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,true);this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,true);this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,true);this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,true);this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,true);this.interactionDOMElement=null;window.removeEventListener("mouseup",this.onMouseUp,true);this.eventsAdded=false};a.prototype.update=function(){requestAnimationFrame(this.update.bind(this));if(this.throttleUpdate()||!this.interactionDOMElement){return}if(this.didMove){this.didMove=false;return}this.cursor="inherit";this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut.bind(this),true);if(this.currentCursorStyle!==this.cursor){this.currentCursorStyle=this.cursor;this.interactionDOMElement.style.cursor=this.cursor}};a.prototype.dispatchEvent=function(t,e,r){if(!r.stopped){r.target=t;r.type=e;t.emit(e,r);if(t[e]){t[e](r)}}};a.prototype.throttleUpdate=function(){var t=Date.now();var e=t-this.last;e=e*o/1e3;if(e<1){return true}this.last=t;return false};a.prototype.mapPositionToPoint=function(t,e,r){var i=this.interactionDOMElement.getBoundingClientRect();t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)/this.resolution;t.y=(r-i.top)*(this.interactionDOMElement.height/i.height)/this.resolution};a.prototype.processInteractive=function(t,e,r,i,n){if(!e.visible){return false}var o=e.children;var s=false;n=n||e.interactive;if(e.interactiveChildren){for(var a=o.length-1;a>=0;a--){if(!s&&i){s=this.processInteractive(t,o[a],r,true,n)}else{this.processInteractive(t,o[a],r,false,false)}}}if(n){if(i){if(e.hitArea){e.worldTransform.applyInverse(t,this._tempPoint);s=e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)}else if(e.containsPoint){s=e.containsPoint(t)}}if(e.interactive){r(e,s)}}return s};a.prototype.onMouseDown=function(t){this.mouse.originalEvent=t;this.eventData.data=this.mouse;this.eventData.stopped=false;if(s){this.mouse.originalEvent.preventDefault()}this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,true)};a.prototype.processMouseDown=function(t,e){var r=this.mouse.originalEvent;var i=r.button===2||r.which===3;if(e){t[i?"_isRightDown":"_isLeftDown"]=true;this.dispatchEvent(t,i?"rightdown":"mousedown",this.eventData)}};a.prototype.onMouseUp=function(t){this.mouse.originalEvent=t;this.eventData.data=this.mouse;this.eventData.stopped=false;this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,true)};a.prototype.processMouseUp=function(t,e){var r=this.mouse.originalEvent;var i=r.button===2||r.which===3;var n=i?"_isRightDown":"_isLeftDown";if(e){this.dispatchEvent(t,i?"rightup":"mouseup",this.eventData);if(t[n]){t[n]=false;this.dispatchEvent(t,i?"rightclick":"click",this.eventData)}}else{if(t[n]){t[n]=false;this.dispatchEvent(t,i?"rightupoutside":"mouseupoutside",this.eventData)}}};a.prototype.onMouseMove=function(t){this.mouse.originalEvent=t;this.eventData.data=this.mouse;this.eventData.stopped=false;this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY);this.didMove=true;this.cursor="inherit";this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,true);if(this.currentCursorStyle!==this.cursor){this.currentCursorStyle=this.cursor;this.interactionDOMElement.style.cursor=this.cursor}};a.prototype.processMouseMove=function(t,e){this.dispatchEvent(t,"mousemove",this.eventData);this.processMouseOverOut(t,e)};a.prototype.onMouseOut=function(t){this.mouse.originalEvent=t;this.eventData.stopped=false;this.interactionDOMElement.style.cursor="inherit";this.mapPositionToPoint(this.mouse.global,t.clientX,t.clientY);this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,false)};a.prototype.processMouseOverOut=function(t,e){if(e){if(!t._over){t._over=true;this.dispatchEvent(t,"mouseover",this.eventData)}if(t.buttonMode){this.cursor=t.defaultCursor}}else{if(t._over){t._over=false;this.dispatchEvent(t,"mouseout",this.eventData)}}};a.prototype.onTouchStart=function(t){if(s){t.preventDefault()}var e=t.changedTouches;for(var r=0;r<e.length;r++){var i=e[r];var n=this.getTouchData(i);n.originalEvent=t;this.eventData.data=n;this.eventData.stopped=false;this.processInteractive(n.global,this.renderer._lastObjectRendered,this.processTouchStart,true);this.returnTouchData(n)}};a.prototype.processTouchStart=function(t,e){if(e){t._touchDown=true;this.dispatchEvent(t,"touchstart",this.eventData)}};a.prototype.onTouchEnd=function(t){if(s){t.preventDefault()}var e=t.changedTouches;for(var r=0;r<e.length;r++){var i=e[r];var n=this.getTouchData(i);n.originalEvent=t;this.eventData.data=n;this.eventData.stopped=false;this.processInteractive(n.global,this.renderer._lastObjectRendered,this.processTouchEnd,true);this.returnTouchData(n)}};a.prototype.processTouchEnd=function(t,e){if(e){this.dispatchEvent(t,"touchend",this.eventData);if(t._touchDown){t._touchDown=false;this.dispatchEvent(t,"tap",this.eventData)}}else{if(t._touchDown){t._touchDown=false;this.dispatchEvent(t,"touchendoutside",this.eventData)}}};a.prototype.onTouchMove=function(t){if(s){t.preventDefault()}var e=t.changedTouches;for(var r=0;r<e.length;r++){var i=e[r];var n=this.getTouchData(i);n.originalEvent=t;this.eventData.data=n;this.eventData.stopped=false;this.processInteractive(n.global,this.renderer._lastObjectRendered,this.processTouchMove,false);this.returnTouchData(n)}};a.prototype.processTouchMove=function(t,e){e=e;this.dispatchEvent(t,"touchmove",this.eventData)};a.prototype.getTouchData=function(t){var e=this.interactiveDataPool.pop();if(!e){e=new n}e.identifier=t.identifier;this.mapPositionToPoint(e.global,t.clientX,t.clientY);return e};a.prototype.returnTouchData=function(t){this.interactiveDataPool.push(t)};i.WebGLRenderer.registerPlugin("interaction",a);i.CanvasRenderer.registerPlugin("interaction",a)},{"../core":77,"./InteractionData":168}],170:[function(t,e,r){e.exports={InteractionData:t("./InteractionData"),InteractionManager:t("./InteractionManager"),interactiveTarget:t("./interactiveTarget")}},{"./InteractionData":168,"./InteractionManager":169,"./interactiveTarget":171}],171:[function(t,e,r){var i=t("../core");i.DisplayObject.prototype.interactive=false;i.DisplayObject.prototype.buttonMode=false;i.DisplayObject.prototype.interactiveChildren=true;i.DisplayObject.prototype.defaultCursor="pointer";i.DisplayObject.prototype._over=false;i.DisplayObject.prototype._touchDown=false;e.exports={}},{"../core":77}],172:[function(t,e,r){var i=t("resource-loader").Resource,n=t("../core"),o=t("../text");e.exports=function(){return function(t,e){if(!t.data||navigator.isCocoonJS){if(window.DOMParser){var r=new DOMParser;t.data=r.parseFromString(this.xhr.responseText,"text/xml")}else{var s=document.createElement("div");s.innerHTML=this.xhr.responseText;t.data=s}}var a=t.data.nodeName;if(!t.data||!a||a.toLowerCase()!=="#document"&&a.toLowerCase()!=="div"){return e()}var l=this.baseUrl+t.data.getElementsByTagName("page")[0].getAttribute("file");var h={crossOrigin:t.crossOrigin,loadType:i.LOAD_TYPE.IMAGE};this.add(t.name+"_image",l,h,function(r){var i={};var s=t.data.getElementsByTagName("info")[0];var a=t.data.getElementsByTagName("common")[0];i.font=s.getAttribute("face");i.size=parseInt(s.getAttribute("size"),10);i.lineHeight=parseInt(a.getAttribute("lineHeight"),10);i.chars={};var l=t.data.getElementsByTagName("char");for(var h=0;h<l.length;h++){var u=parseInt(l[h].getAttribute("id"),10);var c=new n.math.Rectangle(parseInt(l[h].getAttribute("x"),10),parseInt(l[h].getAttribute("y"),10),parseInt(l[h].getAttribute("width"),10),parseInt(l[h].getAttribute("height"),10));i.chars[u]={xOffset:parseInt(l[h].getAttribute("xoffset"),10),yOffset:parseInt(l[h].getAttribute("yoffset"),10),xAdvance:parseInt(l[h].getAttribute("xadvance"),10),kerning:{},texture:n.utils.TextureCache[u]=new n.Texture(r.texture.baseTexture,c)}}var f=t.data.getElementsByTagName("kerning");for(h=0;h<f.length;h++){var d=parseInt(f[h].getAttribute("first"),10);var p=parseInt(f[h].getAttribute("second"),10);var v=parseInt(f[h].getAttribute("amount"),10);i.chars[p].kerning[d]=v}t.bitmapFont=i;o.BitmapText.fonts[i.font]=i;e()})}}},{"../core":77,"../text":183,"resource-loader":66}],173:[function(t,e,r){e.exports={Loader:t("./loader"),bitmapFontParser:t("./bitmapFontParser"),spineAtlasParser:t("./spineAtlasParser"),spritesheetParser:t("./spritesheetParser"),textureParser:t("./textureParser")}},{"./bitmapFontParser":172,"./loader":174,"./spineAtlasParser":175,"./spritesheetParser":176,"./textureParser":177}],174:[function(t,e,r){var i=t("resource-loader"),n=t("./textureParser"),o=t("./spritesheetParser"),s=t("./spineAtlasParser"),a=t("./bitmapFontParser");var l=function(){i.call(this);this.use(i.middleware.parsing.json()).use(i.middleware.parsing.blob()).use(n()).use(o()).use(s()).use(a())};l.prototype=Object.create(i.prototype);l.prototype.constructor=l;e.exports=l},{"./bitmapFontParser":172,"./spineAtlasParser":175,"./spritesheetParser":176,"./textureParser":177,"resource-loader":66}],175:[function(t,e,r){var i=t("resource-loader").Resource,n=t("async"),o=t("../spine");e.exports=function(){return function(t,e){if(t.data&&t.data.bones){var r=t.url.substr(0,t.url.lastIndexOf("."))+".atlas";var s={crossOrigin:t.crossOrigin,xhrType:i.XHR_RESPONSE_TYPE.TEXT};var a=t.url.substr(0,t.url.lastIndexOf("/")+1);this.add(t.name+"_atlas",r,s,function(r){var i=new o.SpineRuntime.Atlas(this.xhr.responseText,a,r.crossOrigin);var s=new o.SpineRuntime.SkeletonJsonParser(new o.SpineRuntime.AtlasAttachmentParser(i));var l=s.readSkeletonData(t.data);t.spineData=l;t.spineAtlas=i;n.each(i.pages,function(t,e){if(t.rendererObject.hasLoaded){e()}else{t.rendererObject.once("loaded",e)}},e)})}else{e()}}}},{"../spine":180,async:61,"resource-loader":66}],176:[function(t,e,r){var i=t("resource-loader").Resource,n=t("path"),o=t("../core");e.exports=function(){return function(t,e){if(t.data&&t.data.frames){var r={crossOrigin:t.crossOrigin,loadType:i.LOAD_TYPE.IMAGE};var s=n.dirname(t.url.replace(this.baseUrl,""));var a=o.utils.getResolutionOfUrl(t.url);this.add(t.name+"_image",this.baseUrl+s+"/"+t.data.meta.image,r,function(r){t.textures={};var i=t.data.frames;for(var n in i){var s=i[n].frame;if(s){var l=null;var h=null;if(i[n].rotated){l=new o.math.Rectangle(s.x,s.y,s.h,s.w)}else{l=new o.math.Rectangle(s.x,s.y,s.w,s.h)}if(i[n].trimmed){h=new o.math.Rectangle(i[n].spriteSourceSize.x/a,i[n].spriteSourceSize.y/a,i[n].sourceSize.w/a,i[n].sourceSize.h/a)}if(i[n].rotated){var u=l.width;l.width=l.height;l.height=u}l.x/=a;l.y/=a;l.width/=a;l.height/=a;t.textures[n]=new o.Texture(r.texture.baseTexture,l,l.clone(),h,i[n].rotated);o.utils.TextureCache[n]=t.textures[n]}}e()})}else{e()}}}},{"../core":77,path:8,"resource-loader":66}],177:[function(t,e,r){var i=t("../core");e.exports=function(){return function(t,e){if(t.data&&t.data.nodeName&&t.data.nodeName.toLowerCase()==="img"){t.texture=new i.Texture(new i.BaseTexture(t.data,null,i.utils.getResolutionOfUrl(t.url)));i.utils.TextureCache[t.url]=t.texture}e()}}},{"../core":77}],178:[function(t,e,r){var i=t("../core"),n=t("./SpineRuntime");n.Bone.yDown=true;function o(t){i.Container.call(this);if(!t){throw new Error("The spineData param is required.")}this.spineData=t;this.skeleton=new n.Skeleton(t);this.skeleton.updateWorldTransform();this.stateData=new n.AnimationStateData(t);this.state=new n.AnimationState(this.stateData);this.slotContainers=[];for(var e=0,r=this.skeleton.drawOrder.length;e<r;e++){var o=this.skeleton.drawOrder[e];var s=o.attachment;var a=new i.Container;this.slotContainers.push(a);this.addChild(a);if(s instanceof n.RegionAttachment){var l=s.rendererObject.name;var h=this.createSprite(o,s);o.currentSprite=h;o.currentSpriteName=l;a.addChild(h)}else if(s instanceof n.MeshAttachment){var u=this.createMesh(o,s);o.currentMesh=u;o.currentMeshName=s.name;a.addChild(u)}else{continue}}this.autoUpdate=true}o.prototype=Object.create(i.Container.prototype);o.prototype.constructor=o;e.exports=o;Object.defineProperties(o.prototype,{autoUpdate:{get:function(){return this.updateTransform===o.prototype.autoUpdateTransform},set:function(t){this.updateTransform=t?o.prototype.autoUpdateTransform:i.Container.prototype.updateTransform}}});o.prototype.update=function(t){this.state.update(t);this.state.apply(this.skeleton);this.skeleton.updateWorldTransform();var e=this.skeleton.drawOrder;for(var r=0,o=e.length;r<o;r++){var s=e[r];var a=s.attachment;var l=this.slotContainers[r];if(!a){l.visible=false;continue}var h=a.type;if(h===n.AttachmentType.region){if(a.rendererObject){if(!s.currentSpriteName||s.currentSpriteName!==a.rendererObject.name){var u=a.rendererObject.name;if(s.currentSprite!==undefined){s.currentSprite.visible=false}s.sprites=s.sprites||{};if(s.sprites[u]!==undefined){s.sprites[u].visible=true}else{var c=this.createSprite(s,a);l.addChild(c)}s.currentSprite=s.sprites[u];s.currentSpriteName=u}}var f=s.bone;l.position.x=f.worldX+a.x*f.m00+a.y*f.m01;l.position.y=f.worldY+a.x*f.m10+a.y*f.m11;l.scale.x=f.worldScaleX;l.scale.y=f.worldScaleY;l.rotation=-(s.bone.worldRotation*n.degRad);s.currentSprite.tint=i.utils.rgb2hex([s.r,s.g,s.b])}else if(h===n.AttachmentType.skinnedmesh){if(!s.currentMeshName||s.currentMeshName!==a.name){var d=a.name;if(s.currentMesh!==undefined){s.currentMesh.visible=false}s.meshes=s.meshes||{};if(s.meshes[d]!==undefined){s.meshes[d].visible=true}else{var p=this.createMesh(s,a);l.addChild(p)}s.currentMesh=s.meshes[d];s.currentMeshName=d}a.computeWorldVertices(s.bone.skeleton.x,s.bone.skeleton.y,s,s.currentMesh.vertices)}else{l.visible=false;continue}l.visible=true;l.alpha=s.a}};o.prototype.autoUpdateTransform=function(){this.lastTime=this.lastTime||Date.now();var t=(Date.now()-this.lastTime)*.001;this.lastTime=Date.now();this.update(t);i.Container.prototype.updateTransform.call(this)};o.prototype.createSprite=function(t,e){var r=e.rendererObject;var o=r.page.rendererObject;var s=new i.math.Rectangle(r.x,r.y,r.rotate?r.height:r.width,r.rotate?r.width:r.height);var a=new i.Texture(o,s);var l=new i.Sprite(a);var h=r.rotate?Math.PI*.5:0;l.scale.set(r.width/r.originalWidth,r.height/r.originalHeight);l.rotation=h-e.rotation*n.degRad;l.anchor.x=l.anchor.y=.5;t.sprites=t.sprites||{};t.sprites[r.name]=l;return l};o.prototype.createMesh=function(t,e){var r=e.rendererObject;var n=r.page.rendererObject;var o=new i.Texture(n);var s=new i.Strip(o);s.drawMode=i.Strip.DRAW_MODES.TRIANGLES;s.canvasPadding=1.5;s.vertices=new Float32Array(e.uvs.length);s.uvs=e.uvs;s.indices=e.triangles;t.meshes=t.meshes||{};t.meshes[e.name]=s;return s}},{"../core":77,"./SpineRuntime":179}],179:[function(t,e,r){var i=t("../core");var n=e.exports={radDeg:180/Math.PI,degRad:Math.PI/180,temp:[],Float32Array:typeof Float32Array==="undefined"?Array:Float32Array,Uint16Array:typeof Uint16Array==="undefined"?Array:Uint16Array};n.BoneData=function(t,e){this.name=t;this.parent=e};n.BoneData.prototype={length:0,x:0,y:0,rotation:0,scaleX:1,scaleY:1,inheritScale:true,inheritRotation:true,flipX:false,flipY:false};n.SlotData=function(t,e){this.name=t;this.boneData=e};n.SlotData.prototype={r:1,g:1,b:1,a:1,attachmentName:null,additiveBlending:false};n.IkConstraintData=function(t){this.name=t;this.bones=[]};n.IkConstraintData.prototype={target:null,bendDirection:1,mix:1};n.Bone=function(t,e,r){this.data=t;this.skeleton=e;this.parent=r;this.setToSetupPose()};n.Bone.yDown=false;n.Bone.prototype={x:0,y:0,rotation:0,rotationIK:0,scaleX:1,scaleY:1,flipX:false,flipY:false,m00:0,m01:0,worldX:0,m10:0,m11:0,worldY:0,worldRotation:0,worldScaleX:1,worldScaleY:1,worldFlipX:false,worldFlipY:false,updateWorldTransform:function(){var t=this.parent;if(t){this.worldX=this.x*t.m00+this.y*t.m01+t.worldX;this.worldY=this.x*t.m10+this.y*t.m11+t.worldY;if(this.data.inheritScale){this.worldScaleX=t.worldScaleX*this.scaleX;this.worldScaleY=t.worldScaleY*this.scaleY}else{this.worldScaleX=this.scaleX;this.worldScaleY=this.scaleY}this.worldRotation=this.data.inheritRotation?t.worldRotation+this.rotationIK:this.rotationIK;this.worldFlipX=t.worldFlipX!=this.flipX;this.worldFlipY=t.worldFlipY!=this.flipY}else{var e=this.skeleton.flipX,r=this.skeleton.flipY;this.worldX=e?-this.x:this.x;this.worldY=r!=n.Bone.yDown?-this.y:this.y;this.worldScaleX=this.scaleX;this.worldScaleY=this.scaleY;this.worldRotation=this.rotationIK;this.worldFlipX=e!=this.flipX;this.worldFlipY=r!=this.flipY}var i=this.worldRotation*n.degRad;var o=Math.cos(i);var s=Math.sin(i);if(this.worldFlipX){this.m00=-o*this.worldScaleX;this.m01=s*this.worldScaleY}else{this.m00=o*this.worldScaleX;this.m01=-s*this.worldScaleY}if(this.worldFlipY!=n.Bone.yDown){this.m10=-s*this.worldScaleX;this.m11=-o*this.worldScaleY}else{this.m10=s*this.worldScaleX;this.m11=o*this.worldScaleY}},setToSetupPose:function(){var t=this.data;this.x=t.x;this.y=t.y;this.rotation=t.rotation;this.rotationIK=this.rotation;this.scaleX=t.scaleX;this.scaleY=t.scaleY;this.flipX=t.flipX;this.flipY=t.flipY},worldToLocal:function(t){var e=t[0]-this.worldX,r=t[1]-this.worldY;var i=this.m00,o=this.m10,s=this.m01,a=this.m11;if(this.worldFlipX!=(this.worldFlipY!=n.Bone.yDown)){i=-i;a=-a}var l=1/(i*a-s*o);t[0]=e*i*l-r*s*l;t[1]=r*a*l-e*o*l},localToWorld:function(t){var e=t[0],r=t[1];t[0]=e*this.m00+r*this.m01+this.worldX;t[1]=e*this.m10+r*this.m11+this.worldY}};n.Slot=function(t,e){this.data=t;this.bone=e;this.setToSetupPose()};n.Slot.prototype={r:1,g:1,b:1,a:1,_attachmentTime:0,attachment:null,attachmentVertices:[],setAttachment:function(t){this.attachment=t;this._attachmentTime=this.bone.skeleton.time;this.attachmentVertices.length=0},setAttachmentTime:function(t){this._attachmentTime=this.bone.skeleton.time-t},getAttachmentTime:function(){return this.bone.skeleton.time-this._attachmentTime},setToSetupPose:function(){var t=this.data;this.r=t.r;this.g=t.g;this.b=t.b;this.a=t.a;var e=this.bone.skeleton.data.slots;for(var r=0,i=e.length;r<i;r++){if(e[r]==t){this.setAttachment(!t.attachmentName?null:this.bone.skeleton.getAttachmentBySlotIndex(r,t.attachmentName));

break}}}};n.IkConstraint=function(t,e){this.data=t;this.mix=t.mix;this.bendDirection=t.bendDirection;this.bones=[];for(var r=0,i=t.bones.length;r<i;r++)this.bones.push(e.findBone(t.bones[r].name));this.target=e.findBone(t.target.name)};n.IkConstraint.prototype={apply:function(){var t=this.target;var e=this.bones;switch(e.length){case 1:n.IkConstraint.apply1(e[0],t.worldX,t.worldY,this.mix);break;case 2:n.IkConstraint.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.mix);break}}};n.IkConstraint.apply1=function(t,e,r,i){var o=!t.data.inheritRotation||!t.parent?0:t.parent.worldRotation;var s=t.rotation;var a=Math.atan2(r-t.worldY,e-t.worldX)*n.radDeg-o;t.rotationIK=s+(a-s)*i};n.IkConstraint.apply2=function(t,e,r,i,o,s){var a=e.rotation,l=t.rotation;if(!s){e.rotationIK=a;t.rotationIK=l;return}var h,u,c=n.temp;var f=t.parent;if(f){c[0]=r;c[1]=i;f.worldToLocal(c);r=(c[0]-t.x)*f.worldScaleX;i=(c[1]-t.y)*f.worldScaleY}else{r-=t.x;i-=t.y}if(e.parent==t){h=e.x;u=e.y}else{c[0]=e.x;c[1]=e.y;e.parent.localToWorld(c);t.worldToLocal(c);h=c[0];u=c[1]}var d=h*t.worldScaleX,p=u*t.worldScaleY;var v=Math.atan2(p,d);var g=Math.sqrt(d*d+p*p),m=e.data.length*e.worldScaleX;var y=2*g*m;if(y<1e-4){e.rotationIK=a+(Math.atan2(i,r)*n.radDeg-l-a)*s;return}var x=(r*r+i*i-g*g-m*m)/y;if(x<-1)x=-1;else if(x>1)x=1;var _=Math.acos(x)*o;var b=g+m*x,T=m*Math.sin(_);var w=Math.atan2(i*b-r*T,r*b+i*T);var E=(w-v)*n.radDeg-l;if(E>180)E-=360;else if(E<-180)E+=360;t.rotationIK=l+E*s;E=(_+v)*n.radDeg-a;if(E>180)E-=360;else if(E<-180)E+=360;e.rotationIK=a+(E+t.worldRotation-e.parent.worldRotation)*s};n.Skin=function(t){this.name=t;this.attachments={}};n.Skin.prototype={addAttachment:function(t,e,r){this.attachments[t+":"+e]=r},getAttachment:function(t,e){return this.attachments[t+":"+e]},_attachAll:function(t,e){for(var r in e.attachments){var i=r.indexOf(":");var n=parseInt(r.substring(0,i));var o=r.substring(i+1);var s=t.slots[n];if(s.attachment&&s.attachment.name==o){var a=this.getAttachment(n,o);if(a)s.setAttachment(a)}}}};n.Animation=function(t,e,r){this.name=t;this.timelines=e;this.duration=r};n.Animation.prototype={apply:function(t,e,r,i,n){if(i&&this.duration!=0){r%=this.duration;e%=this.duration}var o=this.timelines;for(var s=0,a=o.length;s<a;s++)o[s].apply(t,e,r,n,1)},mix:function(t,e,r,i,n,o){if(i&&this.duration!=0){r%=this.duration;e%=this.duration}var s=this.timelines;for(var a=0,l=s.length;a<l;a++)s[a].apply(t,e,r,n,o)}};n.Animation.binarySearch=function(t,e,r){var i=0;var n=Math.floor(t.length/r)-2;if(!n)return r;var o=n>>>1;while(true){if(t[(o+1)*r]<=e)i=o+1;else n=o;if(i==n)return(i+1)*r;o=i+n>>>1}};n.Animation.binarySearch1=function(t,e){var r=0;var i=t.length-2;if(!i)return 1;var n=i>>>1;while(true){if(t[n+1]<=e)r=n+1;else i=n;if(r==i)return r+1;n=r+i>>>1}};n.Animation.linearSearch=function(t,e,r){for(var i=0,n=t.length-r;i<=n;i+=r)if(t[i]>e)return i;return-1};n.Curves=function(t){this.curves=[]};n.Curves.prototype={setLinear:function(t){this.curves[t*19]=0},setStepped:function(t){this.curves[t*19]=1},setCurve:function(t,e,r,i,n){var o=1/10,s=o*o,a=s*o;var l=3*o,h=3*s,u=6*s,c=6*a;var f=-e*2+i,d=-r*2+n,p=(e-i)*3+1,v=(r-n)*3+1;var g=e*l+f*h+p*a,m=r*l+d*h+v*a;var y=f*u+p*c,x=d*u+v*c;var _=p*c,b=v*c;var T=t*19;var w=this.curves;w[T++]=2;var E=g,S=m;for(var C=T+19-1;T<C;T+=2){w[T]=E;w[T+1]=S;g+=y;m+=x;y+=_;x+=b;E+=g;S+=m}},getCurvePercent:function(t,e){e=e<0?0:e>1?1:e;var r=this.curves;var i=t*19;var n=r[i];if(n===0)return e;if(n==1)return 0;i++;var o=0;for(var s=i,a=i+19-1;i<a;i+=2){o=r[i];if(o>=e){var l,h;if(i==s){l=0;h=0}else{l=r[i-2];h=r[i-1]}return h+(r[i+1]-h)*(e-l)/(o-l)}}var u=r[i-1];return u+(1-u)*(e-o)/(1-o)}};n.RotateTimeline=function(t){this.curves=new n.Curves(t);this.frames=[];this.frames.length=t*2};n.RotateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,r){t*=2;this.frames[t]=e;this.frames[t+1]=r},apply:function(t,e,r,i,o){var s=this.frames;if(r<s[0])return;var a=t.bones[this.boneIndex];if(r>=s[s.length-2]){var l=a.data.rotation+s[s.length-1]-a.rotation;while(l>180)l-=360;while(l<-180)l+=360;a.rotation+=l*o;return}var h=n.Animation.binarySearch(s,r,2);var u=s[h-1];var c=s[h];var f=1-(r-c)/(s[h-2]-c);f=this.curves.getCurvePercent(h/2-1,f);var l=s[h+1]-u;while(l>180)l-=360;while(l<-180)l+=360;l=a.data.rotation+(u+l*f)-a.rotation;while(l>180)l-=360;while(l<-180)l+=360;a.rotation+=l*o}};n.TranslateTimeline=function(t){this.curves=new n.Curves(t);this.frames=[];this.frames.length=t*3};n.TranslateTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,r,i){t*=3;this.frames[t]=e;this.frames[t+1]=r;this.frames[t+2]=i},apply:function(t,e,r,i,o){var s=this.frames;if(r<s[0])return;var a=t.bones[this.boneIndex];if(r>=s[s.length-3]){a.x+=(a.data.x+s[s.length-2]-a.x)*o;a.y+=(a.data.y+s[s.length-1]-a.y)*o;return}var l=n.Animation.binarySearch(s,r,3);var h=s[l-2];var u=s[l-1];var c=s[l];var f=1-(r-c)/(s[l+-3]-c);f=this.curves.getCurvePercent(l/3-1,f);a.x+=(a.data.x+h+(s[l+1]-h)*f-a.x)*o;a.y+=(a.data.y+u+(s[l+2]-u)*f-a.y)*o}};n.ScaleTimeline=function(t){this.curves=new n.Curves(t);this.frames=[];this.frames.length=t*3};n.ScaleTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,r,i){t*=3;this.frames[t]=e;this.frames[t+1]=r;this.frames[t+2]=i},apply:function(t,e,r,i,o){var s=this.frames;if(r<s[0])return;var a=t.bones[this.boneIndex];if(r>=s[s.length-3]){a.scaleX+=(a.data.scaleX*s[s.length-2]-a.scaleX)*o;a.scaleY+=(a.data.scaleY*s[s.length-1]-a.scaleY)*o;return}var l=n.Animation.binarySearch(s,r,3);var h=s[l-2];var u=s[l-1];var c=s[l];var f=1-(r-c)/(s[l+-3]-c);f=this.curves.getCurvePercent(l/3-1,f);a.scaleX+=(a.data.scaleX*(h+(s[l+1]-h)*f)-a.scaleX)*o;a.scaleY+=(a.data.scaleY*(u+(s[l+2]-u)*f)-a.scaleY)*o}};n.ColorTimeline=function(t){this.curves=new n.Curves(t);this.frames=[];this.frames.length=t*5};n.ColorTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length/5},setFrame:function(t,e,r,i,n,o){t*=5;this.frames[t]=e;this.frames[t+1]=r;this.frames[t+2]=i;this.frames[t+3]=n;this.frames[t+4]=o},apply:function(t,e,r,i,o){var s=this.frames;if(r<s[0])return;var a,l,h,u;if(r>=s[s.length-5]){var c=s.length-1;a=s[c-3];l=s[c-2];h=s[c-1];u=s[c]}else{var f=n.Animation.binarySearch(s,r,5);var d=s[f-4];var p=s[f-3];var v=s[f-2];var g=s[f-1];var m=s[f];var y=1-(r-m)/(s[f-5]-m);y=this.curves.getCurvePercent(f/5-1,y);a=d+(s[f+1]-d)*y;l=p+(s[f+2]-p)*y;h=v+(s[f+3]-v)*y;u=g+(s[f+4]-g)*y}var x=t.slots[this.slotIndex];if(o<1){x.r+=(a-x.r)*o;x.g+=(l-x.g)*o;x.b+=(h-x.b)*o;x.a+=(u-x.a)*o}else{x.r=a;x.g=l;x.b=h;x.a=u}}};n.AttachmentTimeline=function(t){this.curves=new n.Curves(t);this.frames=[];this.frames.length=t;this.attachmentNames=[];this.attachmentNames.length=t};n.AttachmentTimeline.prototype={slotIndex:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,r){this.frames[t]=e;this.attachmentNames[t]=r},apply:function(t,e,r,i,o){var s=this.frames;if(r<s[0]){if(e>r)this.apply(t,e,Number.MAX_VALUE,null,0);return}else if(e>r)e=-1;var a=r>=s[s.length-1]?s.length-1:n.Animation.binarySearch1(s,r)-1;if(s[a]<e)return;var l=this.attachmentNames[a];t.slots[this.slotIndex].setAttachment(!l?null:t.getAttachmentBySlotIndex(this.slotIndex,l))}};n.EventTimeline=function(t){this.frames=[];this.frames.length=t;this.events=[];this.events.length=t};n.EventTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(t,e,r){this.frames[t]=e;this.events[t]=r},apply:function(t,e,r,i,o){if(!i)return;var s=this.frames;var a=s.length;if(e>r){this.apply(t,e,Number.MAX_VALUE,i,o);e=-1}else if(e>=s[a-1])return;if(r<s[0])return;var l;if(e<s[0])l=0;else{l=n.Animation.binarySearch1(s,e);var h=s[l];while(l>0){if(s[l-1]!=h)break;l--}}var u=this.events;for(;l<a&&r>=s[l];l++)i.push(u[l])}};n.DrawOrderTimeline=function(t){this.frames=[];this.frames.length=t;this.drawOrders=[];this.drawOrders.length=t};n.DrawOrderTimeline.prototype={getFrameCount:function(){return this.frames.length},setFrame:function(t,e,r){this.frames[t]=e;this.drawOrders[t]=r},apply:function(t,e,r,i,o){var s=this.frames;if(r<s[0])return;var a;if(r>=s[s.length-1])a=s.length-1;else a=n.Animation.binarySearch1(s,r)-1;var l=t.drawOrder;var h=t.slots;var u=this.drawOrders[a];if(!u){for(var c=0,f=h.length;c<f;c++)l[c]=h[c]}else{for(var c=0,f=u.length;c<f;c++)l[c]=t.slots[u[c]]}}};n.FfdTimeline=function(t){this.curves=new n.Curves(t);this.frames=[];this.frames.length=t;this.frameVertices=[];this.frameVertices.length=t};n.FfdTimeline.prototype={slotIndex:0,attachment:0,getFrameCount:function(){return this.frames.length},setFrame:function(t,e,r){this.frames[t]=e;this.frameVertices[t]=r},apply:function(t,e,r,i,o){var s=t.slots[this.slotIndex];if(s.attachment!=this.attachment)return;var a=this.frames;if(r<a[0])return;var l=this.frameVertices;var h=l[0].length;var u=s.attachmentVertices;if(u.length!=h)o=1;u.length=h;if(r>=a[a.length-1]){var c=l[a.length-1];if(o<1){for(var f=0;f<h;f++)u[f]+=(c[f]-u[f])*o}else{for(var f=0;f<h;f++)u[f]=c[f]}return}var d=n.Animation.binarySearch1(a,r);var p=a[d];var v=1-(r-p)/(a[d-1]-p);v=this.curves.getCurvePercent(d-1,v<0?0:v>1?1:v);var g=l[d-1];var m=l[d];if(o<1){for(var f=0;f<h;f++){var y=g[f];u[f]+=(y+(m[f]-y)*v-u[f])*o}}else{for(var f=0;f<h;f++){var y=g[f];u[f]=y+(m[f]-y)*v}}}};n.IkConstraintTimeline=function(t){this.curves=new n.Curves(t);this.frames=[];this.frames.length=t*3};n.IkConstraintTimeline.prototype={ikConstraintIndex:0,getFrameCount:function(){return this.frames.length/3},setFrame:function(t,e,r,i){t*=3;this.frames[t]=e;this.frames[t+1]=r;this.frames[t+2]=i},apply:function(t,e,r,i,o){var s=this.frames;if(r<s[0])return;var a=t.ikConstraints[this.ikConstraintIndex];if(r>=s[s.length-3]){a.mix+=(s[s.length-2]-a.mix)*o;a.bendDirection=s[s.length-1];return}var l=n.Animation.binarySearch(s,r,3);var h=s[l+-2];var u=s[l];var c=1-(r-u)/(s[l+-3]-u);c=this.curves.getCurvePercent(l/3-1,c);var f=h+(s[l+1]-h)*c;a.mix+=(f-a.mix)*o;a.bendDirection=s[l+-1]}};n.FlipXTimeline=function(t){this.curves=new n.Curves(t);this.frames=[];this.frames.length=t*2};n.FlipXTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,r){t*=2;this.frames[t]=e;this.frames[t+1]=r?1:0},apply:function(t,e,r,i,o){var s=this.frames;if(r<s[0]){if(e>r)this.apply(t,e,Number.MAX_VALUE,null,0);return}else if(e>r)e=-1;var a=(r>=s[s.length-2]?s.length:n.Animation.binarySearch(s,r,2))-2;if(s[a]<e)return;t.bones[boneIndex].flipX=s[a+1]!=0}};n.FlipYTimeline=function(t){this.curves=new n.Curves(t);this.frames=[];this.frames.length=t*2};n.FlipYTimeline.prototype={boneIndex:0,getFrameCount:function(){return this.frames.length/2},setFrame:function(t,e,r){t*=2;this.frames[t]=e;this.frames[t+1]=r?1:0},apply:function(t,e,r,i,o){var s=this.frames;if(r<s[0]){if(e>r)this.apply(t,e,Number.MAX_VALUE,null,0);return}else if(e>r)e=-1;var a=(r>=s[s.length-2]?s.length:n.Animation.binarySearch(s,r,2))-2;if(s[a]<e)return;t.bones[boneIndex].flipY=s[a+1]!=0}};n.SkeletonData=function(){this.bones=[];this.slots=[];this.skins=[];this.events=[];this.animations=[];this.ikConstraints=[]};n.SkeletonData.prototype={name:null,defaultSkin:null,width:0,height:0,version:null,hash:null,findBone:function(t){var e=this.bones;for(var r=0,i=e.length;r<i;r++)if(e[r].name==t)return e[r];return null},findBoneIndex:function(t){var e=this.bones;for(var r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},findSlot:function(t){var e=this.slots;for(var r=0,i=e.length;r<i;r++){if(e[r].name==t)return slot[r]}return null},findSlotIndex:function(t){var e=this.slots;for(var r=0,i=e.length;r<i;r++)if(e[r].name==t)return r;return-1},findSkin:function(t){var e=this.skins;for(var r=0,i=e.length;r<i;r++)if(e[r].name==t)return e[r];return null},findEvent:function(t){var e=this.events;for(var r=0,i=e.length;r<i;r++)if(e[r].name==t)return e[r];return null},findAnimation:function(t){var e=this.animations;for(var r=0,i=e.length;r<i;r++)if(e[r].name==t)return e[r];return null},findIkConstraint:function(t){var e=this.ikConstraints;for(var r=0,i=e.length;r<i;r++)if(e[r].name==t)return e[r];return null}};n.Skeleton=function(t){this.data=t;this.bones=[];for(var e=0,r=t.bones.length;e<r;e++){var i=t.bones[e];var o=!i.parent?null:this.bones[t.bones.indexOf(i.parent)];this.bones.push(new n.Bone(i,this,o))}this.slots=[];this.drawOrder=[];for(var e=0,r=t.slots.length;e<r;e++){var s=t.slots[e];var a=this.bones[t.bones.indexOf(s.boneData)];var l=new n.Slot(s,a);this.slots.push(l);this.drawOrder.push(l)}this.ikConstraints=[];for(var e=0,r=t.ikConstraints.length;e<r;e++)this.ikConstraints.push(new n.IkConstraint(t.ikConstraints[e],this));this.boneCache=[];this.updateCache()};n.Skeleton.prototype={x:0,y:0,skin:null,r:1,g:1,b:1,a:1,time:0,flipX:false,flipY:false,updateCache:function(){var t=this.ikConstraints;var e=t.length;var r=e+1;var i=this.boneCache;if(i.length>r)i.length=r;for(var n=0,o=i.length;n<o;n++)i[n].length=0;while(i.length<r)i[i.length]=[];var s=i[0];var a=this.bones;t:for(var n=0,o=a.length;n<o;n++){var l=a[n];var h=l;do{for(var u=0;u<e;u++){var c=t[u];var f=c.bones[0];var d=c.bones[c.bones.length-1];while(true){if(h==d){i[u].push(l);i[u+1].push(l);continue t}if(d==f)break;d=d.parent}}h=h.parent}while(h);s[s.length]=l}},updateWorldTransform:function(){var t=this.bones;for(var e=0,r=t.length;e<r;e++){var i=t[e];i.rotationIK=i.rotation}var e=0,n=this.boneCache.length-1;while(true){var o=this.boneCache[e];for(var s=0,a=o.length;s<a;s++)o[s].updateWorldTransform();if(e==n)break;this.ikConstraints[e].apply();e++}},setToSetupPose:function(){this.setBonesToSetupPose();this.setSlotsToSetupPose()},setBonesToSetupPose:function(){var t=this.bones;for(var e=0,r=t.length;e<r;e++)t[e].setToSetupPose();var i=this.ikConstraints;for(var e=0,r=i.length;e<r;e++){var n=i[e];n.bendDirection=n.data.bendDirection;n.mix=n.data.mix}},setSlotsToSetupPose:function(){var t=this.slots;var e=this.drawOrder;for(var r=0,i=t.length;r<i;r++){e[r]=t[r];t[r].setToSetupPose(r)}},getRootBone:function(){return this.bones.length?this.bones[0]:null},findBone:function(t){var e=this.bones;for(var r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return e[r];return null},findBoneIndex:function(t){var e=this.bones;for(var r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},findSlot:function(t){var e=this.slots;for(var r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return e[r];return null},findSlotIndex:function(t){var e=this.slots;for(var r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return r;return-1},setSkinByName:function(t){var e=this.data.findSkin(t);if(!e)throw"Skin not found: "+t;this.setSkin(e)},setSkin:function(t){if(t){if(this.skin)t._attachAll(this,this.skin);else{var e=this.slots;for(var r=0,i=e.length;r<i;r++){var n=e[r];var o=n.data.attachmentName;if(o){var s=t.getAttachment(r,o);if(s)n.setAttachment(s)}}}}this.skin=t},getAttachmentBySlotName:function(t,e){return this.getAttachmentBySlotIndex(this.data.findSlotIndex(t),e)},getAttachmentBySlotIndex:function(t,e){if(this.skin){var r=this.skin.getAttachment(t,e);if(r)return r}if(this.data.defaultSkin)return this.data.defaultSkin.getAttachment(t,e);return null},setAttachment:function(t,e){var r=this.slots;for(var i=0,n=r.length;i<n;i++){var o=r[i];if(o.data.name==t){var s=null;if(e){s=this.getAttachmentBySlotIndex(i,e);if(!s)throw"Attachment not found: "+e+", for slot: "+t}o.setAttachment(s);return}}throw"Slot not found: "+t},findIkConstraint:function(t){var e=this.ikConstraints;for(var r=0,i=e.length;r<i;r++)if(e[r].data.name==t)return e[r];return null},update:function(t){this.time+=t}};n.EventData=function(t){this.name=t};n.EventData.prototype={intValue:0,floatValue:0,stringValue:null};n.Event=function(t){this.data=t};n.Event.prototype={intValue:0,floatValue:0,stringValue:null};n.AttachmentType={region:0,boundingbox:1,mesh:2,skinnedmesh:3};n.RegionAttachment=function(t){this.name=t;this.offset=[];this.offset.length=8;this.uvs=[];this.uvs.length=8};n.RegionAttachment.prototype={type:n.AttachmentType.region,x:0,y:0,rotation:0,scaleX:1,scaleY:1,width:0,height:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,setUVs:function(t,e,r,i,n){var o=this.uvs;if(n){o[2]=t;o[3]=i;o[4]=t;o[5]=e;o[6]=r;o[7]=e;o[0]=r;o[1]=i}else{o[0]=t;o[1]=i;o[2]=t;o[3]=e;o[4]=r;o[5]=e;o[6]=r;o[7]=i}},updateOffset:function(){var t=this.width/this.regionOriginalWidth*this.scaleX;var e=this.height/this.regionOriginalHeight*this.scaleY;var r=-this.width/2*this.scaleX+this.regionOffsetX*t;var i=-this.height/2*this.scaleY+this.regionOffsetY*e;var o=r+this.regionWidth*t;var s=i+this.regionHeight*e;var a=this.rotation*n.degRad;var l=Math.cos(a);var h=Math.sin(a);var u=r*l+this.x;var c=r*h;var f=i*l+this.y;var d=i*h;var p=o*l+this.x;var v=o*h;var g=s*l+this.y;var m=s*h;var y=this.offset;y[0]=u-d;y[1]=f+c;y[2]=u-m;y[3]=g+c;y[4]=p-m;y[5]=g+v;y[6]=p-d;y[7]=f+v},computeVertices:function(t,e,r,i){t+=r.worldX;e+=r.worldY;var n=r.m00,o=r.m01,s=r.m10,a=r.m11;var l=this.offset;i[0]=l[0]*n+l[1]*o+t;i[1]=l[0]*s+l[1]*a+e;i[2]=l[2]*n+l[3]*o+t;i[3]=l[2]*s+l[3]*a+e;i[4]=l[4]*n+l[5]*o+t;i[5]=l[4]*s+l[5]*a+e;i[6]=l[6]*n+l[7]*o+t;i[7]=l[6]*s+l[7]*a+e}};n.MeshAttachment=function(t){this.name=t};n.MeshAttachment.prototype={type:n.AttachmentType.mesh,vertices:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:false,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(){var t=this.regionU2-this.regionU,e=this.regionV2-this.regionV;var r=this.regionUVs.length;if(!this.uvs||this.uvs.length!=r){this.uvs=new n.Float32Array(r)}if(this.regionRotate){for(var i=0;i<r;i+=2){this.uvs[i]=this.regionU+this.regionUVs[i+1]*t;this.uvs[i+1]=this.regionV+e-this.regionUVs[i]*e}}else{for(var i=0;i<r;i+=2){this.uvs[i]=this.regionU+this.regionUVs[i]*t;this.uvs[i+1]=this.regionV+this.regionUVs[i+1]*e}}},computeWorldVertices:function(t,e,r,i){var n=r.bone;t+=n.worldX;e+=n.worldY;var o=n.m00,s=n.m01,a=n.m10,l=n.m11;var h=this.vertices;var u=h.length;if(r.attachmentVertices.length==u)h=r.attachmentVertices;for(var c=0;c<u;c+=2){var f=h[c];var d=h[c+1];i[c]=f*o+d*s+t;i[c+1]=f*a+d*l+e}}};n.SkinnedMeshAttachment=function(t){this.name=t};n.SkinnedMeshAttachment.prototype={type:n.AttachmentType.skinnedmesh,bones:null,weights:null,uvs:null,regionUVs:null,triangles:null,hullLength:0,r:1,g:1,b:1,a:1,path:null,rendererObject:null,regionU:0,regionV:0,regionU2:0,regionV2:0,regionRotate:false,regionOffsetX:0,regionOffsetY:0,regionWidth:0,regionHeight:0,regionOriginalWidth:0,regionOriginalHeight:0,edges:null,width:0,height:0,updateUVs:function(t,e,r,i,o){var s=this.regionU2-this.regionU,a=this.regionV2-this.regionV;var l=this.regionUVs.length;if(!this.uvs||this.uvs.length!=l){this.uvs=new n.Float32Array(l)}if(this.regionRotate){for(var h=0;h<l;h+=2){this.uvs[h]=this.regionU+this.regionUVs[h+1]*s;this.uvs[h+1]=this.regionV+a-this.regionUVs[h]*a}}else{for(var h=0;h<l;h+=2){this.uvs[h]=this.regionU+this.regionUVs[h]*s;this.uvs[h+1]=this.regionV+this.regionUVs[h+1]*a}}},computeWorldVertices:function(t,e,r,i){var n=r.bone.skeleton.bones;var o=this.weights;var s=this.bones;var a=0,l=0,h=0,u=0,c=s.length,f;var d,p,v,g,m,y;if(!r.attachmentVertices.length){for(;l<c;a+=2){d=0;p=0;f=s[l++]+l;for(;l<f;l++,h+=3){v=n[s[l]];g=o[h];m=o[h+1];y=o[h+2];d+=(g*v.m00+m*v.m01+v.worldX)*y;p+=(g*v.m10+m*v.m11+v.worldY)*y}i[a]=d+t;i[a+1]=p+e}}else{var x=r.attachmentVertices;for(;l<c;a+=2){d=0;p=0;f=s[l++]+l;for(;l<f;l++,h+=3,u+=2){v=n[s[l]];g=o[h]+x[u];m=o[h+1]+x[u+1];y=o[h+2];d+=(g*v.m00+m*v.m01+v.worldX)*y;p+=(g*v.m10+m*v.m11+v.worldY)*y}i[a]=d+t;i[a+1]=p+e}}}};n.BoundingBoxAttachment=function(t){this.name=t;this.vertices=[]};n.BoundingBoxAttachment.prototype={type:n.AttachmentType.boundingbox,computeWorldVertices:function(t,e,r,i){t+=r.worldX;e+=r.worldY;var n=r.m00,o=r.m01,s=r.m10,a=r.m11;var l=this.vertices;for(var h=0,u=l.length;h<u;h+=2){var c=l[h];var f=l[h+1];i[h]=c*n+f*o+t;i[h+1]=c*s+f*a+e}}};n.AnimationStateData=function(t){this.skeletonData=t;this.animationToMixTime={}};n.AnimationStateData.prototype={defaultMix:0,setMixByName:function(t,e,r){var i=this.skeletonData.findAnimation(t);if(!i)throw"Animation not found: "+t;var n=this.skeletonData.findAnimation(e);if(!n)throw"Animation not found: "+e;this.setMix(i,n,r)},setMix:function(t,e,r){this.animationToMixTime[t.name+":"+e.name]=r},getMix:function(t,e){var r=t.name+":"+e.name;return this.animationToMixTime.hasOwnProperty(r)?this.animationToMixTime[r]:this.defaultMix}};n.TrackEntry=function(){};n.TrackEntry.prototype={next:null,previous:null,animation:null,loop:false,delay:0,time:0,lastTime:-1,endTime:0,timeScale:1,mixTime:0,mixDuration:0,mix:1,onStart:null,onEnd:null,onComplete:null,onEvent:null};n.AnimationState=function(t){this.data=t;this.tracks=[];this.events=[]};n.AnimationState.prototype={onStart:null,onEnd:null,onComplete:null,onEvent:null,timeScale:1,update:function(t){t*=this.timeScale;for(var e=0;e<this.tracks.length;e++){var r=this.tracks[e];if(!r)continue;r.time+=t*r.timeScale;if(r.previous){var i=t*r.previous.timeScale;r.previous.time+=i;r.mixTime+=i}var n=r.next;if(n){n.time=r.lastTime-n.delay;if(n.time>=0)this.setCurrent(e,n)}else{if(!r.loop&&r.lastTime>=r.endTime)this.clearTrack(e)}}},apply:function(t){for(var e=0;e<this.tracks.length;e++){var r=this.tracks[e];if(!r)continue;this.events.length=0;var i=r.time;var n=r.lastTime;var o=r.endTime;var s=r.loop;if(!s&&i>o)i=o;var a=r.previous;if(!a){if(r.mix==1)r.animation.apply(t,r.lastTime,i,s,this.events);else r.animation.mix(t,r.lastTime,i,s,this.events,r.mix)}else{var l=a.time;if(!a.loop&&l>a.endTime)l=a.endTime;a.animation.apply(t,l,l,a.loop,null);var h=r.mixTime/r.mixDuration*r.mix;if(h>=1){h=1;r.previous=null}r.animation.mix(t,r.lastTime,i,s,this.events,h)}for(var u=0,c=this.events.length;u<c;u++){var f=this.events[u];if(r.onEvent)r.onEvent(e,f);if(this.onEvent)this.onEvent(e,f)}if(s?n%o>i%o:n<o&&i>=o){var d=Math.floor(i/o);if(r.onComplete)r.onComplete(e,d);if(this.onComplete)this.onComplete(e,d)}r.lastTime=r.time}},clearTracks:function(){for(var t=0,e=this.tracks.length;t<e;t++)this.clearTrack(t);this.tracks.length=0},clearTrack:function(t){if(t>=this.tracks.length)return;var e=this.tracks[t];if(!e)return;if(e.onEnd)e.onEnd(t);if(this.onEnd)this.onEnd(t);this.tracks[t]=null},_expandToIndex:function(t){if(t<this.tracks.length)return this.tracks[t];while(t>=this.tracks.length)this.tracks.push(null);return null},setCurrent:function(t,e){var r=this._expandToIndex(t);if(r){var i=r.previous;r.previous=null;if(r.onEnd)r.onEnd(t);if(this.onEnd)this.onEnd(t);e.mixDuration=this.data.getMix(r.animation,e.animation);if(e.mixDuration>0){e.mixTime=0;if(i&&r.mixTime/r.mixDuration<.5)e.previous=i;else e.previous=r}}this.tracks[t]=e;if(e.onStart)e.onStart(t);if(this.onStart)this.onStart(t)},setAnimationByName:function(t,e,r){var i=this.data.skeletonData.findAnimation(e);if(!i)throw"Animation not found: "+e;return this.setAnimation(t,i,r)},setAnimation:function(t,e,r){var i=new n.TrackEntry;i.animation=e;i.loop=r;i.endTime=e.duration;this.setCurrent(t,i);return i},addAnimationByName:function(t,e,r,i){var n=this.data.skeletonData.findAnimation(e);if(!n)throw"Animation not found: "+e;return this.addAnimation(t,n,r,i)},addAnimation:function(t,e,r,i){var o=new n.TrackEntry;o.animation=e;o.loop=r;o.endTime=e.duration;var s=this._expandToIndex(t);if(s){while(s.next)s=s.next;s.next=o}else this.tracks[t]=o;if(i<=0){if(s)i+=s.endTime-this.data.getMix(s.animation,e);else i=0}o.delay=i;return o},getCurrent:function(t){if(t>=this.tracks.length)return null;return this.tracks[t]}};n.SkeletonJsonParser=function(t){this.attachmentLoader=t};n.SkeletonJsonParser.prototype={scale:1,readSkeletonData:function(t,e){var r=new n.SkeletonData;r.name=e;var i=t["skeleton"];if(i){r.hash=i["hash"];r.version=i["spine"];r.width=i["width"]||0;r.height=i["height"]||0}var o=t["bones"];for(var s=0,a=o.length;s<a;s++){var l=o[s];var h=null;if(l["parent"]){h=r.findBone(l["parent"]);if(!h)throw"Parent bone not found: "+l["parent"]}var u=new n.BoneData(l["name"],h);u.length=(l["length"]||0)*this.scale;u.x=(l["x"]||0)*this.scale;u.y=(l["y"]||0)*this.scale;u.rotation=l["rotation"]||0;u.scaleX=l.hasOwnProperty("scaleX")?l["scaleX"]:1;u.scaleY=l.hasOwnProperty("scaleY")?l["scaleY"]:1;u.inheritScale=l.hasOwnProperty("inheritScale")?l["inheritScale"]:true;u.inheritRotation=l.hasOwnProperty("inheritRotation")?l["inheritRotation"]:true;r.bones.push(u)}var c=t["ik"];if(c){for(var s=0,a=c.length;s<a;s++){var f=c[s];var d=new n.IkConstraintData(f["name"]);var o=f["bones"];for(var p=0,v=o.length;p<v;p++){var g=r.findBone(o[p]);if(!g)throw"IK bone not found: "+o[p];d.bones.push(g)}d.target=r.findBone(f["target"]);if(!d.target)throw"Target bone not found: "+f["target"];d.bendDirection=!f.hasOwnProperty("bendPositive")||f["bendPositive"]?1:-1;d.mix=f.hasOwnProperty("mix")?f["mix"]:1;r.ikConstraints.push(d)}}var m=t["slots"];for(var s=0,a=m.length;s<a;s++){var y=m[s];var u=r.findBone(y["bone"]);if(!u)throw"Slot bone not found: "+y["bone"];var x=new n.SlotData(y["name"],u);var _=y["color"];if(_){x.r=this.toColor(_,0);x.g=this.toColor(_,1);x.b=this.toColor(_,2);x.a=this.toColor(_,3)}x.attachmentName=y["attachment"];x.additiveBlending=y["additive"]&&y["additive"]=="true";r.slots.push(x)}var b=t["skins"];for(var T in b){if(!b.hasOwnProperty(T))continue;var w=b[T];var E=new n.Skin(T);for(var S in w){if(!w.hasOwnProperty(S))continue;var C=r.findSlotIndex(S);var A=w[S];for(var R in A){if(!A.hasOwnProperty(R))continue;var M=this.readAttachment(E,R,A[R]);if(M)E.addAttachment(C,R,M)}}r.skins.push(E);if(E.name=="default")r.defaultSkin=E}var O=t["events"];for(var D in O){if(!O.hasOwnProperty(D))continue;var F=O[D];var P=new n.EventData(D);P.intValue=F["int"]||0;P.floatValue=F["float"]||0;P.stringValue=F["string"]||null;r.events.push(P)}var B=t["animations"];for(var L in B){if(!B.hasOwnProperty(L))continue;this.readAnimation(L,B[L],r)}return r},readAttachment:function(t,e,r){e=r["name"]||e;var i=n.AttachmentType[r["type"]||"region"];var o=r["path"]||e;var s=this.scale;if(i==n.AttachmentType.region){var a=this.attachmentLoader.newRegionAttachment(t,e,o);if(!a)return null;a.path=o;a.x=(r["x"]||0)*s;a.y=(r["y"]||0)*s;a.scaleX=r.hasOwnProperty("scaleX")?r["scaleX"]:1;a.scaleY=r.hasOwnProperty("scaleY")?r["scaleY"]:1;a.rotation=r["rotation"]||0;a.width=(r["width"]||0)*s;a.height=(r["height"]||0)*s;var l=r["color"];if(l){a.r=this.toColor(l,0);a.g=this.toColor(l,1);a.b=this.toColor(l,2);a.a=this.toColor(l,3)}a.updateOffset();return a}else if(i==n.AttachmentType.mesh){var h=this.attachmentLoader.newMeshAttachment(t,e,o);if(!h)return null;h.path=o;h.vertices=this.getFloatArray(r,"vertices",s);h.triangles=this.getIntArray(r,"triangles");h.regionUVs=this.getFloatArray(r,"uvs",1);h.updateUVs();l=r["color"];if(l){h.r=this.toColor(l,0);h.g=this.toColor(l,1);h.b=this.toColor(l,2);h.a=this.toColor(l,3)}h.hullLength=(r["hull"]||0)*2;if(r["edges"])h.edges=this.getIntArray(r,"edges");h.width=(r["width"]||0)*s;h.height=(r["height"]||0)*s;return h}else if(i==n.AttachmentType.skinnedmesh){var h=this.attachmentLoader.newSkinnedMeshAttachment(t,e,o);if(!h)return null;h.path=o;var u=this.getFloatArray(r,"uvs",1);var c=this.getFloatArray(r,"vertices",1);var f=[];var d=[];for(var p=0,v=c.length;p<v;){var g=c[p++]|0;d[d.length]=g;for(var m=p+g*4;p<m;){d[d.length]=c[p];f[f.length]=c[p+1]*s;f[f.length]=c[p+2]*s;f[f.length]=c[p+3];p+=4}}h.bones=d;h.weights=f;h.triangles=this.getIntArray(r,"triangles");h.regionUVs=u;h.updateUVs();l=r["color"];if(l){h.r=this.toColor(l,0);h.g=this.toColor(l,1);h.b=this.toColor(l,2);h.a=this.toColor(l,3)}h.hullLength=(r["hull"]||0)*2;if(r["edges"])h.edges=this.getIntArray(r,"edges");h.width=(r["width"]||0)*s;h.height=(r["height"]||0)*s;return h}else if(i==n.AttachmentType.boundingbox){var y=this.attachmentLoader.newBoundingBoxAttachment(t,e);var c=r["vertices"];for(var p=0,v=c.length;p<v;p++)y.vertices.push(c[p]*s);return y}throw"Unknown attachment type: "+i},readAnimation:function(t,e,r){var i=[];var o=0;var s=e["slots"];for(var a in s){if(!s.hasOwnProperty(a))continue;var l=s[a];var h=r.findSlotIndex(a);for(var u in l){if(!l.hasOwnProperty(u))continue;var c=l[u];if(u=="color"){var f=new n.ColorTimeline(c.length);f.slotIndex=h;var d=0;for(var p=0,v=c.length;p<v;p++){var g=c[p];var m=g["color"];var y=this.toColor(m,0);var x=this.toColor(m,1);var _=this.toColor(m,2);var b=this.toColor(m,3);f.setFrame(d,g["time"],y,x,_,b);this.readCurve(f,d,g);d++}i.push(f);o=Math.max(o,f.frames[f.getFrameCount()*5-5])}else if(u=="attachment"){var f=new n.AttachmentTimeline(c.length);f.slotIndex=h;var d=0;for(var p=0,v=c.length;p<v;p++){var g=c[p];f.setFrame(d++,g["time"],g["name"])}i.push(f);o=Math.max(o,f.frames[f.getFrameCount()-1])}else throw"Invalid timeline type for a slot: "+u+" ("+a+")"}}var T=e["bones"];for(var w in T){if(!T.hasOwnProperty(w))continue;var E=r.findBoneIndex(w);if(E==-1)throw"Bone not found: "+w;var S=T[w];for(var u in S){if(!S.hasOwnProperty(u))continue;var c=S[u];if(u=="rotate"){var f=new n.RotateTimeline(c.length);f.boneIndex=E;var d=0;for(var p=0,v=c.length;p<v;p++){var g=c[p];f.setFrame(d,g["time"],g["angle"]);this.readCurve(f,d,g);d++}i.push(f);o=Math.max(o,f.frames[f.getFrameCount()*2-2])}else if(u=="translate"||u=="scale"){var f;var C=1;if(u=="scale")f=new n.ScaleTimeline(c.length);else{f=new n.TranslateTimeline(c.length);C=this.scale}f.boneIndex=E;var d=0;for(var p=0,v=c.length;p<v;p++){var g=c[p];var A=(g["x"]||0)*C;var R=(g["y"]||0)*C;f.setFrame(d,g["time"],A,R);this.readCurve(f,d,g);d++}i.push(f);o=Math.max(o,f.frames[f.getFrameCount()*3-3])}else if(u=="flipX"||u=="flipY"){var A=u=="flipX";var f=A?new n.FlipXTimeline(c.length):new n.FlipYTimeline(c.length);f.boneIndex=E;var M=A?"x":"y";var d=0;for(var p=0,v=c.length;p<v;p++){var g=c[p];f.setFrame(d,g["time"],g[M]||false);d++}i.push(f);o=Math.max(o,f.frames[f.getFrameCount()*2-2])}else throw"Invalid timeline type for a bone: "+u+" ("+w+")"}}var O=e["ik"];for(var D in O){if(!O.hasOwnProperty(D))continue;var F=r.findIkConstraint(D);var c=O[D];var f=new n.IkConstraintTimeline(c.length);f.ikConstraintIndex=r.ikConstraints.indexOf(F);var d=0;for(var p=0,v=c.length;p<v;p++){var g=c[p];var P=g.hasOwnProperty("mix")?g["mix"]:1;var B=!g.hasOwnProperty("bendPositive")||g["bendPositive"]?1:-1;f.setFrame(d,g["time"],P,B);this.readCurve(f,d,g);d++}i.push(f);o=Math.max(o,f.frames[f.frameCount*3-3])}var L=e["ffd"];for(var k in L){var I=r.findSkin(k);var l=L[k];for(a in l){var h=r.findSlotIndex(a);var N=l[a];for(var U in N){var c=N[U];var f=new n.FfdTimeline(c.length);var j=I.getAttachment(h,U);if(!j)throw"FFD attachment not found: "+U;f.slotIndex=h;f.attachment=j;var X=j.type==n.AttachmentType.mesh;var Y;if(X)Y=j.vertices.length;else Y=j.weights.length/3*2;var d=0;for(var p=0,v=c.length;p<v;p++){var g=c[p];var W;if(!g["vertices"]){if(X)W=j.vertices;else{W=[];W.length=Y}}else{var z=g["vertices"];var W=[];W.length=Y;var G=g["offset"]||0;var H=z.length;if(this.scale==1){for(var V=0;V<H;V++)W[V+G]=z[V]}else{for(var V=0;V<H;V++)W[V+G]=z[V]*this.scale}if(X){var q=j.vertices;for(var V=0,H=W.length;V<H;V++)W[V]+=q[V]}}f.setFrame(d,g["time"],W);this.readCurve(f,d,g);d++}i[i.length]=f;o=Math.max(o,f.frames[f.frameCount-1])}}}var K=e["drawOrder"];if(!K)K=e["draworder"];if(K){var f=new n.DrawOrderTimeline(K.length);var Q=r.slots.length;var d=0;for(var p=0,v=K.length;p<v;p++){var J=K[p];var $=null;if(J["offsets"]){$=[];$.length=Q;for(var V=Q-1;V>=0;V--)$[V]=-1;var Z=J["offsets"];var tt=[];tt.length=Q-Z.length;var et=0,rt=0;for(var V=0,H=Z.length;V<H;V++){var it=Z[V];var h=r.findSlotIndex(it["slot"]);

if(h==-1)throw"Slot not found: "+it["slot"];while(et!=h)tt[rt++]=et++;$[et+it["offset"]]=et++}while(et<Q)tt[rt++]=et++;for(var V=Q-1;V>=0;V--)if($[V]==-1)$[V]=tt[--rt]}f.setFrame(d++,J["time"],$)}i.push(f);o=Math.max(o,f.frames[f.getFrameCount()-1])}var nt=e["events"];if(nt){var f=new n.EventTimeline(nt.length);var d=0;for(var p=0,v=nt.length;p<v;p++){var ot=nt[p];var st=r.findEvent(ot["name"]);if(!st)throw"Event not found: "+ot["name"];var at=new n.Event(st);at.intValue=ot.hasOwnProperty("int")?ot["int"]:st.intValue;at.floatValue=ot.hasOwnProperty("float")?ot["float"]:st.floatValue;at.stringValue=ot.hasOwnProperty("string")?ot["string"]:st.stringValue;f.setFrame(d++,ot["time"],at)}i.push(f);o=Math.max(o,f.frames[f.getFrameCount()-1])}r.animations.push(new n.Animation(t,i,o))},readCurve:function(t,e,r){var i=r["curve"];if(!i)t.curves.setLinear(e);else if(i=="stepped")t.curves.setStepped(e);else if(i instanceof Array)t.curves.setCurve(e,i[0],i[1],i[2],i[3])},toColor:function(t,e){if(t.length!=8)throw"Color hexidecimal length must be 8, recieved: "+t;return parseInt(t.substring(e*2,e*2+2),16)/255},getFloatArray:function(t,e,r){var i=t[e];var o=new n.Float32Array(i.length);var s=0,a=i.length;if(r==1){for(;s<a;s++)o[s]=i[s]}else{for(;s<a;s++)o[s]=i[s]*r}return o},getIntArray:function(t,e){var r=t[e];var i=new n.Uint16Array(r.length);for(var o=0,s=r.length;o<s;o++)i[o]=r[o]|0;return i}};n.Atlas=function(t,e,r){if(e&&e.indexOf("/")!==e.length){e+="/"}this.pages=[];this.regions=[];this.texturesLoading=0;var o=this;var s=new n.AtlasReader(t);var a=[];a.length=4;var l=null;while(true){var h=s.readLine();if(h===null)break;h=s.trim(h);if(!h.length)l=null;else if(!l){l=new n.AtlasPage;l.name=h;if(s.readTuple(a)==2){l.width=parseInt(a[0]);l.height=parseInt(a[1]);s.readTuple(a)}l.format=n.Atlas.Format[a[0]];s.readTuple(a);l.minFilter=n.Atlas.TextureFilter[a[0]];l.magFilter=n.Atlas.TextureFilter[a[1]];var u=s.readValue();l.uWrap=n.Atlas.TextureWrap.clampToEdge;l.vWrap=n.Atlas.TextureWrap.clampToEdge;if(u=="x")l.uWrap=n.Atlas.TextureWrap.repeat;else if(u=="y")l.vWrap=n.Atlas.TextureWrap.repeat;else if(u=="xy")l.uWrap=l.vWrap=n.Atlas.TextureWrap.repeat;l.rendererObject=i.BaseTexture.fromImage(e+h,r);this.pages.push(l)}else{var c=new n.AtlasRegion;c.name=h;c.page=l;c.rotate=s.readValue()=="true";s.readTuple(a);var f=parseInt(a[0]);var d=parseInt(a[1]);s.readTuple(a);var p=parseInt(a[0]);var v=parseInt(a[1]);c.u=f/l.width;c.v=d/l.height;if(c.rotate){c.u2=(f+v)/l.width;c.v2=(d+p)/l.height}else{c.u2=(f+p)/l.width;c.v2=(d+v)/l.height}c.x=f;c.y=d;c.width=Math.abs(p);c.height=Math.abs(v);if(s.readTuple(a)==4){c.splits=[parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3])];if(s.readTuple(a)==4){c.pads=[parseInt(a[0]),parseInt(a[1]),parseInt(a[2]),parseInt(a[3])];s.readTuple(a)}}c.originalWidth=parseInt(a[0]);c.originalHeight=parseInt(a[1]);s.readTuple(a);c.offsetX=parseInt(a[0]);c.offsetY=parseInt(a[1]);c.index=parseInt(s.readValue());this.regions.push(c)}}};n.Atlas.prototype={findRegion:function(t){var e=this.regions;for(var r=0,i=e.length;r<i;r++)if(e[r].name==t)return e[r];return null},dispose:function(){var t=this.pages;for(var e=0,r=t.length;e<r;e++)t[e].rendererObject.destroy(true)},updateUVs:function(t){var e=this.regions;for(var r=0,i=e.length;r<i;r++){var n=e[r];if(n.page!=t)continue;n.u=n.x/t.width;n.v=n.y/t.height;if(n.rotate){n.u2=(n.x+n.height)/t.width;n.v2=(n.y+n.width)/t.height}else{n.u2=(n.x+n.width)/t.width;n.v2=(n.y+n.height)/t.height}}}};n.Atlas.Format={alpha:0,intensity:1,luminanceAlpha:2,rgb565:3,rgba4444:4,rgb888:5,rgba8888:6};n.Atlas.TextureFilter={nearest:0,linear:1,mipMap:2,mipMapNearestNearest:3,mipMapLinearNearest:4,mipMapNearestLinear:5,mipMapLinearLinear:6};n.Atlas.TextureWrap={mirroredRepeat:0,clampToEdge:1,repeat:2};n.AtlasPage=function(){};n.AtlasPage.prototype={name:null,format:null,minFilter:null,magFilter:null,uWrap:null,vWrap:null,rendererObject:null,width:0,height:0};n.AtlasRegion=function(){};n.AtlasRegion.prototype={page:null,name:null,x:0,y:0,width:0,height:0,u:0,v:0,u2:0,v2:0,offsetX:0,offsetY:0,originalWidth:0,originalHeight:0,index:0,rotate:false,splits:null,pads:null};n.AtlasReader=function(t){this.lines=t.split(/\r\n|\r|\n/)};n.AtlasReader.prototype={index:0,trim:function(t){return t.replace(/^\s+|\s+$/g,"")},readLine:function(){if(this.index>=this.lines.length)return null;return this.lines[this.index++]},readValue:function(){var t=this.readLine();var e=t.indexOf(":");if(e==-1)throw"Invalid line: "+t;return this.trim(t.substring(e+1))},readTuple:function(t){var e=this.readLine();var r=e.indexOf(":");if(r==-1)throw"Invalid line: "+e;var i=0,n=r+1;for(;i<3;i++){var o=e.indexOf(",",n);if(o==-1)break;t[i]=this.trim(e.substr(n,o-n));n=o+1}t[i]=this.trim(e.substring(n));return i+1}};n.AtlasAttachmentParser=function(t){this.atlas=t};n.AtlasAttachmentParser.prototype={newRegionAttachment:function(t,e,r){var i=this.atlas.findRegion(r);if(!i)throw"Region not found in atlas: "+r+" (region attachment: "+e+")";var o=new n.RegionAttachment(e);o.rendererObject=i;o.setUVs(i.u,i.v,i.u2,i.v2,i.rotate);o.regionOffsetX=i.offsetX;o.regionOffsetY=i.offsetY;o.regionWidth=i.width;o.regionHeight=i.height;o.regionOriginalWidth=i.originalWidth;o.regionOriginalHeight=i.originalHeight;return o},newMeshAttachment:function(t,e,r){var i=this.atlas.findRegion(r);if(!i)throw"Region not found in atlas: "+r+" (mesh attachment: "+e+")";var o=new n.MeshAttachment(e);o.rendererObject=i;o.regionU=i.u;o.regionV=i.v;o.regionU2=i.u2;o.regionV2=i.v2;o.regionRotate=i.rotate;o.regionOffsetX=i.offsetX;o.regionOffsetY=i.offsetY;o.regionWidth=i.width;o.regionHeight=i.height;o.regionOriginalWidth=i.originalWidth;o.regionOriginalHeight=i.originalHeight;return o},newSkinnedMeshAttachment:function(t,e,r){var i=this.atlas.findRegion(r);if(!i)throw"Region not found in atlas: "+r+" (skinned mesh attachment: "+e+")";var o=new n.SkinnedMeshAttachment(e);o.rendererObject=i;o.regionU=i.u;o.regionV=i.v;o.regionU2=i.u2;o.regionV2=i.v2;o.regionRotate=i.rotate;o.regionOffsetX=i.offsetX;o.regionOffsetY=i.offsetY;o.regionWidth=i.width;o.regionHeight=i.height;o.regionOriginalWidth=i.originalWidth;o.regionOriginalHeight=i.originalHeight;return o},newBoundingBoxAttachment:function(t,e){return new n.BoundingBoxAttachment(e)}};n.SkeletonBounds=function(){this.polygonPool=[];this.polygons=[];this.boundingBoxes=[]};n.SkeletonBounds.prototype={minX:0,minY:0,maxX:0,maxY:0,update:function(t,e){var r=t.slots;var i=r.length;var o=t.x,s=t.y;var a=this.boundingBoxes;var l=this.polygonPool;var h=this.polygons;a.length=0;for(var u=0,c=h.length;u<c;u++)l.push(h[u]);h.length=0;for(var u=0;u<i;u++){var f=r[u];var d=f.attachment;if(d.type!=n.AttachmentType.boundingbox)continue;a.push(d);var p=l.length,v;if(p>0){v=l[p-1];l.splice(p-1,1)}else v=[];h.push(v);v.length=d.vertices.length;d.computeWorldVertices(o,s,f.bone,v)}if(e)this.aabbCompute()},aabbCompute:function(){var t=this.polygons;var e=Number.MAX_VALUE,r=Number.MAX_VALUE,i=Number.MIN_VALUE,n=Number.MIN_VALUE;for(var o=0,s=t.length;o<s;o++){var a=t[o];for(var l=0,h=a.length;l<h;l+=2){var u=a[l];var c=a[l+1];e=Math.min(e,u);r=Math.min(r,c);i=Math.max(i,u);n=Math.max(n,c)}}this.minX=e;this.minY=r;this.maxX=i;this.maxY=n},aabbContainsPoint:function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY},aabbIntersectsSegment:function(t,e,r,i){var n=this.minX,o=this.minY,s=this.maxX,a=this.maxY;if(t<=n&&r<=n||e<=o&&i<=o||t>=s&&r>=s||e>=a&&i>=a)return false;var l=(i-e)/(r-t);var h=l*(n-t)+e;if(h>o&&h<a)return true;h=l*(s-t)+e;if(h>o&&h<a)return true;var u=(o-e)/l+t;if(u>n&&u<s)return true;u=(a-e)/l+t;if(u>n&&u<s)return true;return false},aabbIntersectsSkeleton:function(t){return this.minX<t.maxX&&this.maxX>t.minX&&this.minY<t.maxY&&this.maxY>t.minY},containsPoint:function(t,e){var r=this.polygons;for(var i=0,n=r.length;i<n;i++)if(this.polygonContainsPoint(r[i],t,e))return this.boundingBoxes[i];return null},intersectsSegment:function(t,e,r,i){var n=this.polygons;for(var o=0,s=n.length;o<s;o++)if(n[o].intersectsSegment(t,e,r,i))return this.boundingBoxes[o];return null},polygonContainsPoint:function(t,e,r){var i=t.length;var n=i-2;var o=false;for(var s=0;s<i;s+=2){var a=t[s+1];var l=t[n+1];if(a<r&&l>=r||l<r&&a>=r){var h=t[s];if(h+(r-a)/(l-a)*(t[n]-h)<e)o=!o}n=s}return o},polygonIntersectsSegment:function(t,e,r,i,n){var o=t.length;var s=e-i,a=r-n;var l=e*n-r*i;var h=t[o-2],u=t[o-1];for(var c=0;c<o;c+=2){var f=t[c],d=t[c+1];var p=h*d-u*f;var v=h-f,g=u-d;var m=s*g-a*v;var y=(l*v-s*p)/m;if((y>=h&&y<=f||y>=f&&y<=h)&&(y>=e&&y<=i||y>=i&&y<=e)){var x=(l*g-a*p)/m;if((x>=u&&x<=d||x>=d&&x<=u)&&(x>=r&&x<=n||x>=n&&x<=r))return true}h=f;u=d}return false},getPolygon:function(t){var e=this.boundingBoxes.indexOf(t);return e==-1?null:this.polygons[e]},getWidth:function(){return this.maxX-this.minX},getHeight:function(){return this.maxY-this.minY}}},{"../core":77}],180:[function(t,e,r){e.exports={Spine:t("./Spine"),SpineRuntime:t("./SpineRuntime")}},{"./Spine":178,"./SpineRuntime":179}],181:[function(t,e,r){var i=t("../core");function n(t,e){i.Container.call(this);this.textWidth=0;this.textHeight=0;this._glyphs=[];this._style={tint:e.tint,align:e.align,fontName:null,fontSize:0};this.font=e.font;this._text=t;this.maxWidth=0;this.dirty=false;this.updateText()}n.prototype=Object.create(i.Container.prototype);n.prototype.constructor=n;e.exports=n;Object.defineProperties(n.prototype,{tint:{get:function(){return this._style.tint},set:function(t){this._style.tint=typeof t==="number"&&t>=0?t:16777215;this.dirty=true}},align:{get:function(){return this._style.align},set:function(t){this._style.align=t;this.dirty=true}},font:{get:function(){return this._style.font},set:function(t){if(typeof t==="string"){t=t.split(" ");this._style.fontName=t.slice(1).join(" ");this._style.fontSize=t.length>=2?parseInt(t[0],10):n.fonts[this.fontName].size}else{this._style.fontName=t.name;this._style.fontSize=typeof t.size==="number"?t.size:parseInt(t.size,10)}this.dirty=true}},text:{get:function(){return this._text},set:function(t){this._text=t;this.dirty=true}}});n.prototype.updateText=function(){var t=n.fonts[this._style.fontName];var e=new i.math.Point;var r=null;var o=[];var s=0;var a=0;var l=[];var h=0;var u=this._style.fontSize/t.size;var c=-1;for(var f=0;f<this.text.length;f++){var d=this.text.charCodeAt(f);c=/(\s)/.test(this.text.charAt(f))?f:c;if(/(?:\r\n|\r|\n)/.test(this.text.charAt(f))){l.push(s);a=Math.max(a,s);h++;e.x=0;e.y+=t.lineHeight;r=null;continue}if(c!==-1&&this.maxWidth>0&&e.x*u>this.maxWidth){o.splice(c,f-c);f=c;c=-1;l.push(s);a=Math.max(a,s);h++;e.x=0;e.y+=t.lineHeight;r=null;continue}var p=t.chars[d];if(!p){continue}if(r&&p.kerning[r]){e.x+=p.kerning[r]}o.push({texture:p.texture,line:h,charCode:d,position:new i.math.Point(e.x+p.xOffset,e.y+p.yOffset)});s=e.x+(p.texture.width+p.xOffset);e.x+=p.xAdvance;r=d}l.push(s);a=Math.max(a,s);var v=[];for(f=0;f<=h;f++){var g=0;if(this._style.align==="right"){g=a-l[f]}else if(this._style.align==="center"){g=(a-l[f])/2}v.push(g)}var m=o.length;var y=this.tint;for(f=0;f<m;f++){var x=this._glyphs[f];if(x){x.texture=o[f].texture}else{x=new i.Sprite(o[f].texture);this._glyphs.push(x)}x.position.x=(o[f].position.x+v[o[f].line])*u;x.position.y=o[f].position.y*u;x.scale.x=x.scale.y=u;x.tint=y;if(!x.parent){this.addChild(x)}}for(f=m;f<this._glyphs.length;++f){this.removeChild(this._glyphs[f])}this.textWidth=a*u;this.textHeight=(e.y+t.lineHeight)*u};n.prototype.updateTransform=function(){if(this.dirty){this.updateText();this.dirty=false}this.containerUpdateTransform()};n.fonts={}},{"../core":77}],182:[function(t,e,r){var i=t("../core");function n(t,e,r){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.resolution=r||i.RESOLUTION;this._text=null;this._style=null;var n=i.Texture.fromCanvas(this.canvas);n.trim=new i.math.Rectangle;i.Sprite.call(this,n);this.text=t;this.style=e}n.prototype=Object.create(i.Sprite.prototype);n.prototype.constructor=n;e.exports=n;n.fontPropertiesCache={};n.fontPropertiesCanvas=document.createElement("canvas");n.fontPropertiesContext=n.fontPropertiesCanvas.getContext("2d");Object.defineProperties(n.prototype,{width:{get:function(){if(this.dirty){this.updateText()}return this.scale.x*this._texture._frame.width},set:function(t){this.scale.x=t/this._texture._frame.width;this._width=t}},height:{get:function(){if(this.dirty){this.updateText()}return this.scale.y*this._texture._frame.height},set:function(t){this.scale.y=t/this._texture._frame.height;this._height=t}},style:{get:function(){return this._style},set:function(t){t=t||{};t.font=t.font||"bold 20pt Arial";t.fill=t.fill||"black";t.align=t.align||"left";t.stroke=t.stroke||"black";t.strokeThickness=t.strokeThickness||0;t.wordWrap=t.wordWrap||false;t.wordWrapWidth=t.wordWrapWidth||100;t.dropShadow=t.dropShadow||false;t.dropShadowColor=t.dropShadowColor||"#000000";t.dropShadowAngle=t.dropShadowAngle||Math.PI/6;t.dropShadowDistance=t.dropShadowDistance||5;t.padding=t.padding||0;this._style=t;this.dirty=true}},text:{get:function(){return this._text},set:function(t){t=t.toString()||" ";if(this._text===t){return}this._text=t;this.dirty=true}}});n.prototype.updateText=function(){var t=this._style;this.context.font=t.font;var e=t.wordWrap?this.wordWrap(this._text):this._text;var r=e.split(/(?:\r\n|\r|\n)/);var i=new Array(r.length);var n=0;var o=this.determineFontProperties(t.font);for(var s=0;s<r.length;s++){var a=this.context.measureText(r[s]).width;i[s]=a;n=Math.max(n,a)}var l=n+t.strokeThickness;if(t.dropShadow){l+=t.dropShadowDistance}this.canvas.width=(l+this.context.lineWidth)*this.resolution;var h=this.style.lineHeight||o.fontSize+t.strokeThickness;var u=h*r.length;if(t.dropShadow){u+=t.dropShadowDistance}this.canvas.height=(u+this._style.padding*2)*this.resolution;this.context.scale(this.resolution,this.resolution);if(navigator.isCocoonJS){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)}this.context.font=t.font;this.context.strokeStyle=t.stroke;this.context.lineWidth=t.strokeThickness;this.context.textBaseline="alphabetic";var c;var f;if(t.dropShadow){this.context.fillStyle=t.dropShadowColor;var d=Math.cos(t.dropShadowAngle)*t.dropShadowDistance;var p=Math.sin(t.dropShadowAngle)*t.dropShadowDistance;for(s=0;s<r.length;s++){c=t.strokeThickness/2;f=t.strokeThickness/2+s*h+o.ascent;if(t.align==="right"){c+=n-i[s]}else if(t.align==="center"){c+=(n-i[s])/2}if(t.fill){this.context.fillText(r[s],c+d,f+p+this._style.padding)}}}this.context.fillStyle=t.fill;for(s=0;s<r.length;s++){c=t.strokeThickness/2;f=t.strokeThickness/2+s*h+o.ascent;if(t.align==="right"){c+=n-i[s]}else if(t.align==="center"){c+=(n-i[s])/2}if(t.stroke&&t.strokeThickness){this.context.strokeText(r[s],c,f+this._style.padding)}if(t.fill){this.context.fillText(r[s],c,f+this._style.padding)}}this.updateTexture()};n.prototype.updateTexture=function(){var t=this._texture;t.baseTexture.hasLoaded=true;t.baseTexture.resolution=this.resolution;t.baseTexture.width=this.canvas.width/this.resolution;t.baseTexture.height=this.canvas.height/this.resolution;t.crop.width=t._frame.width=this.canvas.width/this.resolution;t.crop.height=t._frame.height=this.canvas.height/this.resolution;t.trim.x=0;t.trim.y=-this._style.padding;t.trim.width=t._frame.width;t.trim.height=t._frame.height-this._style.padding*2;this._width=this.canvas.width/this.resolution;this._height=this.canvas.height/this.resolution;t.update();this.dirty=false};n.prototype.renderWebGL=function(t){if(this.dirty){this.resolution=t.resolution;this.updateText()}i.Sprite.prototype.renderWebGL.call(this,t)};n.prototype._renderCanvas=function(t){if(this.dirty){this.resolution=t.resolution;this.updateText()}i.Sprite.prototype._renderCanvas.call(this,t)};n.prototype.determineFontProperties=function(t){var e=n.fontPropertiesCache[t];if(!e){e={};var r=n.fontPropertiesCanvas;var i=n.fontPropertiesContext;i.font=t;var o=Math.ceil(i.measureText("|Mq").width);var s=Math.ceil(i.measureText("M").width);var a=2*s;s=s*1.4|0;r.width=o;r.height=a;i.fillStyle="#f00";i.fillRect(0,0,o,a);i.font=t;i.textBaseline="alphabetic";i.fillStyle="#000";i.fillText("|Mq",0,s);var l=i.getImageData(0,0,o,a).data;var h=l.length;var u=o*4;var c,f;var d=0;var p=false;for(c=0;c<s;c++){for(f=0;f<u;f+=4){if(l[d+f]!==255){p=true;break}}if(!p){d+=u}else{break}}e.ascent=s-c;d=h-u;p=false;for(c=a;c>s;c--){for(f=0;f<u;f+=4){if(l[d+f]!==255){p=true;break}}if(!p){d-=u}else{break}}e.descent=c-s;e.fontSize=e.ascent+e.descent;n.fontPropertiesCache[t]=e}return e};n.prototype.wordWrap=function(t){var e="";var r=t.split("\n");var i=this._style.wordWrapWidth;for(var n=0;n<r.length;n++){var o=i;var s=r[n].split(" ");for(var a=0;a<s.length;a++){var l=this.context.measureText(s[a]).width;var h=l+this.context.measureText(" ").width;if(a===0||h>o){if(a>0){e+="\n"}e+=s[a];o=i-l}else{o-=h;e+=" "+s[a]}}if(n<r.length-1){e+="\n"}}return e};n.prototype.getBounds=function(t){if(this.dirty){this.updateText()}return i.Sprite.prototype.getBounds.call(this,t)};n.prototype.destroy=function(t){this.context=null;this.canvas=null;this._texture.destroy(t===undefined?true:t)}},{"../core":77}],183:[function(t,e,r){e.exports={Text:t("./Text"),BitmapText:t("./BitmapText")}},{"./BitmapText":181,"./Text":182}],184:[function(t,e,r){var i=t("performance-now"),n=typeof window==="undefined"?{}:window,o=["moz","webkit"],s="AnimationFrame",a=n["request"+s],l=n["cancel"+s]||n["cancelRequest"+s],h=true;for(var u=0;u<o.length&&!a;u++){a=n[o[u]+"Request"+s];l=n[o[u]+"Cancel"+s]||n[o[u]+"CancelRequest"+s]}if(!a||!l){h=false;var c=0,f=0,d=[],p=1e3/60;a=function(t){if(d.length===0){var e=i(),r=Math.max(0,p-(e-c));c=r+e;setTimeout(function(){var t=d.slice(0);d.length=0;for(var e=0;e<t.length;e++){if(!t[e].cancelled){try{t[e].callback(c)}catch(r){setTimeout(function(){throw r},0)}}}},Math.round(r))}d.push({handle:++f,callback:t,cancelled:false});return f};l=function(t){for(var e=0;e<d.length;e++){if(d[e].handle===t){d[e].cancelled=true}}}}e.exports=function(t){if(!h){return a.call(n,t)}return a.call(n,function(){try{t.apply(this,arguments)}catch(e){setTimeout(function(){throw e},0)}})};e.exports.cancel=function(){l.apply(n,arguments)}},{"performance-now":185}],185:[function(t,e,r){(function(t){(function(){var r,i,n;if(typeof performance!=="undefined"&&performance!==null&&performance.now){e.exports=function(){return performance.now()}}else if(typeof t!=="undefined"&&t!==null&&t.hrtime){e.exports=function(){return(r()-n)/1e6};i=t.hrtime;r=function(){var t;t=i();return t[0]*1e9+t[1]};n=r()}else if(Date.now){e.exports=function(){return Date.now()-n};n=Date.now()}else{e.exports=function(){return(new Date).getTime()-n};n=(new Date).getTime()}}).call(this)}).call(this,t("_process"))},{_process:9}]},{},[2]);